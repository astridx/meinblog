<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.7a9d7c78d972bfc625e4.css" id="gatsby-global-css">:root{--font-weight-normal:200;--font-weight-bigger1:250;--font-weight-bigger2:300;--font-weight-biggest:350}sup{display:none}pre{font-size:.7rem}@media screen and (min-width:800px){pre{font-size:.8rem}}@media screen and (min-width:1000px){pre{font-size:1rem}}*,:after,:before{box-sizing:border-box}html{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI,Roboto,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-weight:var(--font-weight-normal);font-size:.9rem;line-height:1.5}body{--font-color:#495057;--link-color:#02091c;--heading-color:#183446;--dark-font-color:#212529;--light-font-color:#868e96;--light-background:#fff;--light-blockqoute:#f0f0f0;--dark-blockqoute:#02091c;--border:#d6d9de;--link-color-white:#fff}body,body.dark{color:var(--font-color);background-color:var(--light-background);margin:0;padding:0 1.5rem}body.dark{--font-color:#b6afa8;--link-color:#fdf6e3;--heading-color:#e7cbb9;--dark-font-color:#dedad6;--light-font-color:#797169;--light-background:#000;--light-blockqoute:#222;--dark-blockqoute:#fdf6e3;--border:#292621;--link-color-white:#222}@media screen and (min-width:800px){body{padding:0 2rem}}article{min-width:0}section{margin:2rem 0}section>h2{margin-top:4rem}@media screen and (min-width:800px){section{margin:3rem 0}}.container{max-width:1100px;margin-left:auto;margin-right:auto}img{display:inline-block;max-width:100%;height:auto}blockquote,dl,ol,p,table,ul{font-size:1.05rem;margin:0 0 1.5rem}ul{padding:0 1rem}@media screen and (min-width:800px){ul{padding:0 2rem}}ul li p{margin:0}ul li ul{padding-left:1rem;margin:0}ul li ul li{margin:.25rem 0}ol li ol{margin-bottom:0}.task-list-item [type=checkbox]{margin-right:.5rem}blockquote{margin:1.5rem 0;padding:1rem;background:var(--light-blockqoute);border-top:1px solid var(--dark-blockqoute);border-right:5px solid var(--dark-blockqoute)}blockquote p{margin:0}blockquote a{padding:1px 4px}blockquote a,blockquote a:hover{border-bottom:2px solid var(--dark-blockqoute);color:var(--heading-color)}blockquote a:hover{border-radius:.3rem}h1,h2,h3,h4,h5{margin:0 0 1.5rem;font-weight:var(--font-weight-biggest);line-height:1.2;color:var(--heading-color);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}h1:not(:first-child),h2:not(:first-child),h3:not(:first-child),h4:not(:first-child){margin-top:3rem}h1{font-size:2.5rem;line-height:1.1}h2{font-size:1.75rem}h2 code{font-size:1.75rem!important}h3{font-size:1.5rem;color:var(--font-color);font-weight:var(--font-weight-bigger2)}h3 code{font-size:1.5rem!important}h4{font-size:1.4rem;color:var(--font-color);font-weight:var(--font-weight-bigger1)}h4,h5{margin-bottom:1rem}h5{font-size:1.2rem}@media screen and (min-width:800px){h1{font-size:3rem}h2{font-size:2rem}h2 code{font-size:2rem!important}h3{font-size:1.6rem;color:var(--font-color);font-weight:var(--font-weight-bigger2)}h3 code{font-size:1.6rem!important}}aside{min-width:300px}aside p,aside ul{font-size:.95rem}aside ul{padding-left:1rem}aside h3{font-size:1.4rem}aside a.link:hover{border-bottom:0;background:var(--light-background)}.aside-content{border-top:2px solid var(--light-background)}@media screen and (min-width:1100px){.aside-content{border-top:0;border-left:2px solid var(--light-background);padding-left:2rem}.aside-content section{margin-top:.25rem}}a.link{display:grid;grid-template-columns:45px auto;align-items:center;color:var(--heading-color);border-bottom:none;padding:.75rem;border-radius:.3rem}a.link:hover{border-bottom:none;background:var(--light-background)}a.link img{display:inline-block;height:auto;margin-right:1rem;height:22px;width:auto}.lead{margin:4rem 0}.lead h1{color:var(--dark-font-color);font-weight:var(--font-weight-biggest);font-size:2.5rem;margin-bottom:2rem}.lead p{font-size:1.1rem}@media screen and (min-width:800px){.lead h1{font-size:3rem}.lead p{font-size:1.2rem}}p.subtitle{color:var(--light-font-color);font-size:1.2rem}@media screen and (min-width:800px){p.subtitle{font-size:1.4rem}}a{color:var(--link-color);text-decoration:none;font-weight:var(--font-weight-bigger2)}a:hover{border-bottom:2px solid var(--link-color);color:var(--heading-color)}a.gatsby-resp-image-link:hover{border-bottom:none}a code{border-bottom:2px solid var(--link-color)}a code:hover{background:var(--link-color)!important;color:var(--link-color-white)!important}main{margin-top:7rem}.navbar{width:100%;padding:1rem 2rem;position:fixed;top:0;left:0;background:var(--link-color-white);box-shadow:0 3px 13px rgba(100,110,140,.1),0 2px 4px rgba(100,110,140,.15);z-index:2;border-bottom:solid}.navbar .flex{justify-content:space-between}.footer a,.navbar a{border-radius:.3rem;padding:.5rem;margin:0 .25rem;color:var(--light-font-color);border-bottom:none;font-weight:var(--font-weight-normal)}.footer a:hover,.navbar a:hover{background:var(--light-background);color:var(--font-color)}.navbar a:first-of-type{margin-left:-1rem}.navbar a:last-of-type{margin-right:-1rem}.navbar a.brand{font-size:1.1rem;font-weight:var(--font-weight-bigger2);color:var(--font-color);white-space:nowrap}@media screen and (min-width:800px){main{margin-top:0}.navbar{margin:2rem 0 5rem;padding:1.5rem 0;position:static;background:var(--link-color-white);box-shadow:none}.navbar .flex{justify-content:flex-start}.footer a,.navbar a{padding:1rem 1.5rem;font-size:1.1rem}.navbar a.brand{font-size:1.3rem;margin-right:3rem}.navbar a:first-of-type{margin-left:-1.5rem}}.footer{margin:3rem auto}.footer>.flex{flex-direction:column}.footer-links,.footer>.flex{align-items:center;justify-content:center}.footer-links{display:flex;flex-wrap:wrap}.flex nav{padding:1rem 0}.footer a.img{display:flex;align-items:center;padding:0;margin:0 .75rem;background:none}.footer img{height:30px;width:30px}@media screen and (min-width:800px){.footer{margin:5rem auto}.footer>.flex{align-items:flex-start;margin-left:-1.5rem;margin-right:-1.5rem}.footer a.img{padding:0 .5rem;margin:0 1rem}}.emoji{margin:0 .4rem 0 .1rem}table{border-collapse:collapse;border-spacing:0;width:100%;max-width:100%;overflow-x:auto;display:block}th{border-bottom:2px solid var(--light-background)}tfoot th{border-top:2px solid var(--light-background)}td{border-bottom:2px solid var(--light-background)}td,th{text-align:left;padding:.75rem!important;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;word-break:break-word}tbody tr:nth-child(2n){background-color:var(--light-background)}.flex{display:flex;align-items:center}.grid{display:grid;align-items:stretch}.grid.projects{grid-template-columns:40px auto}.row .cell.description{grid-column:1/span 2;margin-bottom:2rem;line-height:1.3;font-size:1.1rem}@media screen and (min-width:800px){.grid{margin-left:-1rem;margin-right:-1rem}.grid.projects{grid-template-columns:50px 1fr 4fr}.row .cell.description{grid-column:auto;margin-bottom:0}.grid.posts{grid-template-columns:200px 4fr}.grid.lists{grid-template-columns:2fr 4fr}.grid.posts.with-tags{grid-template-columns:200px 4fr 2fr}}.row{display:contents}.lists .row,.posts .row{display:block;margin-bottom:2rem;border-bottom:none}.row .cell{display:flex;align-items:center;font-weight:var(--font-weight-biggest);color:var(--dark-font-color);font-size:1.2rem;line-height:1.2;padding:.5rem 0}.row .cell time{font-size:.8rem}@media screen and (min-width:800px){.row .cell{font-size:1.1rem}.row .cell time{font-size:.9rem}.row .cell.simple{padding:.5rem 0}.lists .row,.posts .row{display:contents}.row:hover>*{background:var(--light-background)}.row .cell.simple:first-child,.row .cell:first-child{padding-left:1rem;border-top-left-radius:.3rem;border-bottom-left-radius:.3rem}.row .cell.simple:last-child,.row .cell:last-child{padding-right:1rem;padding-left:1rem;border-top-right-radius:.3rem;border-bottom-right-radius:.3rem}}.row .cell.light{font-weight:var(--font-weight-normal);color:var(--light-font-color)}.grid.guide{grid-gap:1.5rem;grid-auto-rows:1fr;margin-top:3rem;margin-left:0;margin-right:0}.grid.guide a{transition:all .2s ease;display:flex;align-items:center;padding:1.5rem;border-radius:.3rem;box-shadow:0 3px 13px rgba(100,110,140,.1),0 2px 4px rgba(100,110,140,.15);border-bottom:none}.grid.guide .gatsby-image-wrapper{margin-right:1.5rem}.grid.guide a:hover{-webkit-transform:translate3D(0,-1px,0);transform:translate3D(0,-1px,0);box-shadow:0 8px 22px rgba(100,110,140,.2),0 5px 18px rgba(100,110,140,.25)}.grid.guide h2{margin:0;font-size:1rem;flex:1 1}@media screen and (min-width:600px){.grid.guide{grid-template-columns:repeat(2,minmax(0,1fr))}.grid.guide a{flex-direction:column;justify-content:center}.grid.guide h2{text-align:center;margin:1rem 0 0;flex:none}.grid.guide .gatsby-image-wrapper{margin-right:0}}@media screen and (min-width:800px){.grid.guide{grid-template-columns:repeat(3,minmax(0,1fr))}}@media screen and (min-width:1000px){.grid.guide{grid-template-columns:repeat(4,minmax(0,1fr))}}@media screen and (min-width:1200px){.grid.guide{grid-template-columns:repeat(5,minmax(0,1fr))}}html body div#___gatsby div#gatsby-focus-wrapper main.container section.grid.post article div p span.gatsby-resp-image-wrapper a.gatsby-resp-image-link img.gatsby-resp-image-image{border:1px solid #ddd;border-radius:4px;padding:5px}.grid.post{grid-gap:3rem;margin-left:0;margin-right:0}.article-header h1{font-size:2rem;margin-bottom:1rem;margin-top:.5rem}@media screen and (min-width:1100px){.grid.post{grid-template-columns:3fr 1fr}.article-header h1{font-size:2.75rem;margin-bottom:3rem}}[type=search]{display:block;padding:.8rem 1rem;border:2px solid var(--border);width:100%;max-width:400px;border-radius:.3rem;font-size:1rem}::-webkit-input-placeholder{color:var(--light-font-color)}:-moz-placeholder,:-ms-input-placeholder,::-moz-placeholder,::-webkit-input-placeholder,::placeholder{color:var(--light-font-color)}.suggested{flex-direction:column;align-items:stretch;margin-left:-1rem;margin-right:-1rem}.suggested a{text-align:center;margin:1rem;border-bottom:none;transition:all .2s ease;padding:1.5rem;border-radius:.3rem;box-shadow:0 3px 13px rgba(100,110,140,.1),0 2px 4px rgba(100,110,140,.15);color:var(--font-color)}.suggested a:hover{-webkit-transform:translate3D(0,-1px,0);transform:translate3D(0,-1px,0);box-shadow:0 8px 22px rgba(100,110,140,.2),0 5px 18px rgba(100,110,140,.25)}@media screen and (min-width:800px){.suggested{flex-direction:row}.suggested a{flex-grow:0;flex-shrink:0;flex-basis:calc(50% - 2rem)}}.small{max-width:600px}.medium{max-width:750px}.meta,time{color:var(--light-font-color);font-size:.9rem;white-space:nowrap;font-weight:var(--font-weight-normal)}.count{font-weight:var(--font-weight-biggest);color:var(--link-color)}.tags{display:flex!important;align-items:center;overflow:hidden}.tags>a{display:block;font-weight:var(--font-weight-bigger1);background:#f1f3f5;color:#343a40;margin:.2rem;padding:.4rem .5rem;font-size:.8rem;border-radius:.3rem;border-bottom:0;white-space:nowrap}.tags>a:first-child{margin-left:0}.tags>a:last-child{margin-right:0}.tags>a:hover{background:#868e96;color:var(--link-color-white)}mark{background:#ffec99}a.tag-javascript,a.tag-sql{background:#fff3bf;color:#000}a.tag-javascript:hover,a.tag-sql:hover{background:#ffd43b;color:#000}a.tag-git,a.tag-html,a.tag-linux,a.tag-snippets{background:#fff4e6;color:#e8590c}a.tag-git:hover,a.tag-html:hover,a.tag-linux:hover,a.tag-snippets:hover{background:#fd7e14;color:var(--link-color-white)}a.tag-new-year,a.tag-vue{color:#087f5b;background:#e6fcf5}a.tag-new-year:hover,a.tag-vue:hover{background:#0ca678;color:var(--link-color-white)}a.tag-fundamentals,a.tag-game,a.tag-testing{background:#d3f9d8;color:#111}a.tag-fundamentals:hover,a.tag-game:hover,a.tag-testing:hover{background:#37b24d;color:var(--link-color-white)}a.tag-automation,a.tag-node,a.tag-security{background:#fff5f5;color:#e03131}a.tag-automation:hover,a.tag-node:hover,a.tag-security:hover{background:#f03e3e;color:var(--link-color-white)}a.tag-jQuery,a.tag-notes,a.tag-projects,a.tag-reference,a.tag-wordpress{background:#e3fafc;color:#0c8599}a.tag-jQuery:hover,a.tag-notes:hover,a.tag-projects:hover,a.tag-reference:hover,a.tag-wordpress:hover{background:#1098ad;color:var(--link-color-white)}a.tag-architecture,a.tag-css,a.tag-dom{background:#e7f5ff;color:#1971c2}a.tag-architecture:hover,a.tag-css:hover,a.tag-dom:hover{background:#1c7ed6;color:var(--link-color-white)}a.tag-gatsby,a.tag-life,a.tag-php,a.tag-redux{background:#f3f0ff;color:#6741d9}a.tag-gatsby:hover,a.tag-life:hover,a.tag-php:hover,a.tag-redux:hover{background:#7950f2;color:var(--link-color-white)}a.tag-api,a.tag-react{background:#edf2ff;color:#3b5bdb}a.tag-api:hover,a.tag-react:hover{background:#4263eb;color:var(--link-color-white)}a.tag-database,a.tag-design{background:#fff0f6;color:#c2255c}a.tag-database:hover,a.tag-design:hover{background:#e64980;color:var(--link-color-white)}a.tag-notes{background:#f8f0fc;color:#9c36b5}a.tag-notes:hover{background:#ae3ec9;color:var(--link-color-white)}:root{--code-font-family:Menlo,"Roboto Mono",Courier New,monospace;--code-font-color:#b3b9c5;--code-background-color:#353535;--string:#92d192;--variable:#f2777a;--property:#abb2bf;--number:#fca369;--operator:#ac8d58;--punctuation:#d5d8df;--comment:#848991;--function:#62cfcf;--keyword:#ffeead;--attribute:#ffd479;--class:#e1a6f2;--tag:#6ab0f3;--error:#f2777a;--light-background:#f1f3f5}pre[class*=language-]{box-shadow:0 8px 16px rgba(0,0,0,.55)}code[class*=language-],pre[class*=language-]{-webkit-font-smoothing:subpixel-antialiased;color:var(--code-font-color);font-family:var(--code-font-family);font-size:.8rem;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;font-weight:400;line-height:1.7;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1.5rem 2rem;margin:.5rem -1.5rem 2rem;overflow:auto}@media screen and (min-width:800px){code[class*=language-],pre[class*=language-]{font-size:.9rem}pre[class*=language-]{padding:1.5rem;margin-left:auto;margin-right:auto;border-radius:.3rem}}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:var(--code-background-color)}:not(pre)>code[class*=language-]{padding:.1rem .3rem;border-radius:.3rem}code.language-text,pre.language-text{background:#e0e3e7!important;color:#333!important;box-shadow:none}code.language-shell:before{content:"$ ";color:var(--comment)}pre.language-terminal{position:relative;background:#fff;color:#595c62;box-shadow:0 8px 16px rgba(100,120,130,.35);padding-top:3rem;margin:2rem 0;border-radius:.3rem}code.language-terminal{color:#595c62}pre.language-terminal:before{content:"\2022   \2022   \2022";position:absolute;top:0;left:0;background:#e0e3e7;color:var(--code-font-color);width:100%;font-size:2.5rem;margin:0;line-height:0;padding:18px 0 16px;text-indent:6px;letter-spacing:-18px}.gatsby-highlight-code-line{background-color:#191919;display:block;margin-right:-1rem;margin-left:-1rem;padding-right:1rem;padding-left:.75rem;border-left:.25rem solid #748ffc}.token.cdata,.token.comment,.token.doctype,.token.important,.token.prolog{color:var(--comment)}.token.punctuation{color:var(--punctuation)}.token.namespace{opacity:.7}.token.property{color:var(--property)}.token.constant,.token.deleted,.token.symbol,.token.tag{color:var(--tag)}.token.number{color:var(--number)}.token.builtin,.token.char,.token.inserted,.token.url{color:var(--code-font-color)}.token.attr-name,.token.selector{color:var(--attribute)}.token.attr-value,.token.string{color:var(--string)}.token.operator{color:var(--operator)}.token.atrule,.token.keyword{color:var(--keyword)}.token.function{color:var(--function)}.language-css,.token.boolean,.token.class-name{color:var(--class)!important}.token.regex{color:var(--keyword)}.token.variable{color:var(--variable)}.token.bold{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.filename{font-size:.9rem;margin-bottom:-.8rem;padding:.5rem 1rem .75rem;line-height:1.8;background-color:#000;color:#fff;z-index:1;margin-left:-1.5rem;margin-right:-1.5rem}@media screen and (min-width:800px){.filename{border-top-left-radius:.3rem;border-top-right-radius:.3rem;margin-left:auto;margin-right:auto}}code::selection,pre::selection{text-shadow:none;color:inherit;background:hsla(0,0%,58.8%,.3)!important}code[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;color:inherit;background:hsla(0,0%,58.8%,.3)!important}</style><meta name="generator" content="Gatsby 2.32.13"/><title data-react-helmet="true">Gatsby Blog with MapLibre GL JS and React Hooks | Astrid Günther</title><link data-react-helmet="true" rel="shortcut icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAKJQTFRFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////oK8DKAAAADR0Uk5TAAcFUJJIFGOlRfPFUiXbeXXt8n4Kas1bA4/5gyyAnlf89WcCcN4oMfuyHN3TbhLuwXIiARdSFQIAAAABYktHRDXettlrAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAaUlEQVQY02NgoANgROUyMbMwsLIhCbBzcDJwcfMwwfi8fPw8DAKCQsIiUAFREzFxBglJEylpqFEyshxyDAzyCiaKSjBNyhIMDComJiaqagiD1cVMTDQ0tRAC2iYaOrp6SFbrGxgaGSPxAeofB3Dy5mHsAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTEyLTMxVDEzOjI3OjUyKzAwOjAwahG+IAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0xMi0zMVQxMzoyNzo1MiswMDowMBtMBpwAAABGdEVYdHNvZnR3YXJlAEltYWdlTWFnaWNrIDYuNy44LTkgMjAxNC0wNS0xMiBRMTYgaHR0cDovL3d3dy5pbWFnZW1hZ2ljay5vcmfchu0AAAAAGHRFWHRUaHVtYjo6RG9jdW1lbnQ6OlBhZ2VzADGn/7svAAAAGHRFWHRUaHVtYjo6SW1hZ2U6OmhlaWdodAAxOTIPAHKFAAAAF3RFWHRUaHVtYjo6SW1hZ2U6OldpZHRoADE5MtOsIQgAAAAZdEVYdFRodW1iOjpNaW1ldHlwZQBpbWFnZS9wbmc/slZOAAAAF3RFWHRUaHVtYjo6TVRpbWUAMTU0NjI2Mjg3MhvFQhUAAAAPdEVYdFRodW1iOjpTaXplADBCQpSiPuwAAABWdEVYdFRodW1iOjpVUkkAZmlsZTovLy9tbnRsb2cvZmF2aWNvbnMvMjAxOC0xMi0zMS9hNTIxNmRhZDQ0YjlhNzJmNjM1OWZjMjEwMjJlYzQwMS5pY28ucG5nxAVqqwAAAABJRU5ErkJggg=="/><meta data-react-helmet="true" name="description" content="I like to design websites with Gatsby and have recently started using MapLibre GL. I wish to combine the two. The idea is to create a travel…"/><meta data-react-helmet="true" name="image" content="https://blog.astrid-guenther.de//static/7c1705d3acc30aff7fec6028c9c6c6b0/829e2/maplibre.png"/><meta data-react-helmet="true" property="og:url" content="https://blog.astrid-guenther.de//en/maplibre-blog-with-gatsby/"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="Gatsby Blog with MapLibre GL JS and React Hooks"/><meta data-react-helmet="true" property="og:description" content="I like to design websites with Gatsby and have recently started using MapLibre GL. I wish to combine the two. The idea is to create a travel…"/><meta data-react-helmet="true" property="og:image" content="https://blog.astrid-guenther.de//static/7c1705d3acc30aff7fec6028c9c6c6b0/829e2/maplibre.png"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="astridguenther"/><meta data-react-helmet="true" name="twitter:title" content="Gatsby Blog with MapLibre GL JS and React Hooks"/><meta data-react-helmet="true" name="twitter:description" content="I like to design websites with Gatsby and have recently started using MapLibre GL. I wish to combine the two. The idea is to create a travel…"/><meta data-react-helmet="true" name="twitter:image" content="https://blog.astrid-guenther.de//static/7c1705d3acc30aff7fec6028c9c6c6b0/829e2/maplibre.png"/><script data-react-helmet="true" type="application/ld+json">[{"@context":"http://schema.org","@type":"WebSite","url":"https://blog.astrid-guenther.de/","name":"Gatsby Blog with MapLibre GL JS and React Hooks","alternateName":"Gatsby Blog with MapLibre GL JS and React Hooks"},{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://blog.astrid-guenther.de//en/maplibre-blog-with-gatsby/","name":"Gatsby Blog with MapLibre GL JS and React Hooks","image":"https://blog.astrid-guenther.de//static/7c1705d3acc30aff7fec6028c9c6c6b0/829e2/maplibre.png"}}]},{"@context":"http://schema.org","@type":"BlogPosting","url":"https://blog.astrid-guenther.de/","name":"Gatsby Blog with MapLibre GL JS and React Hooks","alternateName":"Gatsby Blog with MapLibre GL JS and React Hooks","headline":"Gatsby Blog with MapLibre GL JS and React Hooks","image":{"@type":"ImageObject","url":"https://blog.astrid-guenther.de//static/7c1705d3acc30aff7fec6028c9c6c6b0/829e2/maplibre.png"},"description":"I like to design websites with Gatsby and have recently started using MapLibre GL. I wish to combine the two. The idea is to create a travel…"}]</script><link rel="icon" href="/favicon-32x32.png?v=3ab21ccc9ee6bc1e6ee3329051bee6cc" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#16868F"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=3ab21ccc9ee6bc1e6ee3329051bee6cc"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=3ab21ccc9ee6bc1e6ee3329051bee6cc"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=3ab21ccc9ee6bc1e6ee3329051bee6cc"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=3ab21ccc9ee6bc1e6ee3329051bee6cc"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=3ab21ccc9ee6bc1e6ee3329051bee6cc"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=3ab21ccc9ee6bc1e6ee3329051bee6cc"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=3ab21ccc9ee6bc1e6ee3329051bee6cc"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=3ab21ccc9ee6bc1e6ee3329051bee6cc"/><link rel="alternate" type="application/rss+xml" title="Astrid Günther | RSS Feed" href="/rss.xml"/><link as="script" rel="preload" href="/webpack-runtime-5b70cad0a5335659e3fc.js"/><link as="script" rel="preload" href="/framework-b17a64ad725e0b3c1338.js"/><link as="script" rel="preload" href="/app-6e19340bc1dca09b3b91.js"/><link as="script" rel="preload" href="/styles-e9d24b1846c7d6eb9685.js"/><link as="script" rel="preload" href="/05f1d64e2e1399e8ce81fd5e37a2b8dc2f9ac157-df620d5817af7d7d7bfc.js"/><link as="script" rel="preload" href="/cd89b575fbc7744d97a7acf3b55b56387c8b3feb-ecedd2c80549e60c9d95.js"/><link as="script" rel="preload" href="/component---src-templates-post-js-8d0f43e9772b68fff69d.js"/><link as="fetch" rel="preload" href="/page-data/en/maplibre-blog-with-gatsby/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>
void function() {
  window.__onThemeChange = function() {}

  var preferredTheme
  try {
    preferredTheme = localStorage.getItem('theme')
  } catch (err) { }

  function setTheme(newTheme) {
    if (preferredTheme && document.body.classList.contains(preferredTheme)) {
      document.body.classList.replace(preferredTheme, newTheme)
    } else {
      document.body.classList.add(newTheme)
    }

    window.__theme = newTheme
    preferredTheme = newTheme
    window.__onThemeChange(newTheme)
  }

  window.__setPreferredTheme = function(newTheme) {
    setTheme(newTheme)
    try {
      localStorage.setItem('theme', newTheme)
    } catch (err) {}
  }

  var darkQuery = window.matchMedia('(prefers-color-scheme: dark)')
  darkQuery.addListener(function(e) {
    window.__setPreferredTheme(e.matches ? 'dark' : 'light')
  })

  setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'))
}()
    </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><nav class="navbar"><div><a href="/"><img style="display:block;max-width:100%;margin:auto" src="/logo2.png" alt=""/></a></div><div class="container flex"><div><a href="/blog">Blog</a><a href="/tutorial">Sets</a><button id="dark-mode-button" style="margin-left:20px"><a href="/maplibre-blog-with-gatsby/">deutsch</a></button><label><input type="checkbox"/> <!-- -->Dark mode</label></div></div></nav><main class="container"><aside><div class="aside-content"><section><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:80px;height:80px"><img aria-hidden="true" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAACj0lEQVQ4y3WU3UtTcRjHz5/RhV7MuS23IrCuIsqgm64GobTNuQkVg14cFtFFFybilUW7KFtBVKvNvbloS2PNytk2i8xLQaIa6FUGUerEuZc+O2c7nR3s8HD4Ps/z/f6e5/cqVBtfpVLhv17Ynkx/u+jJdA3ETc4o1uWO4xIkJdOkT1AqE9n8icsvW3sCmL43ZLDXDCBFSCVyeaW+Li5XKqO+RRgaS5Bqenuw3TohVQbgAkhBgFaWxRIYefJ5z6lnRkfE6IxorROHL7067/0yHP2JAXAJkoIADbJYX6xMt63d/g5HLUed41dmPMnC4w9Vb3oHA9xOFgiSggCtpdsfz9b6Fza3ikxGY6kNvLcv3OEID0fXHs1Xrz1dPTqYwgC4BElBgAYZCUIhlv7KSCZnbUjGPuJOjr/b8bzeOuhKaE77MQAuQVIQoEFGwvoLFzwZpfjYYOrebGls6g8udcReIrgESSnFCAW2sd0WklpiVw6ceT42tf7gfaVn9BOLhAFwCZKCIE0NCULB5KxXkIq0WQKu8eWHueqdme2rvhUMgEuQlNwOhlAt1tmCh1yJW9Mb3nTp/lwZA9yc3iBISi1Wtt0o7j95fc47W7r7togxW1yCilVotC0vmDwkm6m1+M035pFhAFxjc836grHiKrHBHjb0hXW2gHkoZx7KAgxiUCVmjxWHRBwbEsdgMv19YXntzcIKBsAlKOmh/TsknDLOWot4PJmMrjfUeTb2e7P4IpMf8S1iAFyCpCBA4ywnpOPZdDHE5ukqtbC6lP/1cekHBsCVUvzVF0N5JdusQRrb3x/tPBeTbV9/lCAp9ZVsegxy9ceAWWitQT0vgT0EwK0/BtndHoNdniF34xka+O8z9Bc/dL8PGNk6AAAAAABJRU5ErkJggg==" alt="" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms"/><noscript><picture><source srcset="/static/7c1705d3acc30aff7fec6028c9c6c6b0/829e2/maplibre.png 1x,
/static/7c1705d3acc30aff7fec6028c9c6c6b0/e94d6/maplibre.png 1.5x,
/static/7c1705d3acc30aff7fec6028c9c6c6b0/af1a8/maplibre.png 2x" /><img loading="lazy" width="80" height="80" srcset="/static/7c1705d3acc30aff7fec6028c9c6c6b0/829e2/maplibre.png 1x,
/static/7c1705d3acc30aff7fec6028c9c6c6b0/e94d6/maplibre.png 1.5x,
/static/7c1705d3acc30aff7fec6028c9c6c6b0/af1a8/maplibre.png 2x" src="/static/7c1705d3acc30aff7fec6028c9c6c6b0/829e2/maplibre.png" alt="" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div></section></div></aside><header class="article-header medium"><h1>Gatsby Blog with MapLibre GL JS and React Hooks</h1><a href="https://github.com/astridx/meinblog/blob/master/content/posts/maplibregl/2021-11-07-maplibre-gatsby-starter-first.steps.en.md" rel="noreferrer" target="_blank">Modify this post</a></header><aside><div class="aside-content"><section><time>07.11.2021</time><div class="cell tags"><a class="tag-MaplibreGL" href="/tags/maplibre-gl">MaplibreGL</a><a class="tag-geografische Daten" href="/tags/geografische-daten">geografische Daten</a><a class="tag-Geoinformationssystem" href="/tags/geoinformationssystem">Geoinformationssystem</a><a class="tag-JavaScript-Bibliothek" href="/tags/java-script-bibliothek">JavaScript-Bibliothek</a><a class="tag-Vektor-Tiles" href="/tags/vektor-tiles">Vektor-Tiles</a><a class="tag-Karten" href="/tags/karten">Karten</a><a class="tag-Gatsby" href="/tags/gatsby">Gatsby</a></div></section></div></aside><section class="post"><article><div><p>I like to design websites with <a href="https://www.gatsbyjs.com/">Gatsby</a> and have recently started using <a href="https://maplibre.org/">MapLibre GL</a>. I wish to combine the two. The idea is to create a travel blog where the map illustrates the text content by dynamically zooming into the relevant area. Ideally, the places from a blog post are marked with a marker. When navigating between different posts, the digital map continuously highlights the new regions instead of refreshing the entire map each time. This makes it easier for the reader to see the spatial context.</p>
<h2>Setup</h2>
<p>In the following example code, I do not discuss every single line of code. Instead, I make the result available online in my <a href="https://github.com/astridx/gatsby-maplibre-blog-tutorial">Github Repo</a>. The branch <code class="language-text">main</code> is created for MapLibre GL in version 1.x. The branch <code class="language-text">test_maplibre_v2</code> contains additions for MapLibre GL 2.x.</p>
<blockquote>
<p>I assume you are familiar with Gatsby and React and have installed the basic dependencies: First steps with <a href="https://de.reactjs.org/docs/getting-started.html">React</a> or <a href="https://www.gatsbyjs.com/docs/tutorial/">Gatsby</a></p>
</blockquote>
<p>First, we create an empty Gatsby project. I use the <a href="https://www.gatsbyjs.com/docs/starters/">start project</a> provided by Gatsby. This way the basics are pre-configured. The end result of this tutorial is a boilerplate structure. Feel free to adapt it to your individual needs afterwards.</p>
<pre class="grvsc-container solarized-light" data-language="" data-index="0"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">$ gatsby new gatsby-maplibre-blog</span></span></code></pre>
<p>After you have created the project, change to the project directory via <code class="language-text">cd gatsby-maplibre-blog</code> and call <code class="language-text">gatsby develop</code>. As a result, you will see the following output under the URL <code class="language-text">http://localhost:8000/</code> in the browser:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/25deba7b0d00540365f0eafe2efd017f/191e2/bloggatsby1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 47.46835443037975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA2klEQVQoz62OwQ7BQBCG+4aIN3AT3oC4uwgP4IybA03cXFzFzQVFGgeCYNtut7v7ayttWk1JxSRfJvPP/09Gqed78Cn0UXN7ozhAp6qiXVHRKo/cPkazNEQt9/KE/hQUh3EEcEfANCxs1ho2Kw0GMUM96vuEgrcSQuD+uIOYxMebs5QipUQMV5Scg5xvWM52YJT7xoQvhfDDQPCKnC+YdifQFvvE7uuH0SEIMYthPdc9IaZnOijDMHA52bgeTQgufv8wCDhMYqsxHHT2n4NetxmFYVBQ6iuZDj4BRPepNcGOXugAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="A screenshot of the Gatsby standard starter"
        title="A screenshot of the Gatsby standard starter"
        src="/static/25deba7b0d00540365f0eafe2efd017f/f058b/bloggatsby1.png"
        srcset="/static/25deba7b0d00540365f0eafe2efd017f/c26ae/bloggatsby1.png 158w,
/static/25deba7b0d00540365f0eafe2efd017f/6bdcf/bloggatsby1.png 315w,
/static/25deba7b0d00540365f0eafe2efd017f/f058b/bloggatsby1.png 630w,
/static/25deba7b0d00540365f0eafe2efd017f/40601/bloggatsby1.png 945w,
/static/25deba7b0d00540365f0eafe2efd017f/78612/bloggatsby1.png 1260w,
/static/25deba7b0d00540365f0eafe2efd017f/191e2/bloggatsby1.png 1836w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>To tidy things up a bit, I changed the files <code class="language-text">components/layout.js</code>, <code class="language-text">pages/404.js</code> and <code class="language-text">pages/index.js</code> in the <code class="language-text">src</code> folder.</p>
<blockquote>
<p>If you are familiar with Gatsby, you can also delete other contents of the boilerplate. To keep this example simple, it is enough to change the files <code class="language-text">components/layout.js</code>, <code class="language-text">pages/404.js</code> and <code class="language-text">pages/index.js</code>. Below you can see the code I replaced.</p>
</blockquote>
<pre class="grvsc-container solarized-light" data-language="js" data-index="1"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// index.js</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">React</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;react&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">Layout</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;../components/layout&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">IndexPage</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> () </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> (</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk3">&lt;</span><span class="mtk8">Layout</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;</span><span class="mtk7">h1</span><span class="mtk3">&gt;</span><span class="mtk1">Reise Blog</span><span class="mtk3">&lt;/</span><span class="mtk7">h1</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk3">&lt;/</span><span class="mtk8">Layout</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">export</span><span class="mtk1"> </span><span class="mtk8">default</span><span class="mtk1"> </span><span class="mtk7">IndexPage</span></span></span></code></pre>
<pre class="grvsc-container solarized-light" data-language="js" data-index="2"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// layout.js</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">React</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;react&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">PropTypes</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;prop-types&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">Layout</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> ({ children }) </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk8">return</span><span class="mtk1"> (</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;</span><span class="mtk7">div</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk3">&lt;</span><span class="mtk7">main</span><span class="mtk3">&gt;</span><span class="mtk9">{</span><span class="mtk7">children</span><span class="mtk9">}</span><span class="mtk3">&lt;/</span><span class="mtk7">main</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;/</span><span class="mtk7">div</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  )</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk7">Layout</span><span class="mtk1">.</span><span class="mtk7">propTypes</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  children: </span><span class="mtk7">PropTypes</span><span class="mtk1">.</span><span class="mtk7">node</span><span class="mtk1">.</span><span class="mtk7">isRequired</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">export</span><span class="mtk1"> </span><span class="mtk8">default</span><span class="mtk1"> </span><span class="mtk7">Layout</span></span></span></code></pre>
<pre class="grvsc-container solarized-light" data-language="js" data-index="3"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// 404.js</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">React</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;react&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">NotFoundPage</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> () </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> (</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk3">&lt;&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;</span><span class="mtk7">h1</span><span class="mtk3">&gt;</span><span class="mtk1">Page Not Found</span><span class="mtk3">&lt;/</span><span class="mtk7">h1</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk3">&lt;/&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">export</span><span class="mtk1"> </span><span class="mtk8">default</span><span class="mtk1"> </span><span class="mtk7">NotFoundPage</span></span></span></code></pre>
<p>I also cleaned up the file "gatsby-config.js". Here, too, I wanted to start with a minimum. So I removed a lot and changed the source path of the file to <code class="language-text">content</code>.</p>
<pre class="grvsc-container solarized-light" data-language="js" data-index="4"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// gatsby-config.js</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">module</span><span class="mtk1">.</span><span class="mtk8">exports</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  siteMetadata: {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    title: </span><span class="mtk11">`Gatsby maplibre Blog`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    description: </span><span class="mtk11">``</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    author: </span><span class="mtk11">`Me`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  },</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  plugins: [</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk11">`gatsby-plugin-react-helmet`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      resolve: </span><span class="mtk11">`gatsby-source-filesystem`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      options: {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        name: </span><span class="mtk11">`content`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        path: </span><span class="mtk11">`${</span><span class="mtk1">__dirname</span><span class="mtk11">}/content`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      },</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    },</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk11">`gatsby-transformer-sharp`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk11">`gatsby-plugin-sharp`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  ],</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p>I also make sure that the folder named <code class="language-text">content</code> exists in the root directory of my project. Since it does not yet exist in the project, I create it. We don't need it at the moment, but I will create Markdown files for blog posts in it later.</p>
<pre class="grvsc-container solarized-light" data-language="" data-index="5"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">mkdir content</span></span></code></pre>
<p>At this point, restart the development server to make sure there is no error. Run <code class="language-text">gatsby develop</code> again. If you see no error messages, everything is fine.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/07366bd56fb5e0eea5cfe415c6dd0054/191e2/bloggatsby2.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 47.46835443037975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAANklEQVQoz2N48+bN/9evX///+fPnfxD49+/ff0oAAzKHUsPABoIMgWGquJDqBv6nMhg1kHIAAKc+zKpuXfXjAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="A screenshot of Gatsby default starter after tidy up"
        title="A screenshot of Gatsby default starter after tidy up"
        src="/static/07366bd56fb5e0eea5cfe415c6dd0054/f058b/bloggatsby2.png"
        srcset="/static/07366bd56fb5e0eea5cfe415c6dd0054/c26ae/bloggatsby2.png 158w,
/static/07366bd56fb5e0eea5cfe415c6dd0054/6bdcf/bloggatsby2.png 315w,
/static/07366bd56fb5e0eea5cfe415c6dd0054/f058b/bloggatsby2.png 630w,
/static/07366bd56fb5e0eea5cfe415c6dd0054/40601/bloggatsby2.png 945w,
/static/07366bd56fb5e0eea5cfe415c6dd0054/78612/bloggatsby2.png 1260w,
/static/07366bd56fb5e0eea5cfe415c6dd0054/191e2/bloggatsby2.png 1836w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<h2>Install MapLibre GL JS</h2>
<p>We will install MapLibre GL JS from NPM. You can follow <a href="https://www.npmjs.com/package/maplibre-gl">the instructions</a>. Basically, all you need to do is run the following command in the terminal:</p>
<pre class="grvsc-container solarized-light" data-language="" data-index="6"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">$ npm i maplibre-gl</span></span></code></pre>
<blockquote>
<p>Note: The current version of <code class="language-text">maplibre-gl</code> is <code class="language-text">2.0.0-pre.6</code> at the time of writing. I want to install this version, even though it is not a stable version. Therefore I call <code class="language-text">npm i maplibre-gl@2.0.0-pre.6</code>.</p>
</blockquote>
<p>The NPM package contains a CSS file. I will later import this directly from the npm module into my component.</p>
<blockquote>
<p>Alternatively, it is possible to import the CSS file using the line <code class="language-text">&lt;link href='https://unpkg.com/maplibre-gl@1.15.2/dist/maplibre-gl.css' rel='stylesheet' /></code> in the header of the <a href="https://www.gatsbyjs.com/docs/custom-html/">static HTML page</a>. MapLibre uses <a href="https://github.com/maplibre/maplibre-gl-js/blob/main/docs/README-unpkg.md">unpkg.com</a>.</p>
</blockquote>
<h2>Show the map</h2>
<p>I want the same map to be used in all blog entries. So instead of adding a map on each page, I will add it to the <code class="language-text">layout</code> component. This way, every page on my website will include the map. To make the code reusable, I will create a separate component called <code class="language-text">Map</code>. Let's start with the file <code class="language-text">components/map.js</code>.</p>
<pre class="grvsc-container solarized-light" data-language="" data-index="7"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">// map.js</span></span>
<span class="grvsc-line"><span class="grvsc-source">import React, { useRef, useEffect, useState } from &quot;react&quot;</span></span>
<span class="grvsc-line"><span class="grvsc-source">import maplibregl from &quot;maplibre-gl&quot;</span></span>
<span class="grvsc-line"><span class="grvsc-source">import &quot;maplibre-gl/dist/maplibre-gl.css&quot;</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">const mapContainerStyle = {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  width: &quot;100%&quot;,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  height: &quot;120px&quot;,</span></span>
<span class="grvsc-line"><span class="grvsc-source">}</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">const Map = () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  const mapContainerRef = useRef(null)</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  const [map, setMap] = useState(null)</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  useEffect(() =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const map = new maplibregl.Map({</span></span>
<span class="grvsc-line"><span class="grvsc-source">      container: mapContainerRef.current,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      style: &#39;https://demotiles.maplibre.org/style.json&#39;,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      center: [-0.687787, 38.185674462487874],</span></span>
<span class="grvsc-line"><span class="grvsc-source">      zoom: 10,</span></span>
<span class="grvsc-line"><span class="grvsc-source">    })</span></span>
<span class="grvsc-line"><span class="grvsc-source">    map.addControl(new maplibregl.NavigationControl(), &quot;top-right&quot;)</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    setMap(map)</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    return () =&gt; map.remove()</span></span>
<span class="grvsc-line"><span class="grvsc-source">  }, [])</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  return &lt;div ref={mapContainerRef} style={mapContainerStyle} /&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">}</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">export default Map</span></span></code></pre>
<blockquote>
<p>The map style '<a href="https://demotiles.maplibre.org/style.json">https://demotiles.maplibre.org/style.json</a>' displays a very simple map. This is ideal for demo sites because no access token is needed. See the <a href="https://maplibre.org/maplibre-gl-js-docs/example/simple-map/">example</a> in the MapLibre documentation for more information. Examples with more detailed maps can also be found in the <a href="https://maplibre.org/maplibre-gl-js-docs/">MapLibre documentation</a> including explanations on the use of tokens.</p>
</blockquote>
<p>And integrate the map component into the file 'layout.js'.</p>
<pre class="grvsc-container solarized-light" data-language="js" data-index="8"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// layout.js</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">React</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;react&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">PropTypes</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;prop-types&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">Map</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;./map&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">Layout</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> ({ children }) </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk8">return</span><span class="mtk1"> (</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk3">&lt;</span><span class="mtk8">Map</span><span class="mtk1"> </span><span class="mtk3">/&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk3">&lt;</span><span class="mtk7">main</span><span class="mtk3">&gt;</span><span class="mtk9">{</span><span class="mtk7">children</span><span class="mtk9">}</span><span class="mtk3">&lt;/</span><span class="mtk7">main</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;/&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  )</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk7">Layout</span><span class="mtk1">.</span><span class="mtk7">propTypes</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  children: </span><span class="mtk7">PropTypes</span><span class="mtk1">.</span><span class="mtk7">node</span><span class="mtk1">.</span><span class="mtk7">isRequired</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">export</span><span class="mtk1"> </span><span class="mtk8">default</span><span class="mtk1"> </span><span class="mtk7">Layout</span></span></span></code></pre>
<p>At this point, restart the development server to ensure that the map is displayed correctly. Run <code class="language-text">gatsby develop</code> again. If you see the map at the top, all is well.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/cfd311d61a7754d612bfeaa9d2343130/191e2/bloggatsby3.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 47.46835443037975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9UlEQVQoz82NzU7CQBSF5/3fwCdwh1GjxqBiMIrxD4tYW4MBoRQqjWGQ0hba+Zy2mrAQw8KFJznzzT3JPVdcOvvU/QG2BHuitAtaMs3/zzLkxtml0TExhl0urAZ7VpUt94qzdpnqy4Adw+D2usZ56x5x5z/ki9Yk1c6ocpryi+OEUueJzd4RNbeJ6b5z3HWoPJ7QbG1w6pU4tLaxywfU7Qrite/R7vUZT0PmCqJEFU4h1gwW4OlhFL0xC33mcUCss0RnaewzXYxIwiGR/GAWBQiU3lS6icz8wmX9lBUS31VZp9LPaq5nsTzkt9Xq6+tI8Mf6/4Wf4sy5bvQR5DgAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Displaying a map on the index page"
        title="Displaying a map on the index page"
        src="/static/cfd311d61a7754d612bfeaa9d2343130/f058b/bloggatsby3.png"
        srcset="/static/cfd311d61a7754d612bfeaa9d2343130/c26ae/bloggatsby3.png 158w,
/static/cfd311d61a7754d612bfeaa9d2343130/6bdcf/bloggatsby3.png 315w,
/static/cfd311d61a7754d612bfeaa9d2343130/f058b/bloggatsby3.png 630w,
/static/cfd311d61a7754d612bfeaa9d2343130/40601/bloggatsby3.png 945w,
/static/cfd311d61a7754d612bfeaa9d2343130/78612/bloggatsby3.png 1260w,
/static/cfd311d61a7754d612bfeaa9d2343130/191e2/bloggatsby3.png 1836w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>I use React hooks - <code class="language-text">useRef()</code> to access the Map Container DOM element. <code class="language-text">UseState()</code> to store the Map object as state. So I can use the value in other parts of the component, and <code class="language-text">UseEffect()</code> to create the Map object when the component is called. The empty dependency array in <code class="language-text">useEffect()</code> is important. If you remove the second argument, you will find that the function goes into an infinite loop. This is because <code class="language-text">useEffect()</code> is executed whenever the state changes. Since we use <code class="language-text">setMap(map)</code> within the same hook, it will be executed over and over again. Because of the empty array, the effect hook is only executed once when the component is initialised. This is what we want to achieve. It is important to us that a new map is only created once. After that, the same map should be used. With <code class="language-text">return () => map.remove()</code> we clean up when the component is removed.</p>
<h2>Add markers</h2>
<p>Now let's create some markers on the map. Each blog post will contain an array of location data, and I want to create a marker for each location. Later this will be done via formatting the markdown files, but for now let's create a simple object with the coordinates as the data source.</p>
<pre class="grvsc-container solarized-light" data-language="js" data-index="9"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// on top of map.js</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">places</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> [</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    name: </span><span class="mtk11">&#39;Spanien&#39;</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    longitude: </span><span class="mtk8">-</span><span class="mtk6">0.687787</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    latitude: </span><span class="mtk6">38.185674462487874</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  },</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    name: </span><span class="mtk11">&#39;Germany&#39;</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    longitude: </span><span class="mtk6">7.587787</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    latitude: </span><span class="mtk6">50.7438</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  },</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    name: </span><span class="mtk11">&#39;Frankreich&#39;</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    longitude: </span><span class="mtk6">3.687787</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    latitude: </span><span class="mtk6">45.753</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  },</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">]</span></span></span></code></pre>
<blockquote>
<p>I know the coordinates of my places. This is not the case in every use case. You may only know the address or the name of a POI. In this case, it would be nice to have a service integrated that calculates the coordinate based on a text. Such a service is called geocoding. If you want to integrate one, have a look at the Openstreetmap variant. This is <a href="https://nominatim.org/">Nominatim</a>.</p>
</blockquote>
<p>Next I will create two new components: <code class="language-text">Marker</code> and <code class="language-text">Markers</code>. I will implement both of them in the file `markers.js</p>
<pre class="grvsc-container solarized-light" data-language="js" data-index="10"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// markers.js</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">React</span><span class="mtk1">, { </span><span class="mtk7">useRef</span><span class="mtk1">, </span><span class="mtk7">useEffect</span><span class="mtk1"> } </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;react&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">maplibregl</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;maplibre-gl&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">Marker</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> ({ map, place }) </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">markerRef</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">useRef</span><span class="mtk1">()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk7">useEffect</span><span class="mtk1">(() </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">marker</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk8">new</span><span class="mtk1"> </span><span class="mtk7">maplibregl</span><span class="mtk1">.</span><span class="mtk7">Marker</span><span class="mtk1">(</span><span class="mtk7">markerRef</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      .</span><span class="mtk7">setLngLat</span><span class="mtk1">([</span><span class="mtk7">place</span><span class="mtk1">.</span><span class="mtk7">longitude</span><span class="mtk1">, </span><span class="mtk7">place</span><span class="mtk1">.</span><span class="mtk7">latitude</span><span class="mtk1">])</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      .</span><span class="mtk7">addTo</span><span class="mtk1">(</span><span class="mtk7">map</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk8">return</span><span class="mtk1"> () </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> </span><span class="mtk7">marker</span><span class="mtk1">.</span><span class="mtk7">remove</span><span class="mtk1">()</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  })</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk8">return</span><span class="mtk1"> </span><span class="mtk3">&lt;</span><span class="mtk7">div</span><span class="mtk1"> </span><span class="mtk3">ref</span><span class="mtk8">=</span><span class="mtk9">{</span><span class="mtk7">markerRef</span><span class="mtk9">}</span><span class="mtk1"> </span><span class="mtk3">/&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">Markers</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> ({ map, places }) </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk8">return</span><span class="mtk1"> (</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk9">{</span><span class="mtk7">places</span><span class="mtk1"> </span><span class="mtk8">&amp;&amp;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk7">places</span><span class="mtk1">.</span><span class="mtk7">map</span><span class="mtk1">((place) </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> (</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          </span><span class="mtk3">&lt;</span><span class="mtk8">Marker</span><span class="mtk1"> </span><span class="mtk3">key</span><span class="mtk8">=</span><span class="mtk9">{</span><span class="mtk7">place</span><span class="mtk1">.</span><span class="mtk7">name</span><span class="mtk9">}</span><span class="mtk1"> </span><span class="mtk3">map</span><span class="mtk8">=</span><span class="mtk9">{</span><span class="mtk7">map</span><span class="mtk9">}</span><span class="mtk1"> </span><span class="mtk3">place</span><span class="mtk8">=</span><span class="mtk9">{</span><span class="mtk7">place</span><span class="mtk9">}</span><span class="mtk1"> </span><span class="mtk3">/&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        ))</span><span class="mtk9">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;/&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  )</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">export</span><span class="mtk1"> </span><span class="mtk8">default</span><span class="mtk1"> </span><span class="mtk7">Markers</span></span></span></code></pre>
<p>The <code class="language-text">Markers</code> component uses two properties of the <code class="language-text">Map</code> component. In React, the properties are called <code class="language-text">props</code>. The first <code class="language-text">props</code> is a reference to the map <code class="language-text">map</code>. The second <code class="language-text">props</code> is the data of the markers. We pass these on to the <code class="language-text">marker</code> component in the <code class="language-text">places</code> property. This component then takes care of the display on the map.</p>
<p>I use the <a href="http://turfjs.org/">Turf.js library</a> to calculate the area of the map that should be displayed. This area is called the bounding box. I want all markers belonging to the blog post to be visible. So it may be that the bounding box represents a small excerpt of the world. But it can also be that the whole world is relevant. For each new call, it is therefore important that the map recalculates the centre point and the zoom level. Next to <code class="language-text">Turf.js</code> I install <code class="language-text">@turf/helpers</code> so that the values are converted into a GeoJson object. This is what the <code class="language-text">Turf.js</code> functions expect.</p>
<pre class="grvsc-container solarized-light" data-language="" data-index="11"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">$ npm install @turf/bbox @turf/helpers</span></span></code></pre>
<p>In the <code class="language-text">map.js</code>, I will create a new <code class="language-text">useEffect()</code> hook. The first effect hook we used was to run <em>once</em> to create a new map, but the markers will be created and removed many times whenever we navigate between pages, so the new effect hook with different dependency array will be necessary.</p>
<pre class="grvsc-container solarized-light" data-language="js" data-index="12"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// map.js</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// add new modules</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">React</span><span class="mtk1">, { </span><span class="mtk7">useRef</span><span class="mtk1">, </span><span class="mtk7">useEffect</span><span class="mtk1">, </span><span class="mtk7">useState</span><span class="mtk1"> } </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;react&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">maplibregl</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;maplibre-gl&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">bbox</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;@turf/bbox&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> { </span><span class="mtk7">multiPoint</span><span class="mtk1"> } </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;@turf/helpers&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">Markers</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;./markers&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk11">&#39;maplibre-gl/dist/maplibre-gl.css&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// ... variables</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">Map</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> () </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk3 mtki">// ... ref, state, useEffect</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk3 mtki">// add new effect hook</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk7">useEffect</span><span class="mtk1">(() </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk8">if</span><span class="mtk1"> (</span><span class="mtk8">!</span><span class="mtk7">map</span><span class="mtk1">) </span><span class="mtk8">return</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk8">if</span><span class="mtk1"> (</span><span class="mtk7">places</span><span class="mtk1">.length </span><span class="mtk8">!==</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">coords</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> []</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk7">places</span><span class="mtk1">.</span><span class="mtk7">forEach</span><span class="mtk1">((place) </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk7">coords</span><span class="mtk1">.</span><span class="mtk7">push</span><span class="mtk1">([</span><span class="mtk7">place</span><span class="mtk1">.</span><span class="mtk7">longitude</span><span class="mtk1">, </span><span class="mtk7">place</span><span class="mtk1">.</span><span class="mtk7">latitude</span><span class="mtk1">])</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      })</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">feature</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">multiPoint</span><span class="mtk1">(</span><span class="mtk7">coords</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">box</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">bbox</span><span class="mtk1">(</span><span class="mtk7">feature</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk7">map</span><span class="mtk1">.</span><span class="mtk7">fitBounds</span><span class="mtk1">(</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        [</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          [</span><span class="mtk7">box</span><span class="mtk1">[</span><span class="mtk6">0</span><span class="mtk1">], </span><span class="mtk7">box</span><span class="mtk1">[</span><span class="mtk6">1</span><span class="mtk1">]],</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          [</span><span class="mtk7">box</span><span class="mtk1">[</span><span class="mtk6">2</span><span class="mtk1">], </span><span class="mtk7">box</span><span class="mtk1">[</span><span class="mtk6">3</span><span class="mtk1">]],</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        ],</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          padding: </span><span class="mtk6">20</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          maxZoom: </span><span class="mtk6">14</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          duration: </span><span class="mtk6">2000</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      )</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    } </span><span class="mtk8">else</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk7">map</span><span class="mtk1">.</span><span class="mtk7">easeTo</span><span class="mtk1">({</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        center: [</span><span class="mtk8">-</span><span class="mtk6">73.9856</span><span class="mtk1">, </span><span class="mtk6">40.7497</span><span class="mtk1">],</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        zoom: </span><span class="mtk6">10</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        duration: </span><span class="mtk6">2000</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      })</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  }, [</span><span class="mtk7">map</span><span class="mtk1">])</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk8">return</span><span class="mtk1"> (</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;</span><span class="mtk7">div</span><span class="mtk1"> </span><span class="mtk3">ref</span><span class="mtk8">=</span><span class="mtk9">{</span><span class="mtk7">mapContainerRef</span><span class="mtk9">}</span><span class="mtk1"> </span><span class="mtk3">style</span><span class="mtk8">=</span><span class="mtk9">{</span><span class="mtk7">mapContainerStyle</span><span class="mtk9">}</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk9">{</span><span class="mtk7">places</span><span class="mtk1"> </span><span class="mtk8">&amp;&amp;</span><span class="mtk1"> </span><span class="mtk7">map</span><span class="mtk1"> </span><span class="mtk8">&amp;&amp;</span><span class="mtk1"> </span><span class="mtk3">&lt;</span><span class="mtk8">Markers</span><span class="mtk1"> </span><span class="mtk3">map</span><span class="mtk8">=</span><span class="mtk9">{</span><span class="mtk7">map</span><span class="mtk9">}</span><span class="mtk1"> </span><span class="mtk3">places</span><span class="mtk8">=</span><span class="mtk9">{</span><span class="mtk7">places</span><span class="mtk9">}</span><span class="mtk1"> </span><span class="mtk3">/&gt;</span><span class="mtk9">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;/</span><span class="mtk7">div</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  )</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">export</span><span class="mtk1"> </span><span class="mtk8">default</span><span class="mtk1"> </span><span class="mtk8">Map</span></span></span></code></pre>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/9fd345cf08b5b6e67fe79fdb1b216dc8/191e2/bloggatsby4.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 47.46835443037975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/ElEQVQoz82OUUvCUBiG9/9/QeBNV3UXRBRhWRRLycnmdLo1NdIMItq0bW7TM8/TaRBEMPCiiz54eL7vcHh5NWtiY5kpTifGcFP6rwV+DA+RxFd4CRiWSbd1iOE0MDsJ86dbrGGLq5uAk0vBeTNg5NcIhwdozbd9rqdHtF96DBayDPIU7sdWGQbLEN2r0526yg7HbpuL5wb6uMeZ6XJ336U+PkWf72FPamiPM4/RzGaZrhBAXkgFZMqZci7WRGJFslVvG0GQLQjygETEBJs1eZaQind1h0RFiIZUKV+UIyv8e68eTaqPUn5DhXdH+3mUPeRuTSob8sfz/wM/AYuUt0u0HO08AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Newly added markers"
        title="Newly added markers"
        src="/static/9fd345cf08b5b6e67fe79fdb1b216dc8/f058b/bloggatsby4.png"
        srcset="/static/9fd345cf08b5b6e67fe79fdb1b216dc8/c26ae/bloggatsby4.png 158w,
/static/9fd345cf08b5b6e67fe79fdb1b216dc8/6bdcf/bloggatsby4.png 315w,
/static/9fd345cf08b5b6e67fe79fdb1b216dc8/f058b/bloggatsby4.png 630w,
/static/9fd345cf08b5b6e67fe79fdb1b216dc8/40601/bloggatsby4.png 945w,
/static/9fd345cf08b5b6e67fe79fdb1b216dc8/78612/bloggatsby4.png 1260w,
/static/9fd345cf08b5b6e67fe79fdb1b216dc8/191e2/bloggatsby4.png 1836w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>We now have markers on the map for a place in Spain, a place in France and one in Germany. MapLibre provides very useful methods like <code class="language-text">fitBounds()</code> and <code class="language-text">easeTo()</code>. There are even more functions and options. See the MapLibre documentation.</p>
<h2>Adding Markdown files</h2>
<p>It's time to use the data from real blog entries instead of the <code class="language-text">places</code> object. I have created Markdown <code class="language-text">.md</code> files in the <code class="language-text">content</code> folder which contain the data for the markers. Here is an example (<code class="language-text">content/spainien.md</code>):</p>
<pre class="grvsc-container solarized-light" data-language="" data-index="13"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">---</span></span>
<span class="grvsc-line"><span class="grvsc-source">title: Spanien</span></span>
<span class="grvsc-line"><span class="grvsc-source">date: 2021-12-27</span></span>
<span class="grvsc-line"><span class="grvsc-source">places:</span></span>
<span class="grvsc-line"><span class="grvsc-source">- {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    name: &quot;Spanien&quot;,</span></span>
<span class="grvsc-line"><span class="grvsc-source">    longitude: -0.687787,</span></span>
<span class="grvsc-line"><span class="grvsc-source">    latitude: 38.185674462487874,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  }</span></span>
<span class="grvsc-line"><span class="grvsc-source">---</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">Die Anreise war ein Abenteuer.</span></span></code></pre>
<h2>Generating pages</h2>
<p>To generate pages from Markdown pages in Gatsby, additional steps are required. Here I will only go into the code that is relevant to our project. First install <code class="language-text">gatsby-transformer-remark</code>.</p>
<pre class="grvsc-container solarized-light" data-language="" data-index="14"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">$ npm install gatsby-transformer-remark</span></span></code></pre>
<p>Next, update the files <code class="language-text">gatsby-config.js</code> and <code class="language-text">gatsby-node.js</code> to include the plugin <code class="language-text">gatsby-transformer-remark</code>.</p>
<pre class="grvsc-container solarized-light" data-language="js" data-index="15"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// gatsby-config.js</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">module</span><span class="mtk1">.</span><span class="mtk8">exports</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  siteMetadata: {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    title: </span><span class="mtk11">`Gatsby MapLibre Blog`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    description: </span><span class="mtk11">``</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    author: </span><span class="mtk11">`Me`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  },</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  plugins: [</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk11">`gatsby-plugin-react-helmet`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      resolve: </span><span class="mtk11">`gatsby-source-filesystem`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      options: {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        name: </span><span class="mtk11">`content`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        path: </span><span class="mtk11">`${</span><span class="mtk1">__dirname</span><span class="mtk11">}/content`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      },</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    },</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk11">`gatsby-transformer-remark`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk11">`gatsby-transformer-sharp`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk11">`gatsby-plugin-sharp`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  ],</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<pre class="grvsc-container solarized-light" data-language="js" data-index="16"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// gatsby-node.js</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">path</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">require</span><span class="mtk1">(</span><span class="mtk11">&#39;path&#39;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk13 mtkb">const</span><span class="mtk1"> { </span><span class="mtk7">createFilePath</span><span class="mtk1"> } </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">require</span><span class="mtk1">(</span><span class="mtk11">`gatsby-source-filesystem`</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">exports</span><span class="mtk1">.</span><span class="mtk7">onCreateNode</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> ({ node, getNode, actions }) </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk13 mtkb">const</span><span class="mtk1"> { </span><span class="mtk7">createNodeField</span><span class="mtk1"> } </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">actions</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk8">if</span><span class="mtk1"> (</span><span class="mtk7">node</span><span class="mtk1">.</span><span class="mtk7">internal</span><span class="mtk1">.</span><span class="mtk7">type</span><span class="mtk1"> </span><span class="mtk8">===</span><span class="mtk1"> </span><span class="mtk11">&#39;MarkdownRemark&#39;</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">slug</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">createFilePath</span><span class="mtk1">({ </span><span class="mtk7">node</span><span class="mtk1">, </span><span class="mtk7">getNode</span><span class="mtk1"> })</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk7">createNodeField</span><span class="mtk1">({</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk7">node</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      name: </span><span class="mtk11">`slug`</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      value: </span><span class="mtk7">slug</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    })</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">exports</span><span class="mtk1">.</span><span class="mtk7">onCreateWebpackConfig</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> ({ stage, loaders, actions }) </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk8">if</span><span class="mtk1"> (</span><span class="mtk7">stage</span><span class="mtk1"> </span><span class="mtk8">===</span><span class="mtk1"> </span><span class="mtk11">&#39;build-html&#39;</span><span class="mtk1"> </span><span class="mtk8">||</span><span class="mtk1"> </span><span class="mtk7">stage</span><span class="mtk1"> </span><span class="mtk8">===</span><span class="mtk1"> </span><span class="mtk11">&#39;develop-html&#39;</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk7">actions</span><span class="mtk1">.</span><span class="mtk7">setWebpackConfig</span><span class="mtk1">({</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      module: {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        rules: [</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            test:</span><span class="mtk9"> /maplibre-gl/</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            use: </span><span class="mtk7">loaders</span><span class="mtk1">.</span><span class="mtk7">null</span><span class="mtk1">(),</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          },</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        ],</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      },</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    })</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">exports</span><span class="mtk1">.</span><span class="mtk7">createPages</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk13 mtkb">async</span><span class="mtk1"> ({ graphql, actions }) </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk13 mtkb">const</span><span class="mtk1"> { </span><span class="mtk7">createPage</span><span class="mtk1"> } </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">actions</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">result</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk8">await</span><span class="mtk1"> </span><span class="mtk7">graphql</span><span class="mtk1">(</span><span class="mtk11">`</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">    query {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">      allMarkdownRemark {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">        edges {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">          node {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">            fields {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">              slug</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">            }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">          }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">        }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">      }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">  `</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk7">result</span><span class="mtk1">.</span><span class="mtk7">data</span><span class="mtk1">.</span><span class="mtk7">allMarkdownRemark</span><span class="mtk1">.</span><span class="mtk7">edges</span><span class="mtk1">.</span><span class="mtk7">forEach</span><span class="mtk1">(({ node }) </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk7">createPage</span><span class="mtk1">({</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      path: </span><span class="mtk7">node</span><span class="mtk1">.</span><span class="mtk7">fields</span><span class="mtk1">.</span><span class="mtk7">slug</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      component: </span><span class="mtk7">path</span><span class="mtk1">.</span><span class="mtk7">resolve</span><span class="mtk1">(</span><span class="mtk11">`./src/templates/postTemplate.js`</span><span class="mtk1">),</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      context: {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        slug: </span><span class="mtk7">node</span><span class="mtk1">.</span><span class="mtk7">fields</span><span class="mtk1">.</span><span class="mtk7">slug</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      },</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    })</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  })</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p>We create the file <code class="language-text">./src/templates/postTemplate.js</code>, which is used as a template for our Markdown files.</p>
<pre class="grvsc-container solarized-light" data-language="js" data-index="17"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// postTemplate.js</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">React</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;react&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> { </span><span class="mtk7">Link</span><span class="mtk1">, </span><span class="mtk7">graphql</span><span class="mtk1"> } </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;gatsby&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">Layout</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;../components/layout&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">PostTemplate</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> ({ data }) </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">frontmatter</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">data</span><span class="mtk1">.</span><span class="mtk7">markdownRemark</span><span class="mtk1">.</span><span class="mtk7">frontmatter</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">html</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">data</span><span class="mtk1">.</span><span class="mtk7">markdownRemark</span><span class="mtk1">.</span><span class="mtk7">html</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk8">return</span><span class="mtk1"> (</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;</span><span class="mtk8">Layout</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk3">&lt;</span><span class="mtk7">div</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk3">&lt;</span><span class="mtk7">h1</span><span class="mtk3">&gt;</span><span class="mtk9">{</span><span class="mtk7">frontmatter</span><span class="mtk1">.</span><span class="mtk7">title</span><span class="mtk9">}</span><span class="mtk3">&lt;/</span><span class="mtk7">h1</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk3">&lt;</span><span class="mtk7">div</span><span class="mtk1"> </span><span class="mtk3">dangerouslySetInnerHTML</span><span class="mtk8">=</span><span class="mtk9">{</span><span class="mtk1">{ __html: </span><span class="mtk7">html</span><span class="mtk1"> }</span><span class="mtk9">}</span><span class="mtk1"> </span><span class="mtk3">/&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk3">&lt;/</span><span class="mtk7">div</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk3">&lt;</span><span class="mtk8">Link</span><span class="mtk1"> </span><span class="mtk3">to</span><span class="mtk8">=</span><span class="mtk11">&quot;/&quot;</span><span class="mtk3">&gt;</span><span class="mtk1">Back to Index</span><span class="mtk3">&lt;/</span><span class="mtk8">Link</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;/</span><span class="mtk8">Layout</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  )</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">export</span><span class="mtk1"> </span><span class="mtk8">default</span><span class="mtk1"> </span><span class="mtk7">PostTemplate</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">export</span><span class="mtk1"> </span><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">pageQuery</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">graphql</span><span class="mtk11">`</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">  query($slug: String!) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">    markdownRemark(fields: { slug: { eq: $slug } }) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">      html</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">      frontmatter {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">        title</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">        places {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">          name</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">          longitude</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">          latitude</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">        }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">      }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">  }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">`</span></span></span></code></pre>
<p>Now it is necessary to restart the development server because we have updated <code class="language-text">gatsby-node.js</code>. If all goes well, Gatsby will generate pages for us.</p>
<h2>Add Navigation</h2>
<p>In order to be able to call the individual pages, we add a simple navigation in a new <code class="language-text">postList</code> component in the file <code class="language-text">postList.js</code>. We use <code class="language-text">useStaticQuery</code> to use GraphQL queries.</p>
<pre class="grvsc-container solarized-light" data-language="js" data-index="18"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// components/postList.js</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">React</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;react&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> { </span><span class="mtk7">Link</span><span class="mtk1">, </span><span class="mtk7">graphql</span><span class="mtk1">, </span><span class="mtk7">useStaticQuery</span><span class="mtk1"> } </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;gatsby&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">query</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">graphql</span><span class="mtk11">`</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">  query MyQuery {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">    allMarkdownRemark {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">      nodes {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">        frontmatter {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">          title</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">        }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">        fields {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">          slug</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">        }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">      }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">  }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk11">`</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">PostList</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> () </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">data</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">useStaticQuery</span><span class="mtk1">(</span><span class="mtk7">query</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">nodes</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">data</span><span class="mtk1">.</span><span class="mtk7">allMarkdownRemark</span><span class="mtk1">.</span><span class="mtk7">nodes</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk8">return</span><span class="mtk1"> (</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;</span><span class="mtk7">ul</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk3">style</span><span class="mtk8">=</span><span class="mtk9">{</span><span class="mtk1">{</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        listStyleType: </span><span class="mtk11">&#39;none&#39;</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        padding: </span><span class="mtk6">0</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      }</span><span class="mtk9">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk9">{</span><span class="mtk7">nodes</span><span class="mtk1">.</span><span class="mtk7">map</span><span class="mtk1">((node) </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">title</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">node</span><span class="mtk1">.</span><span class="mtk7">frontmatter</span><span class="mtk1">.</span><span class="mtk7">title</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk8">return</span><span class="mtk1"> (</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          </span><span class="mtk3">&lt;</span><span class="mtk7">li</span><span class="mtk1"> </span><span class="mtk3">key</span><span class="mtk8">=</span><span class="mtk9">{</span><span class="mtk7">title</span><span class="mtk9">}</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">            </span><span class="mtk3">&lt;</span><span class="mtk8">Link</span><span class="mtk1"> </span><span class="mtk3">to</span><span class="mtk8">=</span><span class="mtk9">{</span><span class="mtk7">node</span><span class="mtk1">.</span><span class="mtk7">fields</span><span class="mtk1">.</span><span class="mtk7">slug</span><span class="mtk9">}</span><span class="mtk3">&gt;</span><span class="mtk9">{</span><span class="mtk7">title</span><span class="mtk9">}</span><span class="mtk3">&lt;/</span><span class="mtk8">Link</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          </span><span class="mtk3">&lt;/</span><span class="mtk7">li</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        )</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      })</span><span class="mtk9">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;/</span><span class="mtk7">ul</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  )</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">export</span><span class="mtk1"> </span><span class="mtk8">default</span><span class="mtk1"> </span><span class="mtk7">PostList</span></span></span></code></pre>
<p>At the end we integrate the navigation <code class="language-text">&lt;PostList /></code> into the layout, i.e. into the file <code class="language-text">layout.js</code>.</p>
<pre class="grvsc-container solarized-light" data-language="js" data-index="19"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// componentes/layout.js</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">React</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;react&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">PropTypes</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;prop-types&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">Map</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;./map&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">import</span><span class="mtk1"> </span><span class="mtk7">PostList</span><span class="mtk1"> </span><span class="mtk8">from</span><span class="mtk1"> </span><span class="mtk11">&#39;./postList&#39;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">Layout</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> ({ children }) </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk8">return</span><span class="mtk1"> (</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk3">&lt;</span><span class="mtk8">Map</span><span class="mtk1"> </span><span class="mtk3">/&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk3">&lt;</span><span class="mtk7">div</span><span class="mtk1"> </span><span class="mtk3">style</span><span class="mtk8">=</span><span class="mtk9">{</span><span class="mtk1">{ margin: </span><span class="mtk11">&#39;0 40px&#39;</span><span class="mtk1"> }</span><span class="mtk9">}</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk3">&lt;</span><span class="mtk7">main</span><span class="mtk3">&gt;</span><span class="mtk9">{</span><span class="mtk7">children</span><span class="mtk9">}</span><span class="mtk3">&lt;/</span><span class="mtk7">main</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk3">&lt;</span><span class="mtk8">PostList</span><span class="mtk1"> </span><span class="mtk3">/&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk3">&lt;/</span><span class="mtk7">div</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;/&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  )</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk7">Layout</span><span class="mtk1">.</span><span class="mtk7">propTypes</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  children: </span><span class="mtk7">PropTypes</span><span class="mtk1">.</span><span class="mtk7">node</span><span class="mtk1">.</span><span class="mtk7">isRequired</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">export</span><span class="mtk1"> </span><span class="mtk8">default</span><span class="mtk1"> </span><span class="mtk7">Layout</span></span></span></code></pre>
<p>We can now navigate between the pages. But everything does still not fit yet. The map is reloaded every time the page is loaded. This causes unnecessary API calls and affects usability. Another problem is that the markers are the same on all pages. We have not yet connected the GraphQL query data to our map component. We need props to handle this.</p>
<h2>Gatsby Browser API</h2>
<p>Why the map reloads <a href="https://www.gatsbyjs.com/docs/how-to/routing/layout-components/#how-to-prevent-layout-components-from-unmounting">can be found on the Gatsby website</a> explains. In short: we need to remove the wrapping <code class="language-text">layout</code> component from our pages and use the <code class="language-text">wrapPageElement</code> browser API in <code class="language-text">gatsby-browser.js</code>. You can find more information about this interface at <a href="https://www.gatsbyjs.com/docs/reference/config-files/gatsby-browser/#wrapPageElement">the API reference</a>.
Use the same code in <code class="language-text">gatsby-ssr.js</code> for server-side rendering.</p>
<pre class="grvsc-container solarized-light" data-language="js" data-index="20"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// gatsby-browser.js &amp; gatsby-ssr.js</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">React</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">require</span><span class="mtk1">(</span><span class="mtk11">&#39;react&#39;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">Layout</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">require</span><span class="mtk1">(</span><span class="mtk11">&#39;./src/components/layout&#39;</span><span class="mtk1">).</span><span class="mtk7">default</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">exports</span><span class="mtk1">.</span><span class="mtk7">wrapPageElement</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> ({ element, props }) </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk8">return</span><span class="mtk1"> </span><span class="mtk3">&lt;</span><span class="mtk8">Layout</span><span class="mtk1"> </span><span class="mtk9">{</span><span class="mtk8">...</span><span class="mtk7">props</span><span class="mtk9">}</span><span class="mtk3">&gt;</span><span class="mtk9">{</span><span class="mtk7">element</span><span class="mtk9">}</span><span class="mtk3">&lt;/</span><span class="mtk8">Layout</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<blockquote>
<p>Remember to remove all layout components. No error will occur, but you will see the map twice.</p>
</blockquote>
<p>If you now navigate between the pages, the map is not reloaded. In the next step, we make sure that the content of the map dynamically adapts to the properties of the blog post.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/9c46e78647711a2aed93c3369bb08779/191e2/bloggatsby5.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 47.46835443037975%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCklEQVQoz62NUUsCQRSF5///gsCXnuoxIoqwjApTamXVVl3bFLTMopq11l13dXbna7DyYSGI8sDhuzOXc66w+01se4ZTm2K5Ec5TijeFm0DjGXdDsOo2jeo2VquEXQsZDc6pd6qcnEn2jhWHFcmtV8DvbCEqz5uc3u1gjR3aE1MQfNp9zwyh/eZT7hZpDF3DFrvuFUf3Jcq9aw5sl4vLBsXePuXRBs1+ATF+GdDp1xg+PjDPIEm1McSGsWGi5gQqIjS7eKGQ8QSZSEI1RS7mJHHITL2at0+Q+ogoMAEZo8xSZya1lM4xP/8skaqULM1WEa21cZ6/t1jd//r4nv8qkS/6T9mykDVr7YUfgzK2vmJgWPUAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Pages and navigation and no reload"
        title="Pages and navigation and no reload"
        src="/static/9c46e78647711a2aed93c3369bb08779/f058b/bloggatsby5.png"
        srcset="/static/9c46e78647711a2aed93c3369bb08779/c26ae/bloggatsby5.png 158w,
/static/9c46e78647711a2aed93c3369bb08779/6bdcf/bloggatsby5.png 315w,
/static/9c46e78647711a2aed93c3369bb08779/f058b/bloggatsby5.png 630w,
/static/9c46e78647711a2aed93c3369bb08779/40601/bloggatsby5.png 945w,
/static/9c46e78647711a2aed93c3369bb08779/78612/bloggatsby5.png 1260w,
/static/9c46e78647711a2aed93c3369bb08779/191e2/bloggatsby5.png 1836w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<h2>Adapt the map component to use props.</h2>
<p>To send different coordinates from the blog posts to our "Map" component, we need to change the <code class="language-text">Map</code> component. We use properties or <code class="language-text">props</code> again.</p>
<pre class="grvsc-container solarized-light" data-language="js" data-index="21"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// in map.js</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// ... remove const places</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// add props &amp; update places to props.places</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">Map</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> props </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">	</span><span class="mtk3 mtki">// ...</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk7">useEffect</span><span class="mtk1">(() </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk8">if</span><span class="mtk1"> (</span><span class="mtk8">!</span><span class="mtk7">map</span><span class="mtk1">) </span><span class="mtk8">return</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk8">if</span><span class="mtk1"> (</span><span class="mtk7">props</span><span class="mtk1">.</span><span class="mtk7">places</span><span class="mtk1"> </span><span class="mtk8">&amp;&amp;</span><span class="mtk1"> </span><span class="mtk7">props</span><span class="mtk1">.</span><span class="mtk7">places</span><span class="mtk1">.length </span><span class="mtk8">!==</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">coords</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> []</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk7">props</span><span class="mtk1">.</span><span class="mtk7">places</span><span class="mtk1">.</span><span class="mtk7">forEach</span><span class="mtk1">(place </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk7">coords</span><span class="mtk1">.</span><span class="mtk7">push</span><span class="mtk1">([</span><span class="mtk7">place</span><span class="mtk1">.</span><span class="mtk7">longitude</span><span class="mtk1">, </span><span class="mtk7">place</span><span class="mtk1">.</span><span class="mtk7">latitude</span><span class="mtk1">])</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      })</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3 mtki">// ...</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  }, [</span><span class="mtk7">map</span><span class="mtk1">, </span><span class="mtk7">props</span><span class="mtk1">.</span><span class="mtk7">places</span><span class="mtk1">])</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk3 mtki">// ...</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk7">useEffect</span><span class="mtk1">(() </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk8">if</span><span class="mtk1"> (</span><span class="mtk8">!</span><span class="mtk7">map</span><span class="mtk1">) </span><span class="mtk8">return</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk8">if</span><span class="mtk1"> (</span><span class="mtk7">props</span><span class="mtk1">.</span><span class="mtk7">places</span><span class="mtk1"> </span><span class="mtk8">&amp;&amp;</span><span class="mtk1"> </span><span class="mtk7">props</span><span class="mtk1">.</span><span class="mtk7">places</span><span class="mtk1">.length </span><span class="mtk8">!==</span><span class="mtk1"> </span><span class="mtk6">0</span><span class="mtk1">) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">coords</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> []</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk7">props</span><span class="mtk1">.</span><span class="mtk7">places</span><span class="mtk1">.</span><span class="mtk7">forEach</span><span class="mtk1">(place </span><span class="mtk13 mtkb">=&gt;</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk7">coords</span><span class="mtk1">.</span><span class="mtk7">push</span><span class="mtk1">([</span><span class="mtk7">place</span><span class="mtk1">.</span><span class="mtk7">longitude</span><span class="mtk1">, </span><span class="mtk7">place</span><span class="mtk1">.</span><span class="mtk7">latitude</span><span class="mtk1">])</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      })</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">feature</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">multiPoint</span><span class="mtk1">(</span><span class="mtk7">coords</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk13 mtkb">const</span><span class="mtk1"> </span><span class="mtk7">box</span><span class="mtk1"> </span><span class="mtk8">=</span><span class="mtk1"> </span><span class="mtk7">bbox</span><span class="mtk1">(</span><span class="mtk7">feature</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk7">map</span><span class="mtk1">.</span><span class="mtk7">fitBounds</span><span class="mtk1">(</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        [</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          [</span><span class="mtk7">box</span><span class="mtk1">[</span><span class="mtk6">0</span><span class="mtk1">], </span><span class="mtk7">box</span><span class="mtk1">[</span><span class="mtk6">1</span><span class="mtk1">]],</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          [</span><span class="mtk7">box</span><span class="mtk1">[</span><span class="mtk6">2</span><span class="mtk1">], </span><span class="mtk7">box</span><span class="mtk1">[</span><span class="mtk6">3</span><span class="mtk1">]],</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        ],</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          padding: </span><span class="mtk6">20</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          maxZoom: </span><span class="mtk6">14</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">          duration: </span><span class="mtk6">2000</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      )</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    } </span><span class="mtk8">else</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk7">map</span><span class="mtk1">.</span><span class="mtk7">easeTo</span><span class="mtk1">({</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        center: [</span><span class="mtk8">-</span><span class="mtk6">73.9856</span><span class="mtk1">, </span><span class="mtk6">40.7497</span><span class="mtk1">],</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        zoom: </span><span class="mtk6">10</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        duration: </span><span class="mtk6">2000</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      })</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  }, [</span><span class="mtk7">map</span><span class="mtk1">, </span><span class="mtk7">props</span><span class="mtk1">.</span><span class="mtk7">places</span><span class="mtk1">])</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk8">return</span><span class="mtk1"> (</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;</span><span class="mtk7">div</span><span class="mtk1"> </span><span class="mtk3">ref</span><span class="mtk8">=</span><span class="mtk9">{</span><span class="mtk7">mapContainerRef</span><span class="mtk9">}</span><span class="mtk1"> </span><span class="mtk3">style</span><span class="mtk8">=</span><span class="mtk9">{</span><span class="mtk7">mapContainerStyle</span><span class="mtk9">}</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk9">{</span><span class="mtk7">props</span><span class="mtk1">.</span><span class="mtk7">places</span><span class="mtk1"> </span><span class="mtk8">&amp;&amp;</span><span class="mtk1"> </span><span class="mtk7">map</span><span class="mtk1"> </span><span class="mtk8">&amp;&amp;</span><span class="mtk1"> </span><span class="mtk3">&lt;</span><span class="mtk8">Markers</span><span class="mtk1"> </span><span class="mtk3">map</span><span class="mtk8">=</span><span class="mtk9">{</span><span class="mtk7">map</span><span class="mtk9">}</span><span class="mtk1"> </span><span class="mtk3">places</span><span class="mtk8">=</span><span class="mtk9">{</span><span class="mtk7">props</span><span class="mtk1">.</span><span class="mtk7">places</span><span class="mtk9">}</span><span class="mtk1"> </span><span class="mtk3">/&gt;</span><span class="mtk9">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;/</span><span class="mtk7">div</span><span class="mtk3">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  )</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<h2>Using the coordinates in the layout component</h2>
<p>Last but not least, the coordinates are passed on to the <code class="language-text">layout</code> component. I use the <code class="language-text">useState()</code> hook because the data is different for each page. So they are updated every time a new page is called. The <code class="language-text">useEffect()</code> hook makes the data update only when <code class="language-text">props</code> changes.</p>
<pre class="grvsc-container solarized-light" data-language="js" data-index="22"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// components/layout.js</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// ...</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk8">return</span><span class="mtk1"> (</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk3">&lt;&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk3">&lt;</span><span class="mtk8">Map</span><span class="mtk1"> </span><span class="mtk3">places</span><span class="mtk8">=</span><span class="mtk9">{</span><span class="mtk7">places</span><span class="mtk9">}</span><span class="mtk1"> </span><span class="mtk3">/&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    // ...</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk3">&lt;/&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk3 mtki">// ...</span></span></span></code></pre>
<p>That's it! Now the data and markers will update correctly.</p>
<p>Todo</p>
<ul>
<li>Popup für jede Markierung hinzufügen</li>
<li>Hinzufügen eines eigenen Markierungsdesigns (z.B. SVG)</li>
<li>Hinzufügen von Marker-Animationen</li>
<li>Hinzufügen von benutzerdefinierten Kartenstilen</li>
</ul>
<h2>Referenzen</h2>
<ul>
<li><a href="https://github.com/maplibre/maplibre-react-examples">maplibre React examples repo</a>: There are only a few examples but I got a lot of help from the repo as they covered almost everything I needed to know.</li>
<li><a href="https://maplibre.org/maplibre-gl-js-docs/api/">Maplibre examples</a>: Most of them are in vanilla JS but using the hooks we covered in this post, I think it would be fairly simple to translate them to React.</li>
<li><a href="https://erraticgenerator.com/blog/gatsby-blog-with-mapbox-gl-js-using-react-hooks/">Mapbox Gatsby Blog with Hooks</a>.</li>
</ul>
<style class="grvsc-styles">
  .grvsc-container {
    overflow: auto;
    position: relative;
    -webkit-overflow-scrolling: touch;
    padding-top: 1rem;
    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));
    padding-bottom: 1rem;
    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));
    border-radius: 8px;
    border-radius: var(--grvsc-border-radius, 8px);
    font-feature-settings: normal;
    line-height: 1.4;
  }
  
  .grvsc-code {
    display: table;
  }
  
  .grvsc-line {
    display: table-row;
    box-sizing: border-box;
    width: 100%;
    position: relative;
  }
  
  .grvsc-line > * {
    position: relative;
  }
  
  .grvsc-gutter-pad {
    display: table-cell;
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  .grvsc-gutter {
    display: table-cell;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter::before {
    content: attr(data-content);
  }
  
  .grvsc-source {
    display: table-cell;
    padding-left: 1.5rem;
    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));
    padding-right: 1.5rem;
    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));
  }
  
  .grvsc-source:empty::after {
    content: ' ';
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter + .grvsc-source {
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  /* Line transformer styles */
  
  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {
    content: ' ';
    position: absolute;
    width: 100%;
  }
  
  .grvsc-line-diff-add::before {
    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));
  }
  
  .grvsc-line-diff-del::before {
    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));
  }
  
  .grvsc-line-number {
    padding: 0 2px;
    text-align: right;
    opacity: 0.7;
  }
  
  .solarized-light { background-color: #FDF6E3; }
  .solarized-light .mtkb { font-weight: bold; }
  .solarized-light .mtki { font-style: italic; }
  .solarized-light .mtk3 { color: #93A1A1; }
  .solarized-light .mtk8 { color: #859900; }
  .solarized-light .mtk1 { color: #657B83; }
  .solarized-light .mtk7 { color: #268BD2; }
  .solarized-light .mtk11 { color: #2AA198; }
  .solarized-light .mtk13 { color: #073642; }
  .solarized-light .mtk9 { color: #D30102; }
  .solarized-light .mtk6 { color: #D33682; }
  .solarized-light .grvsc-line-highlighted::before {
    background-color: var(--grvsc-line-highlighted-background-color, rgba(0, 0, 0, 0.05));
    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(0, 0, 0, 0.2));
  }
</style></div></article><a href="https://github.com/astridx/meinblog/blob/master/content/posts/maplibregl/2021-11-07-maplibre-gatsby-starter-first.steps.en.md" rel="noreferrer" target="_blank">Modify this post</a></section><div id="utterances"><h2>Comments</h2><div class="comments"></div></div><aside><div class="aside-content"><section><h3>Fehler gefunden?</h3><div>Bitte lasse mich wissen, wenn etwas falsch oder unklar ist. Öffne gerne ein<!-- --> <a href="https://github.com/astridx/meinblog/issues/">Github-Issue</a>.</div><h3>Du oder Sie?</h3><div>Ob Du oder Sie - das ist im Deutschen oft gar nicht so leicht zu entscheiden. Manche Leser sieze ich, andere duze ich. Deshalb gibt es im Weblog ein buntes Durcheinander und jeder sucht sich das aus, was für Ihn passt.</div></section></div></aside></main><footer class="footer container"><section class="flex"><nav class="footer-links"><a href="/blog">Blog</a><a href="https://astrid-guenther.de/impressum">Impressum</a><a href="https://astrid-guenther.de/datenschutzerklaerung">Datenschutz</a></nav><nav class="flex"><a href="https://www.gatsbyjs.org/" title="Built with Gatsby" target="_blank" rel="noopener noreferrer" class="img"><img src="/static/gatsby-b7637c262ad964cf2f70abbbfc9e1f93.png" class="footer-img" alt="Gatsby"/></a><a href="https://github.com/astridx" title="Open-source on GitHub" target="_blank" rel="noopener noreferrer" class="img"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNTE3OEEyRTk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNTE3OEEyRjk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTJDOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTJEOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+FYrpWAAABrNJREFUeNrkW2lsVFUUvjMWirYUkS5BXApUa2vd6gL+wAWjoP5RiW2EUBajAiqSuPADQ0w1UUQTrcFAUUSJEKriEuMWFKuJIElFSS24YNpQK6WoBbuAktbva880M8O8vnfevJm+CSf5cme599xzvnfffffce17AJFjycnLzUVwDXAgUAucBY4BMIEOqdQIdwJ/Az4J64OvWtoONibQvkACHgyiuBe4CbgLOjVNlE/AZsAmoBSE9viQAjueieBCYC5yVoAvWDKwHqkBEmy8IgON09lHgXmCESY4cBaqBlSCieUgIgOPDUCwBngBOM0MjXdL/CyDiv6QRAOcvR7EBKDL+kD3AbJBQl1AC4DjrLwaeBYYbf8m/ciu+BCJ6PScAzp+K4nXgTuNveQuYAxK6PSMAzo9C8TFwtUkN2Q7cDBIOx02AOP8FUGpSSzgf3GBHQsDGec7unwOTTWrKDiGhS02ATHjvALeb1JZ3gRlWE+MpVq0yMzIekRk/1YWP6o7Ors5vHI8AXH1Odl8BaTbKrwd4j10MTAduS8JqkKvA94BPgN0A56htNm2OMyDDKNhuSwCcT5dIrMBG6S4oLI1qezqKBcBjwGiPHW8HVgCr0W97VL/fobjMpv2vQAnaHgv/MdYVXurAeSNPhggRw56BQatRVgL3A0H5+xDwI8Dw9g/5Hlq+clmdDYwF8iV0zpb/GP2tApZHOx4m2xwQUCC+VVqOABg+AUUDkO6AgHkwaL2DJXORxPVNylUnw+gpXObaLXFRlxHoaw7U8uoXQ99vViNgqUPnKQfsKojhdW7GuxDW5JUtIuni432hH4JhLJ7Dq6qwcZiPZnpNXDJPfI0kQEJbjVM5PiIgW3nhlkQQILH9LGWnV/iIAK0ts8TngREwDchVKrnKRwRobckVnwcIKFcq4ONrkY8IWBT2SHUq5eEE3Khs/CRm6Z1+8V5sqVQ26/M5gHuhSJ79TqUFmIhOj/ppwQ8/Rshqb5yiWXFQFhsaWeU352UU0KaXlc2mBI1+Y3OzjyO/Gm2kSAIKFQ2awfQ+v3oP23gL/K5oUhh0GPiEZG8KxP97FHULgsqwtTUFCDioqHsGCRipaHA8BQjQrAcyg4roj5KVAgSMUtRNDyqVj0wBAlQ2koBuRf3xKUBAvqJuN1eCrYpAiHNAltNjpyFYDfL47oix38wdmDA5AvYr+kjzWRgcLVcqnKfsJwGNyk5u9TEBtyjrNwaVgRClTPKA/Db8aVOZslkDG2nD2vEuOkqGlLmYpHcGJLlJu8LjtvJFgx06Jvnq8xC33gUBeUE4waWjduua5wdVPrr6VS6cr6PvoXv5Ixed3g3mH/fB1V9OW1w07fM5IEouUEZR4bIWWJzsTRJ55r8I3ONSRRFs3hsIU8hkgkkulf0CPAx8qElQcuk4beYp9Epgoks138LOvqSPgfyAzIwMZlnFSobgIegc4H3gH6AkxmKDub9Mjb0DeoYDrZ1dne0eO14AvfPx8RXgAYaycahbBvt+GLgFpIM0md3PjqrMTMxpYKxB6p1v+s/n7bbSuMCqldmZyc+fRh9ND+IsAxrmG3C3qtj0J1uP84hLrnwnwJbjEQRIxzw0XB2jER93C9Bog9TjsRgzLpzuJr0BzHV6e8gwf9XoziqdCv1YE/oSTQBHwfem/3w+5syPxuukLtfdO0zk+WIs+YuPKLQ7ohzyWTIix3joPPMTLg1d/Yg5gIL7ogf32U/4WGGhYDr+34J6bUALPpPA62w6XYMOP9BaCv3HoD/PeJubODN6U/eEq4cKTIurttpBAZ4L+87TmKdtOt0ah8FbPXS+WnyLEKskqUy5FaweM5dA2e6w+pNkZuajhfMD3/zYBfDKb3Y6+cWwgytOL7bh98nQ73BEgHReIvd4Roy/a6Cs3CRYJOnq7zjV8HWcybC33mpLLKZIA84FPRYhcSokUNL2Civnjd0MjoZbUCy0+PtNkDDD5wQsFB8sxWm2+GJZd8eSt4HnZXnZ66Nb4CHYYxuxat4XmI1inbHeczskq77DMrK4z8AgK3+Q/L5EEMBn/PzQos0zAsQgvg5XY3TpNKOTSAD3NsrQX63TBqq9PVHM9NgvfXi/06ZSjfNqAoQEHj9Pled+pw8cpw2co6aKbSoJxDlJnYniKdP/sqSVrrEw7IBL/TnG+rSXEy7fYVoG/S1uffDkzVEYypB1qewJRCdb5rp9yxN6mQDZFmOS2wisCIXo8Yin7w7LiKiQEcFYfhOMnBmnzo1CLIO09Qyt47niJxDQ29trTmY56Qn4X4ABAFR7IoDmVT5NAAAAAElFTkSuQmCC" class="footer-img" alt="GitHub"/></a><a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=KQMKUVAX5SPVS&amp;source=url" rel="nofollow"><img src="https://camo.githubusercontent.com/48808c433ce8c8ed020ca8bd30816bef7b2f716c3ac00a12279f4cbb3043c5ce/68747470733a2f2f7777772e70617970616c6f626a656374732e636f6d2f656e5f55532f444b2f692f62746e2f62746e5f646f6e61746543435f4c472e676966" alt="" data-canonical-src="https://www.paypalobjects.com/en_US/DK/i/btn/btn_donateCC_LG.gif"/></a></nav></section></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/en/maplibre-blog-with-gatsby/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-e795261d8342deefff90.js"],"app":["/app-6e19340bc1dca09b3b91.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-ad6431e4664bcf916d19.js"],"component---src-pages-404-en-js":["/component---src-pages-404-en-js-09822341b641ee17899b.js"],"component---src-pages-404-js":["/component---src-pages-404-js-4f2740a19f7661111dc1.js"],"component---src-pages-blog-en-js":["/component---src-pages-blog-en-js-733f4727cb894e593cd6.js"],"component---src-pages-blog-js":["/component---src-pages-blog-js-a6149436b1330e16c422.js"],"component---src-pages-index-en-js":["/component---src-pages-index-en-js-fcd4b1a77e2a1665a055.js"],"component---src-pages-index-js":["/component---src-pages-index-js-ad628c2ac4c9f77f1635.js"],"component---src-pages-tutorial-en-js":["/component---src-pages-tutorial-en-js-6cc5a1122f91850d8e4d.js"],"component---src-pages-tutorial-js":["/component---src-pages-tutorial-js-e2056d284cd68d4bd1b5.js"],"component---src-templates-post-js":["/component---src-templates-post-js-8d0f43e9772b68fff69d.js"],"component---src-templates-tag-js":["/component---src-templates-tag-js-8b2eeb038bd3e22c9ce0.js"]};/*]]>*/</script><script src="/polyfill-e795261d8342deefff90.js" nomodule=""></script><script src="/component---src-templates-post-js-8d0f43e9772b68fff69d.js" async=""></script><script src="/cd89b575fbc7744d97a7acf3b55b56387c8b3feb-ecedd2c80549e60c9d95.js" async=""></script><script src="/05f1d64e2e1399e8ce81fd5e37a2b8dc2f9ac157-df620d5817af7d7d7bfc.js" async=""></script><script src="/styles-e9d24b1846c7d6eb9685.js" async=""></script><script src="/app-6e19340bc1dca09b3b91.js" async=""></script><script src="/framework-b17a64ad725e0b3c1338.js" async=""></script><script src="/webpack-runtime-5b70cad0a5335659e3fc.js" async=""></script></body></html>