<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.9bf99681cd954f83432e.css" data-identity="gatsby-global-css">pre[class*=language-].line-numbers{padding-left:3.8em}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{border-right:1px solid #999;left:-3.8em;top:0;-webkit-user-select:none;-ms-user-select:none;user-select:none;width:3em}.line-numbers-rows>span{counter-increment:linenumber;display:block}.line-numbers-rows>span:before{color:#999;content:counter(linenumber);display:block;padding-right:.8em;text-align:right}:root{--primary:#16868f;--secondary:#16868f;--link-color:#fff;--border-color:#111;--heading-font-color:var(--primary);--background-color:#252525;--sidebar-color:#2b2b2b;--navbar-color:#181818;--navbar-color-hover:#272727;--sidebar-color-hover:#383838;--sidebar-color-focus:#444;--category-background-color:#161616;--category-background-color-hover:#1f1f1f;--light-border-color:#444;--toolbar-background-color:#181818;--toolbar-color:#eee;--font-color:#b3b9c5;--medium-font-color:#aaa;--dark-font-color:#8f949d;--bright-font-color:#eee;--input-background:#393939;--blockquote-background-color:rgba(0,0,0,.4);--blockquote-color:var(--dark-font-color);--black:#111;--inline-code-background-color:hsla(0,0%,100%,.08);--inline-code-color:#b3b9c5;--dark-opacity:rgba(0,0,0,.2);--dark-opacity-hover:rgba(0,0,0,.3);--reverse:#111;--scrollbar:var(--border-color);--scrollbar-track:var(--light-border-color);--yellow:#16868f;--button-color:#6b76f3;--page-width:1000px;--font-family:"Source Serif Pro",-apple-system,BlinkMacSystemFont,"Inter","Helvetica Neue","Roboto",Roboto,Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--heading-font-family:-apple-system,BlinkMacSystemFont,"Helvetica Neue","Roboto",Roboto,Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--code-font-family:Menlo,"DM Mono","Roboto Mono",Courier New,monospace}*,:after,:before{box-sizing:border-box}a:focus-visible,button:focus-visible{outline:3px solid var(--primary)}body{-webkit-font-smoothing:antialiased;background:var(--navbar-color);color:var(--font-color);font-family:var(--font-family);font-size:1rem;line-height:1.6;margin:0}blockquote,ol,p,table,ul{color:var(--font-color);font-size:1.2rem;margin:0 0 2rem}button{appearance:none;-moz-appearance:none;-webkit-appearance:none;background:transparent;border:none;border-radius:8px;cursor:pointer;font-family:var(--heading-font-family)}ol li,ul li{margin-bottom:.5rem}ol li p,ul li p{margin:0}ol li ol,ul li ul{margin:.3rem}h1,h2,h3,h4,h5{color:var(--heading-font-color);font-family:var(--heading-font-family);font-weight:600;line-height:1.2;margin:0 0 1.5rem;scroll-margin-top:80px}h3,h4,h5{color:var(--secondary);font-weight:500}a{text-decoration:none}a,a.button{font-family:var(--heading-font-family)}a.button{border:1px solid var(--button-color)!important;border-radius:8px;color:var(--reverse);display:block;font-size:1.1rem;font-weight:600;line-height:1.2;padding:.75rem 1.25rem;text-align:center}a.button,a.button:hover{background:var(--button-color)}a.button:hover{-webkit-filter:brightness(1.2);filter:brightness(1.2)}a.button:active{-webkit-transform:scale(.95);transform:scale(.95)}a.button.icon-button{align-items:center;display:flex}a.button.icon-button img{margin-right:.5rem;max-height:22px}table{border-collapse:separate;border-radius:8px;border-spacing:0;display:block;font-family:var(--heading-font-family);font-size:.95rem;max-width:100%;overflow-x:auto;width:100%}table :not(pre)>code[class*=language-]{font-size:.95rem!important}tbody,thead{white-space:nowrap}th{border-bottom:2px solid var(--light-border-color)}tfoot th{border-top:1px solid var(--light-border-color)}td{border-bottom:1px solid var(--light-border-color)}td,th{-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;padding:.75rem!important;text-align:left;word-break:break-word}tbody tr:nth-child(odd){background-color:var(--dark-opacity)}tbody tr:last-child td:first-of-type{border-bottom-left-radius:8px}tbody tr:last-child td:last-of-type{border-bottom-right-radius:8px}@media screen and (min-width:800px){table{border:1px solid var(--light-border-color);display:table}tbody,thead{white-space:normal}}.sidebar{background:var(--sidebar-color);border-right:1px solid var(--light-border-color);height:100vh;left:0;overflow-x:hidden;overflow-y:hidden;position:fixed;top:0;width:320px;z-index:9}.sidebar:hover{overflow-y:auto}.sidebar .categories{margin-top:60px}.sidebar .title{align-items:center;background:var(--toolbar-background-color);color:var(--font-color);display:flex;font-size:.85rem;font-weight:600;height:35px;justify-content:space-between;padding:0 .5rem 0 2.5rem;position:fixed;text-transform:uppercase;top:0;width:320px;z-index:8}.sidebar button.collapse-categories{height:35px;padding:0 .75rem}.sidebar button.collapse-categories:hover{background:var(--dark-opacity)}.sidebar button.collapse-categories div{border:1px solid var(--font-color);line-height:0;padding:1px 3px}.sidebar button.collapse-categories svg rect{fill:var(--font-color)}.sidebar button.category{align-items:center;background:var(--category-background-color);border:none;border-radius:0;color:var(--bright-font-color);cursor:pointer;display:grid;font-size:.8rem;font-weight:700;grid-template-columns:1.5rem auto;margin-bottom:1px;padding:.75rem 1rem;position:-webkit-sticky;position:sticky;text-align:left;text-transform:uppercase;top:60px;width:100%;z-index:7}.sidebar button.category:hover{background:var(--category-background-color-hover);color:var(--bright-font-color)}.sidebar button.category:focus-visible{background:var(--primary);border-bottom:none;color:var(--reverse)!important;outline:none}.sidebar button.category:focus{color:var(--bright-font-color);outline:none}.sidebar button.category svg{margin-right:.5rem}.sidebar button.category svg path,.sidebar button.category:focus svg path{stroke:var(--bright-font-color)}.sidebar button.category:focus-visible svg path{stroke:var(--reverse)}.sidebar nav{width:320px}.sidebar nav.collapsed{display:none}.sidebar a{align-items:center;border-left:3px solid transparent;color:var(--medium-font-color);display:grid;font-family:var(--heading-font-family);font-size:.85rem;grid-template-columns:2rem auto;line-height:1.2;padding:.4rem 1rem}.sidebar a svg path{-webkit-filter:var(--icon-filter);filter:var(--icon-filter)}.sidebar a:hover{background:var(--sidebar-color-hover);color:var(--bright-font-color)}.sidebar a.active,.sidebar a:focus{background:var(--sidebar-color-focus);border-left:3px solid var(--primary);color:var(--bright-font-color);outline:none}.sidebar a.active svg path{fill:var(--primary)}.container{margin-left:auto;margin-right:auto;max-width:var(--page-width);padding:2rem}.container.large{max-width:1350px}.container.small,.small{max-width:550px}.navigation{background:var(--navbar-color);border-bottom:1px solid var(--light-border-color);height:60px;left:0;position:fixed;top:0;width:100%;z-index:9}.navigation-inner{font-family:var(--heading-font-family);height:100%;margin:0 auto;max-width:var(--page-width);padding:.5rem 1.5rem}.navigation button,.navigation-inner{align-items:center;display:flex;justify-content:space-between}.navigation button{background:transparent;border:none;color:var(--font-color);cursor:pointer;font-weight:500;gap:.5rem;line-height:0;padding:.5rem;position:relative}.navigation button:hover{background:var(--navbar-color-hover);color:var(--bright-font-color)}.navigation button:focus{outline:none}.navigation button:focus-visible{outline:3px solid var(--primary)}.navigation button span{font-size:.9rem}.navigation button svg rect{fill:var(--font-color)}.navigation nav{gap:.6rem;height:100%}.navigation nav,.navigation nav a{align-items:center;display:flex;justify-content:center}.navigation nav a{border-radius:8px;color:var(--font-color);font-size:.9rem;font-weight:500;gap:.4rem;line-height:1.1;padding:.5rem}.navigation nav a.active{color:var(--bright-font-color)}.navigation nav a.brand{font-size:1rem;font-weight:600}.navigation nav a.brand span{white-space:nowrap}.navigation nav a:hover{background:var(--navbar-color-hover);color:var(--bright-font-color)}.navigation nav img{max-height:20px;max-width:25px}.theme-switcher{margin-left:.5rem}.theme-switcher img{max-width:20px}.toolbar-section{align-items:center;display:flex;flex:0 0 155px;justify-content:flex-end}.navigation nav .brand-section{flex:0 0 155px;justify-content:flex-start}.hero{padding:1rem 0}.hero .flex-content{align-items:center}.hero header{padding:2rem 0 0;text-align:left}.hero h1{color:var(--bright-font-color);font-size:3rem;margin-bottom:1.5rem}.hero p.subtitle{color:var(--dark-font-color);font-family:var(--heading-font-family);font-size:1.3rem}.hero .hero-buttons{display:flex;gap:1.5rem}.hero-buttons a.hero-button{align-items:center;border:none;color:var(--dark-font-color);display:flex;font-size:.9rem;gap:.4rem;justify-content:space-between}.hero-buttons a.hero-button:hover{background:transparent;border:none;color:var(--font-color)}.hero-buttons a.hero-button img{display:block;max-height:18px}.bright{color:var(--bright-font-color)}article{padding-bottom:3rem}article header{padding-top:2rem;text-align:center}article h1{color:var(--bright-font-color);font-size:2.5rem;font-weight:700;margin-bottom:.75rem}article h2,article h3,article h4,article h5{margin:0 0 1.25rem}article h4{border-bottom:1px solid var(--light-border-color);margin-bottom:.75rem}article .description{color:var(--dark-font-color);font-family:var(--heading-font-family);font-size:1.45rem;margin-bottom:0}.post-image{margin-bottom:1rem}.post-details{color:var(--dark-font-color);font-family:var(--heading-font-family);font-size:.9rem;margin:.5rem 0}.post-details a{border-bottom:none}.tags{align-items:center;display:flex;flex-wrap:wrap;font-family:var(--heading-font-family);gap:.5rem;justify-content:center;margin:1.5rem 0}.tags a{border:1px solid var(--light-border-color);border-radius:8px;color:var(--bright-font-color);display:inline-block;font-size:.9rem;font-weight:600;line-height:normal;padding:.4rem .6rem;vertical-align:middle}.tags a,.tags a:hover{background:var(--reverse)}.tags a:hover{border:1px solid var(--primary);color:var(--primary)}article a{border-top:2px solid transparent;color:var(--link-color);font-weight:600}article a,article a:hover{border-bottom:2px solid var(--primary)}article a:hover{background:var(--primary);border-top:2px solid var(--primary);color:var(--reverse)}article li a,article li a:hover{border-bottom:none;border-top:none}article img{display:block;max-width:100%}article h2{font-size:1.9rem;padding-bottom:.25rem}article h2 code{border-bottom:1px solid var(--border-color);font-size:2.2rem!important}article h3{font-size:1.75rem}article h3 code{font-size:1.6rem!important}article h4{font-size:1.15rem;padding-bottom:.25rem;text-transform:uppercase}article h4 code{font-size:1.25rem!important}article h5{font-size:1rem;text-transform:uppercase}h2:not(:first-child),h3:not(:first-child),h4:not(:first-child){margin-top:3rem}blockquote{background:var(--blockquote-background-color);border:1px solid var(--light-border-color);border-left:4px solid var(--primary);border-radius:8px;font-family:var(--heading-font-family);padding:1.5rem}blockquote p{color:var(--blockquote-color)}blockquote ul{margin-top:1rem}blockquote p:last-of-type,blockquote ul:last-of-type{margin-bottom:0}.comments{padding-bottom:2rem}.comments h3{font-size:1.75rem}.blog-page h2{border-bottom:1px solid var(--light-border-color);margin-top:2.5rem}a.post{grid-gap:1rem;align-items:center;border:1px solid transparent;display:grid;grid-template-columns:auto 60px;margin-left:-1rem;margin-right:-1rem;padding:.4rem 1rem}a.post.new,a.post:hover{background:var(--dark-opacity);border:1px solid transparent;border-radius:8px;font-family:var(--heading-font-family)}a.post.new{background:transparent;border:1px solid transparent}a.post.new:hover{background:var(--dark-opacity)}a.post.new time{color:var(--secondary)!important}a.post.new h3{color:var(--bright-font-color)}a.post.new .new-badge{color:var(--yellow);margin-left:.75rem}a.post h3{color:var(--font-color);-webkit-filter:brightness(1);filter:brightness(1);font-size:1.1rem;font-weight:500;margin:0}a.post:hover h3{color:var(--bright-font-color)}a.post time,a.post:hover time{color:var(--dark-font-color)}a.post time{display:block;font-family:var(--code-font-family);font-size:.8rem;font-weight:400;text-align:center}.projects{display:flex;flex-direction:column}@media screen and (min-width:600px){.projects{grid-gap:2rem;display:grid;grid-template-columns:repeat(auto-fill,300px);justify-content:center}}.project{background:var(--dark-opacity);border:1px solid var(--border-color);border-radius:8px;color:var(--dark-font-color);display:flex;flex-direction:column;padding:1.5rem}.project h2{border-bottom:none;font-size:1.5rem;margin-bottom:0;text-align:center}.project img{height:auto;margin-top:.5rem;max-height:100px;max-width:100%;-o-object-fit:contain;object-fit:contain}.project .description{color:var(--font-color);font-family:var(--heading-font-family);font-size:1.2rem;line-height:1.3;margin-bottom:1rem;text-align:center}.project .links{display:flex;gap:.5rem}.project .stars{align-items:center;display:flex;gap:.75rem;justify-content:center;margin-top:auto}.project .stars img{margin-top:0;max-width:20px}a.anchor.before{border:none}a.anchor.before:hover{background:transparent}a.anchor.before svg{fill:#fff}a.image-link,a.image-link:hover{border-bottom:none;border-top:none}a.image-link:hover{background:none}.primary-color{color:var(--primary)}.primary-underline{border-bottom:3px solid var(--primary)}.deemphasized{color:var(--dark-font-color)}.gatsby-resp-image-wrapper{margin-left:0!important}a.gatsby-resp-image-link{background:transparent!important;border-bottom:none!important;border-top:none!important}.highlighted{background:var(--primary);color:var(--reverse)}.not-found-image{margin:0 auto}.flex{display:flex}.flex-align-center{align-items:center}.flex-justify-between{justify-content:space-between}.flex-content{gap:1.5rem}.flex-content,.main-header{display:flex;justify-content:space-between}.main-header{align-items:center;border-bottom:1px solid var(--light-border-color)}.main-header a{font-size:1rem}.main-image{border:1px solid var(--light-border-color);border-radius:8px;height:auto;margin-left:2rem;width:250px}.search-bar{grid-gap:1rem;align-items:center;display:grid;grid-template-columns:auto 50px}.search-icon{cursor:pointer;max-width:30px}.search-input{-webkit-appearance:none;background:var(--input-background);border:1px solid var(--light-border-color);border-radius:8px;color:var(--bright-font-color);font-size:1.1rem;line-height:1.1;padding:.75rem 1rem;width:100%}.search-input:active,.search-input:focus,.search-input:hover{border-color:var(--primary)}.search-input:focus{box-shadow:1px 1px 1px var(--primary);-webkit-filter:brightness(1.1);filter:brightness(1.1);outline:none}::-webkit-scrollbar{background:var(--scrollbar);height:8px;width:8px}::-webkit-scrollbar-thumb{background:var(--scrollbar-track);border-radius:0}::selection{background:var(--primary);color:var(--reverse)}::-moz-selection{background:var(--primary);color:var(--reverse)}::marker{color:var(--primary)}.search-input::-webkit-search-cancel-button{color:var(--bright-font-color)}.collapsed .sidebar{display:none}.desktop-only{display:block!important}main{background:var(--background-color);margin-top:60px;min-height:calc(100vh - 215px)}.footer{background:var(--navbar-color);border-top:1px solid var(--light-border-color);font-family:var(--heading-font-family);padding:3rem 0}.footer section{align-items:center;display:flex;flex-direction:column;gap:1.25rem}.footer img{display:inline-block;max-height:20px;width:auto}.footer nav{display:flex;gap:.25rem;margin:0 1rem}.footer a,.footer span{align-items:center;color:var(--dark-font-color);display:flex;font-size:.9rem;line-height:1.2;padding:0 .5rem}.footer span{color:var(--toolbar-color)}.footer a:hover{color:var(--link-color)}@media screen and (max-width:800px){blockquote,ol,p,table,ul{font-size:1.1rem;margin:0 0 1.5rem}.flex-content{flex-direction:column;gap:.5rem}main{margin-top:60px}ol,ul{padding-left:1rem}.navigation nav.social-nav,.sidebar{display:none}.navigation-inner{justify-content:space-between;padding-right:0}.navigation nav{gap:.5rem}.navigation nav a{flex-direction:column;font-size:.8rem;gap:.25rem;padding:0 .25rem}.navigation nav a:hover{background:transparent}.navigation button.theme-switcher{margin-left:0;margin-right:-.5rem;min-width:auto}.navigation nav a.brand{font-size:.9rem;margin-left:0;margin-right:0;padding:0}.navigation nav img{max-width:20px}.toolbar-section{flex:initial;margin-left:0}.navigation nav .brand-section{flex:initial}.navbar img{max-width:30px}.projects{grid-gap:1rem;grid-template-columns:repeat(2,50%)}.project .stars{justify-content:center}.desktop-only{display:none!important}.hero{padding:0}.hero h1{font-size:2.25rem}.hero header{padding:1rem 0 0}.hero .container{padding-bottom:1rem}.hero p.subtitle{font-size:1.2rem}.hero .flex-content,.hero .hero-buttons{align-items:flex-start}.hero .hero-buttons{flex-direction:column;gap:.5rem}.post-image{max-height:75px;max-width:75px}.main-image{margin:0 0 1rem;width:150px}.flex-content div{order:2}.flex-content img{order:1}.container{padding:1rem}.navigation-inner{padding:0 1rem}article{padding-bottom:0}article h1{font-size:2.2rem;line-height:1.2}article h2{font-size:1.8rem}article header{padding-top:1.5rem}article .description{font-size:1.3rem}a.post h3{font-size:1rem}.project img{max-height:50px}}#resume header{text-align:left}#resume section h2,#resume section h3,#resume section h4,#resume section h5{margin-bottom:1rem;margin-top:0}#resume section h2{border-bottom:1px solid var(--light-border-color);font-size:1.1rem;margin-top:2.5rem;text-transform:uppercase}#resume section h3{align-items:center;display:flex;font-weight:600;justify-content:space-between}#resume section h3 span{display:block;font-size:1rem;font-weight:400}#resume section h3{font-size:1.3rem;margin-bottom:.5rem}#resume section li,#resume section p{font-size:1rem;line-height:1.3}#resume section li{margin-bottom:.5rem}.hidden{display:none}:root{--code-font-color:#b3b9c5;--code-background-color:#353535;--string:#92d192;--variable:#f2777a;--property:#abb2bf;--number:#fca369;--operator:#ac8d58;--punctuation:#d5d8df;--comment:#848991;--function:#62cfcf;--keyword:#ffeead;--attribute:#ffd479;--class:#e1a6f2;--tag:#6ab0f3;--error:#f2777a;--terminal-color:var(--code-font-color)}code[class*=language-],pre[class*=language-]{word-wrap:normal;color:var(--code-font-color);font-family:var(--code-font-family);font-size:.9rem!important;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:2;tab-size:2;text-align:left;white-space:pre;word-break:break-word;word-spacing:normal}pre[class*=language-]{-webkit-font-smoothing:subpixel-antialiased;background:var(--code-background-color);border:1px solid var(--light-border-color);border-radius:8px;font-family:Menlo,monospace;margin-bottom:2rem;margin-top:2rem;overflow:initial;padding:1rem}:not(pre)>code[class*=language-]{-webkit-font-smoothing:antialiased;background:var(--inline-code-background-color)!important;color:var(--inline-code-color)!important;font-size:1rem!important;font-weight:600;padding:2px 3px;white-space:pre-wrap}article a:hover code{color:var(--reverse)!important}pre.language-text{background:transparent;margin-left:-1.5rem;padding-bottom:0;padding-top:.5rem}.line-numbers-rows{display:none}pre[class*=language-].line-numbers{counter-reset:linenumber;padding-left:1rem;position:relative}@media screen and (min-width:800px){.line-numbers-rows{display:block}pre.language-text.line-numbers{padding-left:1.5rem!important}pre[class*=language-].line-numbers{padding-left:4rem}pre.language-shell,pre.language-terminal{padding-left:1.5rem!important}pre.language-shell .line-numbers-rows,pre.language-terminal .line-numbers-rows,pre.language-text .line-numbers-rows{display:none}}code.language-text{background:var(--light-background)!important;box-shadow:none;color:var(--font-color)!important}pre.language-text code.language-text{border:none}code.language-shell:before{color:var(--comment);content:"$ "}pre.language-terminal{-webkit-text-size-adjust:none;background:var(--reverse);border:1px solid var(--light-border-color);border-top-left-radius:8px;border-top-right-radius:8px;color:var(--font-color);margin:2rem 0;padding-top:3rem;position:relative;white-space:normal}code.language-terminal{-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:none;-moz-text-size-adjust:none;text-size-adjust:none;color:var(--terminal-color)}pre.language-terminal:before{background:var(--category-background-color);border-bottom:1px solid var(--light-border-color);border-top-left-radius:8px;border-top-right-radius:8px;color:var(--dark-font-color);content:"\2022 \2022 \2022";font-size:2.5rem;left:0;letter-spacing:-5px;line-height:0;margin:0;padding:15px 0 12px;position:absolute;text-indent:6px;top:0;width:100%}.line-numbers .line-numbers-rows{border-right:1px solid #444;font-size:100%;left:-3.8rem;letter-spacing:-1px;padding-right:.5rem;pointer-events:none;position:absolute;top:1rem!important;width:3rem!important}.line-numbers-rows>span:before{color:#777}.gatsby-highlight{-webkit-text-size-adjust:none;-moz-text-size-adjust:none;text-size-adjust:none;font-size:.9rem;margin-bottom:1.5rem;margin-top:1.5rem;max-width:999999px;overflow-x:auto;overflow-y:hidden}.gatsby-highlight pre[class*=language-]{float:left;margin-bottom:0;margin-top:0;min-width:100%}.gatsby-highlight-code-line{background-color:#222;border-left:.25rem solid #74cf74;display:block;margin-left:-1.25rem;margin-right:-1rem;padding-left:1rem;padding-right:1rem}.filename{align-items:center;background:#171717;border-top-left-radius:8px;border-top-right-radius:8px;color:#ccc;display:flex;font-family:var(--heading-font-family);font-size:.9rem;line-height:1;margin-bottom:-2rem;padding:.5rem 1.5rem .9rem}.token.cdata,.token.comment,.token.doctype,.token.important,.token.prolog{color:var(--comment)}.token.punctuation{color:var(--punctuation)}.token.namespace{opacity:.7}.token.property{color:var(--property)}.token.constant,.token.deleted,.token.symbol,.token.tag{color:var(--tag)}.token.number{color:var(--number)}.token.builtin,.token.char,.token.inserted,.token.url{color:var(--code-font-color)}.token.attr-name,.token.selector{color:var(--attribute)}.token.attr-value,.token.string{color:var(--string)}.token.operator{color:var(--operator)}.token.atrule,.token.keyword{color:var(--keyword)}.token.function{color:var(--function)}.language-css,.token.boolean,.token.class-name{color:var(--class)!important}.token.regex{color:var(--keyword)}.token.variable{color:var(--variable)}.token.bold{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.language-jsx .token.class-name{color:var(--tag)!important}code::selection,pre::selection{background:hsla(0,0%,59%,.3)!important;color:inherit;text-shadow:none}code[class*=language-] ::selection,pre[class*=language-]::selection{background:hsla(0,0%,59%,.3)!important;color:inherit;text-shadow:none}pre[class*=language-]{margin-bottom:1.5rem;margin-top:1.5rem}.filename{margin-bottom:-1.9rem}.light{--primary:#16868f;--secondary:#444;--heading-font-color:#222;--link-color:#111;--border-color:#bbb;--light-border-color:#e0e0e0;--background-color:#fff;--sidebar-color:#f0f0f0;--navbar-color:#f0f0f0;--navbar-color-hover:#ddd;--sidebar-color-hover:#dedede;--sidebar-color-focus:#fff;--category-background-color:#d5d5d5;--category-background-color-hover:silver;--toolbar-color:#333;--toolbar-background-color:#f0f0f0;--font-color:#454545;--medium-font-color:#555;--dark-font-color:#888;--input-background:transparent;--bright-font-color:#222;--blockquote-background-color:rgba(0,0,0,.02);--blockquote-color:#111;--inline-code-background-color:rgba(0,0,0,.05);--inline-code-color:#111;--icon-filter:brightness(0.8);--dark-opacity:rgba(0,0,0,.03);--dark-opacity-hover:rgba(0,0,0,.1);--reverse:#fff;--terminal-color:var(--bright-font-color);--scrollbar:#888;--scrollbar-track:#bbb;--yellow:#16868f;--button-color:var(--primary)}.light pre[class*=language-]{border-color:var(--heading-font-color)}.light pre.language-terminal,.light table{border-color:var(--border-color)}.light blockquote{border-left-color:var(--border-color);border-color:var(--border-color) var(--border-color) var(--border-color) var(--primary)}.sepia{--primary:#6c71c4;--secondary:#cb4b16;--heading-font-color:#211806;--link-color:#332810;--border-color:#332810;--light-border-color:#6b4a00;--background-color:#ebdbb2;--sidebar-color:#fef0cf;--navbar-color:#f0d69a;--navbar-color-hover:#e2c175;--sidebar-color-hover:#eed18e;--sidebar-color-focus:#fff6e3;--category-background-color:#d8ba76;--category-background-color-hover:#c8a961;--toolbar-color:#332810;--toolbar-background-color:#fdf6e3;--font-color:#372e19;--medium-font-color:#6b4a00;--dark-font-color:#6b4a00;--input-background:transparent;--bright-font-color:#211806;--blockquote-background-color:rgba(0,0,0,.02);--blockquote-color:#111;--inline-code-background-color:rgba(0,0,0,.05);--inline-code-color:#111;--icon-filter:brightness(0.8);--dark-opacity:rgba(0,0,0,.03);--dark-opacity-hover:rgba(0,0,0,.1);--reverse:#fdf6e3;--terminal-color:var(--bright-font-color);--scrollbar:#a48337;--scrollbar-track:#c8a961;--yellow:#e59e32;--button-color:var(--primary)}.sepia .comments{background:#444;border-radius:8px;margin-bottom:2rem;padding:2rem}.sepia pre[class*=language-]{border-color:var(--heading-font-color)}</style><meta name="generator" content="Gatsby 3.14.6"/><title data-react-helmet="true">React Anwendungen testen | Astrid Günther</title><link data-react-helmet="true" rel="authorization_endpoint" href="https://indieauth.com/auth"/><link data-react-helmet="true" rel="token_endpoint" href="https://tokens.indieauth.com/token"/><link data-react-helmet="true" rel="me" href="https://fimidi.com/@astrid"/><link data-react-helmet="true" rel="me" href="https://github.com/astridx"/><link data-react-helmet="true" rel="me" href="https://codeberg.org/astrid"/><link data-react-helmet="true" rel="me" href="mailto:info@astrid-guenther.de"/><link data-react-helmet="true" rel="me" href="https://twitter.com/astridguenther"/><link data-react-helmet="true" rel="me" href="https://astrid-guenther.de"/><link data-react-helmet="true" rel="webmention" href="https://webmention.io/blog.astrid-guenther.de/webmention"/><link data-react-helmet="true" rel="pingback" href="https://webmention.io/blog.astrid-guenther.de/xmlrpc"/><meta data-react-helmet="true" name="description" content="React Anwendungen testen Das Testen des Quellcodes wird oft vernachlässigt. Dabei ist es wesentlich und zwingend erforderlich. Es ist…"/><meta data-react-helmet="true" name="image" content="https://blog.astrid-guenther.de/logo.png"/><meta data-react-helmet="true" property="og:url" content="https://blog.astrid-guenther.de/react-lernen-react-maintenance-testen/"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="React Anwendungen testen"/><meta data-react-helmet="true" property="og:description" content="React Anwendungen testen Das Testen des Quellcodes wird oft vernachlässigt. Dabei ist es wesentlich und zwingend erforderlich. Es ist…"/><meta data-react-helmet="true" property="og:image" content="https://blog.astrid-guenther.de/logo.png"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="React Anwendungen testen"/><meta data-react-helmet="true" name="twitter:description" content="React Anwendungen testen Das Testen des Quellcodes wird oft vernachlässigt. Dabei ist es wesentlich und zwingend erforderlich. Es ist…"/><meta data-react-helmet="true" name="twitter:image" content="https://blog.astrid-guenther.de/logo.png"/><script data-react-helmet="true" type="application/ld+json">[{"@context":"http://schema.org","@type":"WebSite","url":"https://blog.astrid-guenther.de","name":"React Anwendungen testen","alternateName":"React Anwendungen testen"},{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://blog.astrid-guenther.de/react-lernen-react-maintenance-testen/","name":"React Anwendungen testen","image":"https://blog.astrid-guenther.de/logo.png"}}]},{"@context":"http://schema.org","@type":"BlogPosting","url":"https://blog.astrid-guenther.de","name":"React Anwendungen testen","alternateName":"React Anwendungen testen","headline":"React Anwendungen testen","image":{"@type":"ImageObject","url":"https://blog.astrid-guenther.de/logo.png"},"description":"React Anwendungen testen Das Testen des Quellcodes wird oft vernachlässigt. Dabei ist es wesentlich und zwingend erforderlich. Es ist…"}]</script><link rel="alternate" type="application/rss+xml" title="Astrid Günther | RSS Feed" href="/rss.xml"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link as="script" rel="preload" href="/webpack-runtime-39397f3c9065deef2574.js"/><link as="script" rel="preload" href="/framework-a8bc927eb7481ca28d49.js"/><link as="script" rel="preload" href="/app-41810ff886939bb07aad.js"/><link as="script" rel="preload" href="/commons-dead6f2aafd4c57f7eb7.js"/><link as="script" rel="preload" href="/b84efa9b784e27572a845759437622c93533bed1-af3eca6a1f9625807cd6.js"/><link as="script" rel="preload" href="/component---src-templates-post-js-4c17552cdba24d661280.js"/><link as="fetch" rel="preload" href="/page-data/react-lernen-react-maintenance-testen/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/352937542.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><article class="h-entry"><section class="p-author h-card hidden"><p><a class="u-url" href="https://blog.astrid-guenther.de/react-lernen-react-maintenance-testen/">Astrid Günther</a>created by<img src="/static/me-f1824a760e002339b4da1b33f0f0b776.jpg" alt="Me" class="u-photo"/><span class="p-name" rel="me">Astrid Günther</span>in<span class="p-country-name">Germany</span>.</p><p><span class="p-note">Hi, I’m Astrid, webworker, writer and I like open-source.</span></p></section><header><div class="container"><div class="post-details">Written by<!-- --> <a class="u-url" href="https://astrid-guenther.de"><span>Astrid Günther</span></a> <!-- -->on<a href="https://blog.astrid-guenther.de/react-lernen-react-maintenance-testen/"><time datetime="2021-08-03" class="dt-published"> <!-- -->2021-08-03</time></a></div><h1 class="p-name">React Anwendungen testen</h1><div class="post-meta"><div class="tags p-category"><a class="tag-JavaScript" href="/tags/java-script">JavaScript</a><a class="tag-React" href="/tags/react">React</a></div></div><div class="post-syndication">Syndications:</div><div class="post-booklink"><br/></div></div></header><div id="/react-lernen-react-maintenance-testen/" class="container post-content e-content"><h2 id="react-anwendungen-testen" style="position:relative;"><a href="#react-anwendungen-testen" aria-label="react anwendungen testen permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React Anwendungen testen</h2>
<p>Das Testen des Quellcodes wird oft vernachlässigt. Dabei ist es wesentlich und zwingend erforderlich. Es ist unentbehrlich, die Qualität und Funktionalität des Codes automatisch zu überprüfen, bevor dieser im Echtsystem angewendet wird. Automatisierte Tests sind schneller durchführbar, fehlerfreier und kostengünstiger. Maschinen sind hier dem Menschen überlegen. Die <a href="https://martinfowler.com/articles/practical-test-pyramid.html">Testpyramide</a> dient als Grundregel.</p>
<p>Die Testpyramide umfasst End-to-End-Tests (E2E), Integrationstests und Komponententests (Unit-Tests). Letztere werden für kleine, isolierte Codeblöcke verwendet, zum Beispiel eine einzelne Funktion oder Komponente. Man betrachtet hierbei einen Teilaspekt herausgelöst. Integrationstests helfen uns, herauszufinden, ob diese Einheiten fehlerfrei zusammenarbeiten. Ein End-to-End-Test simuliert ein reales Szenario, beispielsweise den Anmeldevorgang einer Webanwendung.
Unit-Tests laufen schnell ab, sind isolierte Einheiten und somit unkompliziert zu schreiben und zu warten. Auf End-to-End-Tests trifft das Gegenteil zu.
Deshalb sind die Unit-Tests die Basis der Pyramide --- der breitere Teil, der suggeriert, dass diese mengenmäßig überwiegen. Nur der Vollständigkeit halber: Es gibt Entwickler, die die Pyramide auf den Kopf stellen. Je nach Anwendung ist das in Ordnung so. In der Regel ist die breite Basis erwiesenermaßen die passende Wahl.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/a74c76e69a6b417ab551267306e1edb1/d7542/testing-pyramid.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 36.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAoklEQVQoz32Q2wrCMBBET1M1NVZja+IdBPHF//9BCUwhhMV92bDsnMwswA54AR8gYVevPas66Z/AtgwmYAbOwNEQeCACe+1ZQEvHIOGytMxOwA2469MCdQ0wWsAS6dDEHHWGLFCWm7EBTvyJVioI4AVJipzVg95LktmCXeXQycEaWKlHQUM180rldIqujvYGvsBF4k0FHBQpVYBe3cvEQ4bSDymmBRYHZPgXAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="testing pyramid"
        title="testing pyramid"
        src="/static/a74c76e69a6b417ab551267306e1edb1/5a190/testing-pyramid.png"
        srcset="/static/a74c76e69a6b417ab551267306e1edb1/772e8/testing-pyramid.png 200w,
/static/a74c76e69a6b417ab551267306e1edb1/e17e5/testing-pyramid.png 400w,
/static/a74c76e69a6b417ab551267306e1edb1/5a190/testing-pyramid.png 800w,
/static/a74c76e69a6b417ab551267306e1edb1/d7542/testing-pyramid.png 810w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>Scheiben wir zuerst Unit-Tests, die unsere Funktionen und Komponenten abdecken. Danach verwenden wir Integrationstests, um sicherzustellen, dass die einzelnen --- mit Unit-Tests unabhängig geprüften --- Einheiten, wie erwartet zusammenarbeiten. Am Ende benötigen wir End-to-End-Tests, um kritische Szenarien zu simulieren. In diesem Kapitel behandeln wir <strong>Unit und Integrationstests</strong> sowie eine komponentenspezifische Testtechnik namens <strong>Schnappschusstest oder Snapshot Test</strong>. <strong>End-to-End-Tests</strong> werden Teil der Übungen sein.</p>
<p>Da es viele Test-Bibliotheken gibt, ist es als Anfänger schwierig, die passende auszuwählen. Wir werden <a href="https://jestjs.io/">Jest</a> und die <a href="https://testing-library.com/">React Testing Library</a> (RTL) verwenden. Während Jest ein umfassendes Testframework mit Testrunner, Testsuiten, Testfällen und Assertions (Behauptungen) ist, wird die <em>React Testing Library</em> zum Rendern von Komponenten, Auslösen von Ereignissen wie Mausklicks und Auswählen von HTML-Elementen aus dem DOM verwendet. In den nächsten Abschnitten werden wir beide Tools erkunden.</p>
<h3 id="testsuiten-testfälle-und-assertions-behauptungen" style="position:relative;"><a href="#testsuiten-testf%C3%A4lle-und-assertions-behauptungen" aria-label="testsuiten testfälle und assertions behauptungen permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Testsuiten, Testfälle und Assertions (Behauptungen)</h3>
<p>Jest bietet dir alles, was du von einem Test-Framework erwartest. In JavaScript, und in vielen anderen Programmiersprachen, werden häufig Testsuiten und Testfälle verwendet. Während eine Suite mehrere inhaltlich zusammengehörende Fälle vereint, besteht ein Testfall aus einem einzelnen Szenario. Sehen wir uns das mit Jest anhand der Datei <em>src/App.test.js</em> praktisch an. So sieht es aus:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="0"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;something truthy and falsy&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;true to be true&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(true).toBe(true);</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;false to be false&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(false).toBe(false);</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Während der "describe"-Block für die <em>Testsuite</em> steht, sind die "test"-Blöcke die <em>Testfälle</em>. Beachte, dass es möglich ist, Fälle ohne Suite zu verwenden. Für unser Beispiel ist das nicht relevant, mir ist es aber wichtig, es mit einem Codebeispiel zu erwähnen:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="1"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">test(&#39;true to be true&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  expect(true).toBe(true);</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">test(&#39;false to be false&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  expect(false).toBe(false);</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Warum nutzen wir Testsuiten und Testfälle? Es kommt häufig vor, dass beispielsweise eine Funktion oder eine Komponente mehrere Fälle aufweist --- jeder ist Teil eines Szenarios. Eine Testsuite ist in der Regel eine Sammlung der Testfälle, die zusammen einen Vorgang simulieren. Zur Testausführung werden diese in einer Gruppe zusammengefasst aufgerufen. So wird das gesamte Vorgehen getestet. Daher ist es sinnvoll, Testsuiten und Testfälle in Kombination zu verwenden. Manchmal testet man eine aufeinander abgestimmte Abfolge, beispielsweise:</p>
<ul>
<li>Testfall 1: Anmeldung</li>
<li>Testfall 2: Anzeige einer Liste</li>
<li>Testfall 3: Löschung eines Eintrags</li>
<li>Testfall 4: Abmeldung</li>
</ul>
<p>Nachfolgend testen wir Teile der App-Komponente zusammenhängend in einer Testsuite:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="2"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;App component&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;removes an item when clicking the Dismiss button&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;requests some initial stories from an API&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Hast du schon einmal mit Tests gearbeitet und kennst "it"-Blocks? Ein "it"-Block ist das gleiche wie ein "test"-Block. Warum gibt es beide Varianten? In der Vergangenheit wurde "it" genutzt. "test" ist neuer und gibt dem Ganzen einen passenderen Namen. Nenne deinen Block so, wie es dir am liebsten ist.</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="3"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;something truthy and falsy&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  it(&#39;true to be true&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(true).toBe(true);</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  it(&#39;false to be false&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(false).toBe(false);</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Glücklicherweise beinhaltet die <em>Create React App</em> Jest, sodass alle wichtigen Werkzeuge installiert und konfiguriert sind. Führe die Tests mit dem Skript aus der Datei <em>package.json</em> direkt in der Befehlszeile aus. Verwendet dazu den Befehl <code class="language-text">npm test</code>. Du siehst die folgende Ausgabe:</p>
<p>{title="Command Line",lang="text"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="4"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"> PASS  src/App.test.js</span></span>
<span class="grvsc-line"><span class="grvsc-source">  something truthy and falsy</span></span>
<span class="grvsc-line"><span class="grvsc-source">    ✓ true to be true (3ms)</span></span>
<span class="grvsc-line"><span class="grvsc-source">    ✓ false to be false (1ms)</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">Test Suites: 1 passed, 1 total</span></span>
<span class="grvsc-line"><span class="grvsc-source">Tests:       2 passed, 2 total</span></span>
<span class="grvsc-line"><span class="grvsc-source">Snapshots:   0 total</span></span>
<span class="grvsc-line"><span class="grvsc-source">Time:        2.78s, estimated 4s</span></span>
<span class="grvsc-line"><span class="grvsc-source">Ran all test suites related to changed files.</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">Watch Usage</span></span>
<span class="grvsc-line"><span class="grvsc-source"> › Press a to run all tests.</span></span>
<span class="grvsc-line"><span class="grvsc-source"> › Press f to run only failed tests.</span></span>
<span class="grvsc-line"><span class="grvsc-source"> › Press q to quit watch mode.</span></span>
<span class="grvsc-line"><span class="grvsc-source"> › Press p to filter by a filename regex pattern.</span></span>
<span class="grvsc-line"><span class="grvsc-source"> › Press t to filter by a test name regex pattern.</span></span>
<span class="grvsc-line"><span class="grvsc-source"> › Press Enter to trigger a test run.</span></span></code></pre>
<p>Jest vergleicht alle Dateien mit dem Suffix <em>test.js</em> im Dateinamen, wenn der Befehl aufgerufen wird. Erfolgreiche Tests werden grün, fehlgeschlagene rot markiert. Das interaktive Test-Skript überwacht den Code und führt die Tests jedes Mal aus, wenn sich etwas im Code ändert. Es bietet dir zusätzliche Befehle wie das Drücken von "f", um nur fehlgeschlagene, und "a", um alle Tests erneut auszuführen. Probiere das mit einem absichtlich fehlerhaften Test praktisch aus:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="5"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;something truthy and falsy&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;true to be true&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(true).toBe(true);</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;false to be false&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(false).toBe(true);</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Wenn du die Ausführung von <code class="language-text">npm test</code> nicht beendet hast, sie somit bei dir weiterhin aktiv ist, werden deine Tests nach der Änderung im Quellcode automatisch erneut aufgerufen. Du siehst über die Befehlszeilenausgabe einen roten Hinweis bezüglich des fehlgeschlagenen Tests:</p>
<p>{title="Command Line",lang="text"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="6"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"> FAIL  src/App.test.js</span></span>
<span class="grvsc-line"><span class="grvsc-source">  something truthy and falsy</span></span>
<span class="grvsc-line"><span class="grvsc-source">    ✓ true to be true (2ms)</span></span>
<span class="grvsc-line"><span class="grvsc-source">    ✕ false to be false (4ms)</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  ● something truthy and falsy › false to be false</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(received).toBe(expected) // Object.is equality</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    Expected: true</span></span>
<span class="grvsc-line"><span class="grvsc-source">    Received: false</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">       5 |</span></span>
<span class="grvsc-line"><span class="grvsc-source">       6 |   test(&#39;false to be false&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    &gt;  7 |     expect(false).toBe(true);</span></span>
<span class="grvsc-line"><span class="grvsc-source">         |                   ^</span></span>
<span class="grvsc-line"><span class="grvsc-source">       8 |   });</span></span>
<span class="grvsc-line"><span class="grvsc-source">       9 | });</span></span>
<span class="grvsc-line"><span class="grvsc-source">      10 |</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">      at Object.&lt;anonymous&gt; (src/App.test.js:7:19)</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">Test Suites: 1 failed, 1 total</span></span>
<span class="grvsc-line"><span class="grvsc-source">Tests:       1 failed, 1 passed, 2 total</span></span>
<span class="grvsc-line"><span class="grvsc-source">Snapshots:   0 total</span></span>
<span class="grvsc-line"><span class="grvsc-source">Time:        3.385s</span></span>
<span class="grvsc-line"><span class="grvsc-source">Ran all test suites related to changed files.</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">Watch Usage: Press w to show more.</span></span></code></pre>
<p>Mach dich mit der Ausgabe vertraut. Die Texte enthalten alle Informationen, um fehlgeschlagene Tests zu erkennen und so die Ursache zu beheben. Korrigiere den problematischen Test und überprüfe in der Befehlszeile, ob die Ausgabe grün ist.</p>
<p>Ich habe bisher nichts zu Behauptung (Assertion) geschrieben, obwohl diese ebenfalls wichtig sind. Du hast im Beispiel zwei Test-Assertions mit der Funktion <code class="language-text">expect</code> verwendet. <code class="language-text">expect</code> ist von Hause aus in Jest enthalten. Eine Behauptung funktioniert wie folgt: Es wird erwartet, dass die linke Seite (<code class="language-text">expect</code>) mit der rechten (<code class="language-text">toBe</code>) übereinstimmt. <code class="language-text">toBe</code> ist dabei eine von vielen Funktionen, die mit Jest verfügbar sind:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="7"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;something truthy and falsy&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;true to be true&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(true).toBeTruthy();</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;false to be false&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(false).toBeFalsy();</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Tipp: Nutze gleichzeitig zwei Befehlszeilen: eine zum Überwachen deiner Tests (<code class="language-text">npm test</code>) und eine zum Entwickeln der Anwendung (<code class="language-text">npm start</code>). Wenn du eine Versionsverwaltung wie <a href="https://de.wikipedia.org/wiki/Git">Git</a> nutzt, benötigst du unter Umständen eine weitere offene Befehlszeile, um deinen Code zu einem Repository hinzuzufügen.</p>
<h4 id="übungen" style="position:relative;"><a href="#%C3%BCbungen" aria-label="übungen permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Übungen:</h4>
<ul>
<li>Begutachte den <a href="https://codesandbox.io/s/github/the-road-to-learn-react/hacker-stories/tree/hs/react-testing-setup">Quellcode dieses Abschnitts</a>.
<ul>
<li>Reflektiere die <a href="https://github.com/the-road-to-learn-react/hacker-stories/compare/hs/react-modern-final...hs/react-testing-setup?expand=1">Änderungen gegenüber dem Stand der Anwendung am Ende des ersten Kapitels</a>.</li>
</ul>
</li>
<li>Lese mehr über <a href="https://jestjs.io/">Jest</a>.</li>
</ul>
<h3 id="unit-tests-funktionen" style="position:relative;"><a href="#unit-tests-funktionen" aria-label="unit tests funktionen permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Unit-Tests: Funktionen</h3>
<p>Als Erstes schreiben wir einen Unit-Test. Dieser testet eine Komponente oder eine Funktion isoliert. Dies bedeutet, dass wir im Falle einer Funktion nur die Ein- und die Ausgabe testen. Bei einer Komponente testen wir die Eigenschaften (Props) und die Callback-Handler.</p>
<p>Bevor wir etwas in der Datei <em>src/App.js</em> testen ist es erforderlich, dass wir Komponenten und Funktionen exportieren:</p>
<pre class="grvsc-container default-dark" data-language="js" data-index="8"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">...</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk15">export</span><span class="mtk1"> </span><span class="mtk15">default</span><span class="mtk1"> </span><span class="mtk12">App</span><span class="mtk1">;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1"># </span><span class="mtk12">start</span><span class="mtk1">-</span><span class="mtk12">insert</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk15">export</span><span class="mtk1"> { </span><span class="mtk12">storiesReducer</span><span class="mtk1">, </span><span class="mtk12">SearchForm</span><span class="mtk1">, </span><span class="mtk12">InputWithLabel</span><span class="mtk1">, </span><span class="mtk12">List</span><span class="mtk1">, </span><span class="mtk12">Item</span><span class="mtk1"> };</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1"># </span><span class="mtk12">end</span><span class="mtk1">-</span><span class="mtk12">insert</span></span></span></code></pre>
<p>Ich liste dir hier im Abschnitt nicht die Tests für sämtliche Szenarien auf. Vielmehr zeige ich die Implementierung beispielhaft und überlasse es dir, diese zu vervollständigen. Importieren wir als Erstes alles Erforderliche in die Datei <em>src/App.test.js</em>. Wie du siehst, ist React ebenfalls notwendig!</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="9"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">import React from &#39;react&#39;;</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">import App, {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  storiesReducer,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  Item,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  List,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  SearchForm,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  InputWithLabel,</span></span>
<span class="grvsc-line"><span class="grvsc-source">} from &#39;./App&#39;;</span></span></code></pre>
<p>Bevor wir den ersten Unit-Test schreiben, zeige ich dir, wie du eine einzelne JavaScript-Funktion testest. Der beste Kandidat für diesen Testanwendungsfall ist <code class="language-text">storiesReducer</code>. Zunächst definieren wir einige Testdaten und die Testsuite:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="10"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">import React from &#39;react&#39;;</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">...</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">const storyOne = {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  title: &#39;React&#39;,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  url: &#39;https://reactjs.org/&#39;,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  author: &#39;Jordan Walke&#39;,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  num_comments: 3,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  points: 4,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  objectID: 0,</span></span>
<span class="grvsc-line"><span class="grvsc-source">};</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">const storyTwo = {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  title: &#39;Redux&#39;,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  url: &#39;https://redux.js.org/&#39;,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  author: &#39;Dan Abramov, Andrew Clark&#39;,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  num_comments: 2,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  points: 5,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  objectID: 1,</span></span>
<span class="grvsc-line"><span class="grvsc-source">};</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">const stories = [storyOne, storyTwo];</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">describe(&#39;storiesReducer&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;removes a story from all stories&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span></code></pre>
<p>Wenn du dir ansiehst, was zu testen ist, kommst du auf mindestens einen Testfall pro Aktion. Wir werden uns auf einen Test konzentrieren. <code class="language-text">storiesReducer</code> akzeptiert einen Zustand und eine Aktion und gibt einen neuen Zustand zurück. Jeder Test der Reduzierungsfunktion folgt dem gleichen Muster:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="11"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">...</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">describe(&#39;storiesReducer&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;removes a story from all stories&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const action = // TODO: eine Aktion</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const state = // TODO: ein Status</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    const newState = storiesReducer(state, action);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    const expectedState = // TODO: der erwartete Status</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(newState).toBe(expectedState);</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Für unseren speziellen Fall definieren wir eine Aktion <code class="language-text">action</code>, einen Zustand <code class="language-text">state</code> und ein erwartetes Ergebnis <code class="language-text">newState</code>. Letzteres ist im Beispiel wie folgt: Die Liste enthält einen Eintrag weniger, da das Item entfernt wird, welches mit er Aktion an <code class="language-text">storiesReducer</code> übergeben wurde:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="12"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;storiesReducer&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;removes a story from all stories&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const action = { type: &#39;REMOVE_STORY&#39;, payload: storyOne };</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const state = { data: stories, isLoading: false, isError: false };</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    const newState = storiesReducer(state, action);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const expectedState = {</span></span>
<span class="grvsc-line"><span class="grvsc-source">      data: [storyTwo],</span></span>
<span class="grvsc-line"><span class="grvsc-source">      isLoading: false,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      isError: false,</span></span>
<span class="grvsc-line"><span class="grvsc-source">    };</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(newState).toBe(expectedState);</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Auf den ersten Blick sieht es so aus, als ob der Test erfolgreich sein wird. Aber: Er schlägt fehl. Das liegt daran, dass wir hier <code class="language-text">toBe</code> anstelle von <code class="language-text">toStrictEqual</code> verwenden. Die Funktion <code class="language-text">toBe</code> führt einen <a href="https://developer.mozilla.org/de/docs/Web/JavaScript/Vergleiche_auf_Gleichheit_und_deren_Verwendung">strengen Vergleich</a> wie <code class="language-text">newState === expectedState</code> durch. Die Objektreferenz ist nicht dieselbe. Nur der Inhalt des Objekts ist gleich. Daher vergleichen wir in diesem Fall besser mit <code class="language-text">toStrictEqual</code> anstelle von <code class="language-text">toBe</code>:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="13"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;storiesReducer&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;removes a story from all stories&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const action = { type: &#39;REMOVE_STORY&#39;, payload: storyOne };</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const state = { data: stories, isLoading: false, isError: false };</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    const newState = storiesReducer(state, action);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    const expectedState = {</span></span>
<span class="grvsc-line"><span class="grvsc-source">      data: [storyTwo],</span></span>
<span class="grvsc-line"><span class="grvsc-source">      isLoading: false,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      isError: false,</span></span>
<span class="grvsc-line"><span class="grvsc-source">    };</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(newState).toStrictEqual(expectedState);</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Im Falle von JavaScript-Objekte ist es wichtig, zu unterscheiden, ob du einen strengen Vergleich oder nur einen Inhaltsvergleich beabsichtigst. Meistens ist der Inhalt relevant, verwende daher <code class="language-text">toStrictEqual</code>. Für Strings oder boolesche Werte nutzt du weiterhin <code class="language-text">toBe</code>. Beachte, dass es eine <code class="language-text">toEqual</code>-Funktion gibt, die <a href="https://twitter.com/rwieruch/status/1260866850080067584">etwas anders funktioniert</a> als <code class="language-text">toStrictEqual</code>. <code class="language-text">toStrictEqual</code> überprüft zusätzlich, ob zwei Objekte denselben Typ haben.</p>
<p>Kommen wir zurück auf unser Beispiel: Der Test der Funktion <code class="language-text">storiesReducer</code> schließt jetzt erfolgreich ab. Wir geben Werte in diese ein und erwarten eine vordefinierte Ausgabe. Wie erwähnt, folgt eine Reduzierungsfunktion normalerweise demselben Testmuster: Wenn ein Zustand und eine Aktion gegeben sind, erwarten wir ein Ergebnis. Jede Aktion ist ein weiterer Testfall in der Testsuite unseres Reduzierers. Das Testen der verbleibenden Fälle überlasse ich dir als Übung. Du weißt jetzt alles, was dazu notwendig ist.</p>
<h4 id="übungen-1" style="position:relative;"><a href="#%C3%BCbungen-1" aria-label="übungen 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Übungen:</h4>
<ul>
<li>Begutachte den <a href="https://codesandbox.io/s/github/the-road-to-learn-react/hacker-stories/tree/hs/react-testing-unit-function">Quellcode dieses Abschnitts</a>.
<ul>
<li>Reflektiere die <a href="https://github.com/the-road-to-learn-react/hacker-stories/compare/hs/react-testing-setup...hs/react-testing-unit-function?expand=1">Änderungen gegenüber dem Stand der Anwendung am Ende des letzten Kapitels</a>.</li>
</ul>
</li>
<li>Lese mehr über Jests Funktionen wie <code class="language-text">toBe</code> und <code class="language-text">toStrictEqual</code>.</li>
</ul>
<h3 id="unit-tests-komponenten" style="position:relative;"><a href="#unit-tests-komponenten" aria-label="unit tests komponenten permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Unit-Tests: Komponenten</h3>
<p>Nachdem wir eine Funktion in JavaScript mit Jest getestet haben, testen wir jetzt isoliert eine Komponente. Wir nutzen die <em>React Testing Library (RTL)</em>. Diese ist, ebenso wie zuvor Jest, in der <em>Create React App</em> integriert. Wenn du die <em>Create React App</em> nutzt, ist alles schon fertig installiert und konfiguriert. Falls du ein benutzerdefiniertes React-Setup verwendest, beispielsweise React mit Webpack, installierst du die Bibliothek bitte selbst.</p>
<p>Wir nutzen die folgenden RTL-Funktionen für den Komponententest. Ich werde diese Schritt für Schritt erklären. Als Erstes importieren wir sie:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="14"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">import React from &#39;react&#39;;</span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">import {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  render,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  screen,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  fireEvent,</span></span>
<span class="grvsc-line"><span class="grvsc-source">  act,</span></span>
<span class="grvsc-line"><span class="grvsc-source">} from &#39;@testing-library/react&#39;;</span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">...</span></span></code></pre>
<p>Testen wir als Erstes die Item-Komponente. Wichtig ist, dass alle Eigenschaften (Props) entsprechend der Eingabe gerendert werden. Mit anderen Worten: Ist die Ausgabe im HTML korrekt. Wir verwenden im Test die <code class="language-text">render</code>-Funktion, um eine Komponente im HTML anzuzeigen. In diesem Fall rendern wir die Item-Komponente und übergeben ihr als Eigenschaft (Prop) ein <code class="language-text">item</code>-Objekt --- <code class="language-text">storyOne</code> gehört zu den Daten, die wir zuvor extra für die Tests angelegt hatten:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="15"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">describe(&#39;Item&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;renders all properties&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    render(&lt;Item item={storyOne} /&gt;);</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span></code></pre>
<p>Nach dem Rendern verwenden wir die <code class="language-text">debug</code>-Funktion des <code class="language-text">screen</code>-Objekt:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="16"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;Item&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;renders all properties&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    render(&lt;Item item={storyOne} /&gt;);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">    screen.debug();</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Sobald du den Tests mit <code class="language-text">npm test</code> aufrufst, siehst du die Ausgabe der <code class="language-text">debug</code>-Funktion. Alle HTML-Elemente der Komponente (und der untergeordneten) werden ausgegeben. Hinweis: Aktualisiere die <a href="https://github.com/the-road-to-learn-react/hacker-stories/compare/hs/react-testing-unit-function...hs/react-testing-unit-component?expand=1">Versionen von RTL</a> in der Datei <code class="language-text">package.json</code> und führe <code class="language-text">npm install</code> erneut aus, falls du auf ein Problem stößt. Nachfolgend siehst du die konkrete Ausgabe:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="17"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">&lt;body&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">  &lt;div&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">    &lt;div&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">      &lt;span&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">        &lt;a</span></span>
<span class="grvsc-line"><span class="grvsc-source">          href=&quot;https://reactjs.org/&quot;</span></span>
<span class="grvsc-line"><span class="grvsc-source">        &gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">          React</span></span>
<span class="grvsc-line"><span class="grvsc-source">        &lt;/a&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">      &lt;/span&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">      &lt;span&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">        Jordan Walke</span></span>
<span class="grvsc-line"><span class="grvsc-source">      &lt;/span&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">      &lt;span&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">        3</span></span>
<span class="grvsc-line"><span class="grvsc-source">      &lt;/span&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">      &lt;span&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">        4</span></span>
<span class="grvsc-line"><span class="grvsc-source">      &lt;/span&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">      &lt;span&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">        &lt;button</span></span>
<span class="grvsc-line"><span class="grvsc-source">          type=&quot;button&quot;</span></span>
<span class="grvsc-line"><span class="grvsc-source">        &gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">          Dismiss</span></span>
<span class="grvsc-line"><span class="grvsc-source">        &lt;/button&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">      &lt;/span&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">    &lt;/div&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">  &lt;/div&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">&lt;/body&gt;</span></span></code></pre>
<p>Es ist hilfreich, die <code class="language-text">debug</code>-Funktion zu verwenden, bevor und während du die ersten Tests für eine Komponente schreibst. Dies gibt dir den perfekten Überblick über das, was gerendert wird. Hierauf aufbauend integrierst du die Tests. Erstelle weitere Behauptungen (Assertions). Das <code class="language-text">screen</code>-Objekt bietet dir eine Funktion namens <code class="language-text">getByText</code>. Dies ist eine von vielen, die dich bei der Testentwicklung unterstützen:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="18"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;Item&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;renders all properties&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    render(&lt;Item item={storyOne} /&gt;);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.getByText(&#39;Jordan Walke&#39;)).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.getByText(&#39;React&#39;)).toHaveAttribute(</span></span>
<span class="grvsc-line"><span class="grvsc-source">      &#39;href&#39;,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      &#39;https://reactjs.org/&#39;</span></span>
<span class="grvsc-line"><span class="grvsc-source">    );</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Für die beiden Behauptungen (Assertions) verwenden wir zwei neue Funktionen: <code class="language-text">toBeInTheDocument</code> und <code class="language-text">toHaveAttribute</code>. Um zu überprüfen, ob ein Element mit dem Text "Jordan Walke" und ob eines mit dem Text "React" inklusive <code class="language-text">href</code> Attribut im Dokument vorhanden ist.</p>
<p>Die Funktion <code class="language-text">getByText</code> findet die Elemente mit den --- in der Ausgabe sichtbaren --- Texten "Jordan Walke" und "React". Verwende das Äquivalent <code class="language-text">getAllByText</code>, wenn du nach mehr als einem suchst. RTL ist intuitiv aufgebaut. Für viele Funktionen ist diese Namenswahl für die Anwendung auf ein oder alle Elemente entsprechend implementiert.</p>
<p><code class="language-text">getByText</code> gibt das Element mit einem Text zurück, den Benutzer beim Aufruf der Anwendung sehen. Andererseits ist es bedeutsam, wie Nutzer die App verwenden. So ist <code class="language-text">getByText</code> nicht die einzige Suchfunktion. Weitere häufig verwendete sind <code class="language-text">getByRole</code> oder <code class="language-text">getAllByRole</code>:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="19"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;Item&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;renders all properties&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    ...</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;renders a clickable dismiss button&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    render(&lt;Item item={storyOne} /&gt;);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.getByRole(&#39;button&#39;)).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Die Funktion <code class="language-text">getByRole</code> wird zum Abrufen von Elementen anhand von <a href="https://developer.mozilla.org/de/docs/Web/Accessibility/ARIA/ARIA_Techniques/Using_the_aria-label_attribute">Aria-Label-Attributen</a> verwendet. Es gibt <a href="https://developer.mozilla.org/de/docs/Web/Accessibility/ARIA/Roles">implizite Rollen für HTML-Elemente</a> --- ähnliche Schaltflächen für ein Schaltflächenelement. So wählst du Elemente nicht nur nach sichtbarem Text aus, sondern nach ihrer Barrierefreiheit. Eine erwähnenswerte Funktion von <code class="language-text">getRoleBy</code> ist, dass <a href="https://twitter.com/rwieruch/status/1260912349978013696">Rollen vorgeschlagen werden</a>. <code class="language-text">getByText</code> und <code class="language-text">getByRole</code> sind die am häufigsten verwendeten Suchfunktionen von RTL.</p>
<p>Der nächste Schritt ist, nicht nur zu behaupten, dass ein Text <em>im Dokument</em> vorhanden ist, sondern zusätzlich zu überprüfen, dass Ereignisse wie erwartet funktionieren. Klicke beispielsweise auf das Schaltflächenelement der Item-Komponente, und prüfe, ob der Callback-Handler <code class="language-text">handleRemoveItem</code> aufgerufen wird. Hierfür verwenden wir Jest. Wir erstellen die Funktion <code class="language-text">handleRemoveItem</code> mit <code class="language-text">const handleRemoveItem = jest.fn();</code>. Nachdem du ein Klickereignis mit RTL auf der Schaltfläche ausgelöst hast, prüfen wir, ob <code class="language-text">handleRemoveItem</code> aufgerufen wurde.<br>
<code class="language-text">fireEvent.click(screen.getByRole('button'));</code> ist eine unkomplizierte Variante, die wir einsetzen, wenn wir nur eine Schaltfläche auf der Site haben, da <code class="language-text">screen.getByRole('button')</code> andernfalls mehr als ein Element zurückgibt:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="20"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;Item&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;renders all properties&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    ...</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;renders a clickable dismiss button&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    ...</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;clicking the dismiss button calls the callback handler&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const handleRemoveItem = jest.fn();</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    render(&lt;Item item={storyOne} onRemoveItem={handleRemoveItem} /&gt;);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    fireEvent.click(screen.getByRole(&#39;button&#39;));</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(handleRemoveItem).toHaveBeenCalledTimes(1);</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Mit Jest übergeben wir testspezifische Funktionen als Eigenschaft (Props). Diese heißen <strong>spy</strong>, <strong>stub</strong>, oder <strong>mock</strong>; Jedes wird für verschiedene Testszenarien verwendet. <code class="language-text">jest.fn()</code> gibt uns ein <em>mock</em> für die eigentliche Funktion zurück, aus dem wir auslesen, wann und wie sie aufgerufen wird. So verwenden wir Jest-Assertions wie <code class="language-text">toHaveBeenCalledTimes</code>, um die Anzahl der Aufrufe der Funktion zu bestätigen, oder <code class="language-text">toHaveBeenCalledWith</code>, um die übergebenen Argumente zu überprüfen.</p>
<p>Immer wenn wir eine JavaScript-Funktion prüfen, verwenden wir Jest, um eine Funktion zu erstellen --- unabhängig davon, ob wir testen wie oft oder mit welchen Argumenten sie aufgerufen wurde. Nachdem diese implizit mit <code class="language-text">fireEvent</code> ausgelöst wurde, behaupten wir, dass der bereitgestellte Callback-Handler --- welche die Mock-Funktion ist --- einmal aufgerufen wurde.</p>
<p>Bei den letzten Tests haben wir die Eingabe und Ausgabe der Item-Komponente über Rendering und Assertions getestet. Wir untersuchen keine realen Statusänderungen, da nach dem Klick auf die Schaltfläche "Dismiss" kein tatsächliches Element aus dem DOM entfernt wird. Die Logik zum Entfernen aus der Liste ist in der App-Komponente und wir prüfen Item hier isoliert. Später beim Testen der App werden wir die eigentliche Implementierungslogik zum Entfernen eines Elements überprüfen.</p>
<p>Fahren wir mit der SearchForm-Komponente fort, unter der InputWithLabel angeordnet ist. Zunächst Rendern wir diese mithilfe ihrer Eigenschaften (Props):</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="21"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">describe(&#39;SearchForm&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  const searchFormProps = {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    searchTerm: &#39;React&#39;,</span></span>
<span class="grvsc-line"><span class="grvsc-source">    onSearchInput: jest.fn(),</span></span>
<span class="grvsc-line"><span class="grvsc-source">    onSearchSubmit: jest.fn(),</span></span>
<span class="grvsc-line"><span class="grvsc-source">  };</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;renders the input field with its value&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    render(&lt;SearchForm {...searchFormProps} /&gt;);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    screen.debug();</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span></code></pre>
<p>Wir verschaffen uns wieder mithilfe des Debuggens einen Überblick. Danach stellen wir die erste Behauptung (Assertion) für das Suchformular auf. Im Falle von Eingabefeldern ist die Funktion <code class="language-text">getByDisplayValue</code> der perfekte Kandidat. Diese gibt das Feld als Element zurückzugeben. Mit folgendem Test stellen wir sicher, dass das Suchformular beim ersten Aufruf der Anwendung gerendert wird und das Eingabefeld den Text "React" enthält:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="22"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;SearchForm&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  const searchFormProps = { ... };</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;renders the input field with its value&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    render(&lt;SearchForm {...searchFormProps} /&gt;);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.getByDisplayValue(&#39;React&#39;)).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Da das Eingabefeld mit einem Standardwert gerendert wird, verwenden wir diesen in unserer Testbehauptung. Wäre dies nicht der Fall, zeigte das Feld unter Umständen einen Platzhalter mit dem HTML-Attribut <code class="language-text">placeholder</code> an. Dann könnten wir eine andere Funktion von RTL namens <code class="language-text">getByPlaceholderText</code> verwenden, um ein Element mit einem Platzhaltertext zu suchen.</p>
<p>Die Debug-Informationen bietet uns viele Optionen zum Abfragen unseres HTML-Codes. Wir fahren mit einem weiteren Test fort, um das gerenderte Label zu testen:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="23"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;SearchForm&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  const searchFormProps = { ... };</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;renders the input field with its value&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    ...</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;renders the correct label&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    render(&lt;SearchForm {...searchFormProps} /&gt;);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.getByLabelText(/Search/)).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Mit der Funktion <code class="language-text">getByLabelText</code> finden wir ein Element anhand einer Bezeichnung in einem Formular. Dies ist praktisch für Komponenten, die über mehrere Labels und HTML-Steuerelemente verfügen. Hast du bemerkt, wie wir hier den <a href="https://developer.mozilla.org/de/docs/Web/JavaScript/Guide/Regular_Expressions">regulären Ausdruck</a> <code class="language-text">/Search/</code> nutzen? Wenn wir stattdessen eine normale Zeichenfolge verwendet hätten, müssten wir den Doppelpunkt für "Suche:" einfügen. Durch die Verwendung dieses regulären Ausdrucks werden Strings abgeglichen, die die Zeichenfolge "Search" enthalten. Das macht das Auffinden von Elementen wesentlich komfortabler. Falls du bisher keine regulären Ausdrücke verwendest, sieh dir diese einmal an. Sie erleichtern nach einer Einarbeitungszeit in der Regel das Programmieren enorm.</p>
<p>Auf jeden Fall testen wir die interaktiven Teile von SearchForm. Der Callback-Handler<br>
<code class="language-text">searchFormProps.onSearchSubmit</code>, der als Eigenschaften (Props) an die SearchForm-Komponente übergeben wird, ist mit Jest durch eine Mock-Funktion ersetzt (<code class="language-text">onSearchSubmit: jest.fn()</code>). Wir prüfen, ob <code class="language-text">searchFormProps.onSearchSubmit</code> aufgerufen wird --- <code class="language-text">toHaveBeenCalledTimes</code> kennst du schon:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="24"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;SearchForm&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  const searchFormProps = {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    searchTerm: &#39;React&#39;,</span></span>
<span class="grvsc-line"><span class="grvsc-source">    onSearchInput: jest.fn(),</span></span>
<span class="grvsc-line"><span class="grvsc-source">    onSearchSubmit: jest.fn(),</span></span>
<span class="grvsc-line"><span class="grvsc-source">  };</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  ...</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;calls onSearchInput on input field change&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    render(&lt;SearchForm {...searchFormProps} /&gt;);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    fireEvent.change(screen.getByDisplayValue(&#39;React&#39;), {</span></span>
<span class="grvsc-line"><span class="grvsc-source">      target: { value: &#39;Redux&#39; },</span></span>
<span class="grvsc-line"><span class="grvsc-source">    });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(searchFormProps.onSearchInput).toHaveBeenCalledTimes(1);</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;calls onSearchSubmit on button submit click&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    render(&lt;SearchForm {...searchFormProps} /&gt;);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    fireEvent.submit(screen.getByRole(&#39;button&#39;));</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(searchFormProps.onSearchSubmit).toHaveBeenCalledTimes(1);</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Ähnlich wie bei der Item-Komponente haben wir die Eingabe (Props) und die Ausgabe (Callback-Handler) für SearchForm getestet. Der Unterschied besteht darin, dass SearchForm eine untergeordnete Komponente namens InputWithLabel rendert. Wenn du die Debug-Ausgabe erneut überprüfst, wirst du feststellen, dass RTL sich nicht für diese untergeordnete Komponente interessiert. Dies liegt daran, dass sich ein Benutzer an der Stelle ebenfalls nicht für sie interessiert. Daher gibt RTL nur den HTML-Code für uns aus.</p>
<p>Wir haben gesehen, dass alle Callback-Handler-Tests für Item- und SearchForm nur prüfen, ob die Funktionen aufgerufen wurden. Hier findet kein React-Re-Rendering statt, da alle Komponenten isoliert ohne Statusverwaltung getestet werden. Daher setzt der eigentliche Test mit RTL weiter oben im Komponentenbaum an, wo Zustandsänderungen und Seiten-Effekte stattfinden.</p>
<h4 id="übungen-2" style="position:relative;"><a href="#%C3%BCbungen-2" aria-label="übungen 2 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Übungen:</h4>
<ul>
<li>Begutachte den <a href="https://codesandbox.io/s/github/the-road-to-learn-react/hacker-stories/tree/hs/react-testing-unit-component">Quellcode dieses Abschnitts</a>.
<ul>
<li>Reflektiere die <a href="https://github.com/the-road-to-learn-react/hacker-stories/compare/hs/react-testing-unit-function...hs/react-testing-unit-component?expand=1">Änderungen gegenüber dem Stand der Anwendung am Ende des ersten Kapitels</a>.</li>
</ul>
</li>
<li>Lese mehr über die <a href="https://testing-library.com/docs/react-testing-library/intro">React Testing Library</a>.
<ul>
<li>Lese mehr über <a href="https://testing-library.com/docs/guide-which-query">Suchfunktionen</a>.</li>
</ul>
</li>
<li>Füge Tests für Ihre List- und InputWithLabel-Komponenten hinzu.</li>
</ul>
<h3 id="integrationstests-komponenten" style="position:relative;"><a href="#integrationstests-komponenten" aria-label="integrationstests komponenten permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Integrationstests: Komponenten</h3>
<p>Die React Testing Library basiert auf einer Kernphilosophie: Anstatt die Implementierungsdetails der React-Komponenten zu prüfen, testen wir, wie ein Benutzer mit unserer Anwendung interagieren würde und ob bei der Interaktion alles wie erwartet funktioniert. Dies ist effektiv und gilt insbesondere für Integrationstests.</p>
<p>Um die App-Komponente zu testen, sind Daten erforderlich. Deshalb importieren wir Axios und erstellen eine Mock-Funktion, die wir in der App für unsere Datenanforderung verwenden:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="25"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">...</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">import axios from &#39;axios&#39;;</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">...</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">jest.mock(&#39;axios&#39;);</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">...</span></span></code></pre>
<p>Implementiere dann die Daten, die du von einer vorgetäuschten (mock) API-Anforderung zurückgibst, mit einem Promis-Objekt und verwende diese für das Axios-Mock. Danach rendern wir unsere Komponente. Probiere es aus aber sei nicht enttäuscht: Du wirst auf einen Fehler stoßen. Diesen beheben wir im nächsten Schritt:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="26"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">describe(&#39;App&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;succeeds fetching data&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const promise = Promise.resolve({</span></span>
<span class="grvsc-line"><span class="grvsc-source">      data: {</span></span>
<span class="grvsc-line"><span class="grvsc-source">        hits: stories,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      },</span></span>
<span class="grvsc-line"><span class="grvsc-source">    });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    axios.get.mockImplementationOnce(() =&gt; promise);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    render(&lt;App /&gt;);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    screen.debug();</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span></code></pre>
<p>Jetzt verwenden wir die <code class="language-text">act</code>-Funktion, um darauf zu warten, dass unser Versprechen (Promise) nach dem ersten Rendern der Komponente aufgelöst wird. Mit await implementieren wir dies. Das Tolle an der <code class="language-text">debug</code>-Funktion ist, dass sie die Elemente der App-Komponente vor und nach der Anfrage für uns ausgibt. Sieh es dir praktisch an! Nachfolgend findest du den Code dazu:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="27"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;App&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;succeeds fetching data&#39;, async () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const promise = Promise.resolve({</span></span>
<span class="grvsc-line"><span class="grvsc-source">      data: {</span></span>
<span class="grvsc-line"><span class="grvsc-source">        hits: stories,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      },</span></span>
<span class="grvsc-line"><span class="grvsc-source">    });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    axios.get.mockImplementationOnce(() =&gt; promise);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    render(&lt;App /&gt;);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    screen.debug();</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">    await act(() =&gt; promise);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    screen.debug();</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Wenn wir die <code class="language-text">debug</code>-Ausgabe auswerten, sehen wir, dass der Ladeindikator <code class="language-text">Loading ...</code> für den ersten Aufruf gerendert wird, für den zweiten aber nicht. Dies liegt daran, dass das Abrufen der Daten --- und das erneute Rendern der Komponente --- abgeschlossen ist, nachdem wir das Versprechen in unserem Test mit <code class="language-text">act</code> gelöst haben. Testen wir den Ladeindikator für den zweiten Fall:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="28"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;App&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;succeeds fetching data&#39;, async () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const promise = Promise.resolve({</span></span>
<span class="grvsc-line"><span class="grvsc-source">      data: {</span></span>
<span class="grvsc-line"><span class="grvsc-source">        hits: stories,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      },</span></span>
<span class="grvsc-line"><span class="grvsc-source">    });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    axios.get.mockImplementationOnce(() =&gt; promise);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    render(&lt;App /&gt;);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.queryByText(/Loading/)).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    await act(() =&gt; promise);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.queryByText(/Loading/)).toBeNull();</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Wir verwenden dieses Mal <code class="language-text">queryByText</code> anstelle von <code class="language-text">getByText</code>, da wir testen, ob ein zurückgegebenes Element nicht mehr vorhanden ist. Wenn wir <code class="language-text">getByText</code> verwendeten, sähen wir eine Fehlermeldung, da nichts gefunden wird. Aber mit <code class="language-text">queryByText</code> erhalten wir nur einen Fehler, wenn kein Element vorhanden ist.</p>
<p>Wieder verwenden wir einen regulären Ausdruck <code class="language-text">/Loading/</code> anstelle eines Strings <code class="language-text">'Loading'</code>. Wenn wir eine Zeichenfolge verwendeten, wäre es erforderlich, dass wir explizit <code class="language-text">'Loading ...'</code> anstelle von <code class="language-text">'Loading'</code> einsetzen. So ist es unkomplizierter.</p>
<p>Als Nächstes prüfen wir, ob die abgerufenen Daten wie erwartet gerendert werden:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="29"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;App&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;succeeds fetching data&#39;, async () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const promise = Promise.resolve({</span></span>
<span class="grvsc-line"><span class="grvsc-source">      data: {</span></span>
<span class="grvsc-line"><span class="grvsc-source">        hits: stories,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      },</span></span>
<span class="grvsc-line"><span class="grvsc-source">    });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    axios.get.mockImplementationOnce(() =&gt; promise);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    render(&lt;App /&gt;);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.queryByText(/Loading/)).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    await act(() =&gt; promise);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.queryByText(/Loading/)).toBeNull();</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.getByText(&#39;React&#39;)).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.getByText(&#39;Redux&#39;)).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.getAllByText(&#39;Dismiss&#39;).length).toBe(2);</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>So, wie wir es gerne hätten, haben wir es jetzt getestet. Auf ähnliche Art und Weise testen wir den Fehlerfall --- eine fehlgeschlagene API-Anfrage. Das einzige, was wir ändern, ist, dass das Versprechen (Promise) abgelehnt wird und dass der Fehler mit einem Try/Catch-Block abgefangen wird:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="30"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;App&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;succeeds fetching data&#39;, async () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    ...</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;fails fetching data&#39;, async () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const promise = Promise.reject();</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    axios.get.mockImplementationOnce(() =&gt; promise);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    render(&lt;App /&gt;);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.getByText(/Loading/)).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    try {</span></span>
<span class="grvsc-line"><span class="grvsc-source">      await act(() =&gt; promise);</span></span>
<span class="grvsc-line"><span class="grvsc-source">    } catch (error) {</span></span>
<span class="grvsc-line"><span class="grvsc-source">      expect(screen.queryByText(/Loading/)).toBeNull();</span></span>
<span class="grvsc-line"><span class="grvsc-source">      expect(screen.queryByText(/went wrong/)).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source">    }</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Stellst du dir die Frage, wann du <code class="language-text">getBy</code> und wann <code class="language-text">queryBy</code> verwendest? Als Faustregel: Gebrauche <code class="language-text">getBy</code> für einzelne und <code class="language-text">getAllBy</code> für mehrere Elemente. Wenn du nach etwas suchst, das unter Umständen nicht vorhanden ist, nutze <code class="language-text">queryBy</code> (oder <code class="language-text">queryAllBy</code>). Der Einfachheit halber habe ich in diesem Beispiel ausschließlich <code class="language-text">queryBy</code> verwendet.</p>
<p>Wir wissen, dass das anfängliche Abrufen von Daten jetzt für unsere App-Komponente funktioniert. Als Nächstes testen wir die Benutzerinteraktionen, die wir zuvor nur in den untergeordneten Komponenten getestet haben, indem wir Ereignisse ohne Status und Seiten-Effekte ausgelöst haben. Wir entfernen ein Element aus der Liste, nachdem die Daten erfolgreich abgerufen wurden. Da "Jordan Walke" unser erste Eintrag ist, wird er entfernt, wenn wir auf die oberste "Dismiss"-Schaltfläche klicken:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="31"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;App&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  ...</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;removes a story&#39;, async () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const promise = Promise.resolve({</span></span>
<span class="grvsc-line"><span class="grvsc-source">      data: {</span></span>
<span class="grvsc-line"><span class="grvsc-source">        hits: stories,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      },</span></span>
<span class="grvsc-line"><span class="grvsc-source">    });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    axios.get.mockImplementationOnce(() =&gt; promise);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    render(&lt;App /&gt;);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    await act(() =&gt; promise);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.getAllByText(&#39;Dismiss&#39;).length).toBe(2);</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.getByText(&#39;Jordan Walke&#39;)).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    fireEvent.click(screen.getAllByText(&#39;Dismiss&#39;)[0]);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.getAllByText(&#39;Dismiss&#39;).length).toBe(1);</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.queryByText(&#39;Jordan Walke&#39;)).toBeNull();</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Als Nächstes werden wir die Suchfunktion testen. Wir richten das Mock etwas anders als zuvor ein, weil wir nicht nur die anfängliche Suchanfrage beachten. Wir decken zusätzlich potentielle zukünftige Suchen ab:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="32"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;App&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  ...</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;searches for specific stories&#39;, async () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const reactPromise = Promise.resolve({</span></span>
<span class="grvsc-line"><span class="grvsc-source">      data: {</span></span>
<span class="grvsc-line"><span class="grvsc-source">        hits: stories,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      },</span></span>
<span class="grvsc-line"><span class="grvsc-source">    });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    const anotherStory = {</span></span>
<span class="grvsc-line"><span class="grvsc-source">      title: &#39;JavaScript&#39;,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      url: &#39;https://en.wikipedia.org/wiki/JavaScript&#39;,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      author: &#39;Brendan Eich&#39;,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      num_comments: 15,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      points: 10,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      objectID: 3,</span></span>
<span class="grvsc-line"><span class="grvsc-source">    };</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    const javascriptPromise = Promise.resolve({</span></span>
<span class="grvsc-line"><span class="grvsc-source">      data: {</span></span>
<span class="grvsc-line"><span class="grvsc-source">        hits: [anotherStory],</span></span>
<span class="grvsc-line"><span class="grvsc-source">      },</span></span>
<span class="grvsc-line"><span class="grvsc-source">    });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    axios.get.mockImplementation(url =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">      if (url.includes(&#39;React&#39;)) {</span></span>
<span class="grvsc-line"><span class="grvsc-source">        return reactPromise;</span></span>
<span class="grvsc-line"><span class="grvsc-source">      }</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">      if (url.includes(&#39;JavaScript&#39;)) {</span></span>
<span class="grvsc-line"><span class="grvsc-source">        return javascriptPromise;</span></span>
<span class="grvsc-line"><span class="grvsc-source">      }</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">      throw Error();</span></span>
<span class="grvsc-line"><span class="grvsc-source">    });</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Anstatt die Anfrage einmal mit Jest (<code class="language-text">mockImplementationOnce</code>) zu simulieren, täuschen wir jetzt mehrere Anfragen (<code class="language-text"> mockImplementation</code>) vor. Abhängig von der eingehenden URL gibt die Anforderung entweder die ursprüngliche ("React") oder die neue Liste ("JavaScript") zurück. Für den Fall, dass wir eine falsche URL für die Anfrage angeben, wird beim Test ein Fehler ausgegeben. Dies ist gleichzeitig ein Hinweis, dass wir den Test nicht korrekt eingerichtet haben. Lasse uns wie zuvor die App-Komponente rendern:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="33"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;App&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  ...</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;searches for specific stories&#39;, async () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const reactPromise = Promise.resolve({ ... });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    const anotherStory = { ... };</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    const javascriptPromise = Promise.resolve({ ... });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    axios.get.mockImplementation((url) =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">      ...</span></span>
<span class="grvsc-line"><span class="grvsc-source">    });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">    // Initial Render</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    render(&lt;App /&gt;);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    // First Data Fetching</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    await act(() =&gt; reactPromise);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.queryByDisplayValue(&#39;React&#39;)).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.queryByDisplayValue(&#39;JavaScript&#39;)).toBeNull();</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.queryByText(&#39;Jordan Walke&#39;)).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(</span></span>
<span class="grvsc-line"><span class="grvsc-source">      screen.queryByText(&#39;Dan Abramov, Andrew Clark&#39;)</span></span>
<span class="grvsc-line"><span class="grvsc-source">    ).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.queryByText(&#39;Brendan Eich&#39;)).toBeNull();</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Wir lösen das erste Versprechen für das anfängliche Rendern und erwarten, dass das Eingabefeld "React" und die beiden Elemente in der Liste die Ersteller von React und Redux rendert. Wir stellen außerdem sicher, dass kein JavaScript bezogener Eintrag angezeigt wird. Als Nächstes ändern wir den Wert des Eingabefelds mittels <code class="language-text">fireEvent.change(...)</code>:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="34"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;App&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  ...</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;searches for specific stories&#39;, async () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    ...</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.queryByText(&#39;Jordan Walke&#39;)).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(</span></span>
<span class="grvsc-line"><span class="grvsc-source">      screen.queryByText(&#39;Dan Abramov, Andrew Clark&#39;)</span></span>
<span class="grvsc-line"><span class="grvsc-source">    ).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.queryByText(&#39;Brendan Eich&#39;)).toBeNull();</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">    // User Interaction -&gt; Search</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    fireEvent.change(screen.queryByDisplayValue(&#39;React&#39;), {</span></span>
<span class="grvsc-line"><span class="grvsc-source">      target: {</span></span>
<span class="grvsc-line"><span class="grvsc-source">        value: &#39;JavaScript&#39;,</span></span>
<span class="grvsc-line"><span class="grvsc-source">      },</span></span>
<span class="grvsc-line"><span class="grvsc-source">    });</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.queryByDisplayValue(&#39;React&#39;)).toBeNull();</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(</span></span>
<span class="grvsc-line"><span class="grvsc-source">      screen.queryByDisplayValue(&#39;JavaScript&#39;)</span></span>
<span class="grvsc-line"><span class="grvsc-source">    ).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Zuletzt senden wir diese Suchanforderung, indem wir die Schaltfläche klicken. Der neue Suchbegriff wird aus dem Status der App-Komponente verwendet. Daher wird jetzt nach JavaScript bezogenen Einträgen gesucht, die wir zuvor "gemocked" haben:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="35"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;App&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  ...</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;searches for specific stories&#39;, async () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    ...</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.queryByDisplayValue(&#39;React&#39;)).toBeNull();</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(</span></span>
<span class="grvsc-line"><span class="grvsc-source">      screen.queryByDisplayValue(&#39;JavaScript&#39;)</span></span>
<span class="grvsc-line"><span class="grvsc-source">    ).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">    fireEvent.submit(screen.queryByText(&#39;Submit&#39;));</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    // Zweiter Datenabruf</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    await act(() =&gt; javascriptPromise);</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.queryByText(&#39;Jordan Walke&#39;)).toBeNull();</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(</span></span>
<span class="grvsc-line"><span class="grvsc-source">      screen.queryByText(&#39;Dan Abramov, Andrew Clark&#39;)</span></span>
<span class="grvsc-line"><span class="grvsc-source">    ).toBeNull();</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(screen.queryByText(&#39;Brendan Eich&#39;)).toBeInTheDocument();</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Jetzt wird Brendan Eich als Schöpfer von JavaScript gerendert, während die anderen nicht mehr angezeigt werden. Der letzte Test hat gezeigt, wie du ein Testszenario in einem Testfall darstellst. Mit unseren Tools durchlaufen wir jeden Schritt --- das anfängliche Abrufen, das Ändern des Werts des Eingabefelds, das Senden des Formulars und das Anfragen neuer Daten von der API.</p>
<p>Die React Testing Library und Jest sind in Kombination der Status quo, beim Testen von React-Anwendungen. Während RTL dir alle relevanten Testtools für React bietet, wird Jest mit dem allgemeinen Testframework für Testsuiten, Testfälle, Assertions und Mock-Funktionen geliefert. Der Vollständigkeit halber: Eine beliebte Alternative zu RTL ist [Enzyme] (<a href="https://www.robinwieruch.de/react-testing-jest-enzyme">https://www.robinwieruch.de/react-testing-jest-enzyme</a>) von Airbnb.</p>
<h4 id="übungen-3" style="position:relative;"><a href="#%C3%BCbungen-3" aria-label="übungen 3 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Übungen:</h4>
<ul>
<li>Begutachte den <a href="https://codesandbox.io/s/github/the-road-to-learn-react/hacker-stories/tree/hs/react-testing-integration">Quellcode dieses Abschnitts</a>.
<ul>
<li>Reflektiere die <a href="https://github.com/the-road-to-learn-react/hacker-stories/compare/hs/react-testing-unit-component...hs/react-testing-integration?expand=1">Änderungen gegenüber dem Stand der Anwendung am Ende des vorherigen Kapitels</a>.</li>
</ul>
</li>
<li>Lese mehr zu <a href="https://www.robinwieruch.de/react-testing-cypress">E2E-Tests in React</a>.</li>
<li>Halten deine Tests grün und füge neue hinzu während du weiter im Buch arbeitetst.</li>
</ul>
<h3 id="schnappschuss-tests" style="position:relative;"><a href="#schnappschuss-tests" aria-label="schnappschuss tests permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Schnappschuss-Tests</h3>
<p>Facebook kam unabhängig von der Testpyramide auf die Idee, Schnappschuss-Tests in React durchzuführen. Ziel war eine unkompliziertere Vorgehensweise. Grundsätzlich ist ein "Snapshot-Test" eine Momentaufnahme. Diese wird verwendet, um sie mit anderen zu vergleichen. Wenn sich die Ausgabe der Komponente geändert hat, wird die Differenz angezeigt und der Schnappschuss-Test schlägt fehl. Ergo: Du siehst einen Fehler, wenn sich die Ausgabe der Komponente bei gleichen Testvoraussetzungen ändert. Falls ein Schnappschuss-Test fehlschlägt, hast du zwei Möglichkeiten: Du akzeptierst das Ergebnis oder du lehnst es ab. Bei Ersterem bestätigst du die Abweichung als korrekt. Bei Letzterem gibt es de facto einen Fehler und du korrigierst die Implementierung der Komponente.</p>
<p>Durch die Verwendung von Schnappschüssen hältst du deine Tests leichtgewichtig. Du prüfst, ohne die Implementierungsdetails der Komponente zu kennen. Sehen wir uns das praktisch an:</p>
<p>{title="src/App.test.js",lang="javascript"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="36"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">describe(&#39;SearchForm&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">  ...</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"># start-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">  test(&#39;renders snapshot&#39;, () =&gt; {</span></span>
<span class="grvsc-line"><span class="grvsc-source">    const { container } = render(&lt;SearchForm {...searchFormProps} /&gt;);</span></span>
<span class="grvsc-line"><span class="grvsc-source">    expect(container.firstChild).toMatchSnapshot();</span></span>
<span class="grvsc-line"><span class="grvsc-source">  });</span></span>
<span class="grvsc-line"><span class="grvsc-source"># end-insert</span></span>
<span class="grvsc-line"><span class="grvsc-source">});</span></span></code></pre>
<p>Nachdem du den Tests mit <code class="language-text">npm test</code> aufgerufen hast, ist in deinem Projekt ein neuer Ordner namens <em>src/<strong>snapshots</strong></em> vorhanden. Navigiere in diesen und überprüfen die Datei, die gespeichert wurde. Ähnlich wie bei der <code class="language-text">debug</code>-Funktion ist es eine Momentaufnahme in HTML. In unserem Fall wurde SearchForm aufgenommen. Navigiere jetzt zu <em>src/App.js</em> und ändere etwas. Entferne beispielsweise in SearchForm den fett gedruckten Text:</p>
<pre class="grvsc-container default-dark" data-language="js" data-index="37"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">const</span><span class="mtk1"> </span><span class="mtk11">SearchForm</span><span class="mtk1"> = ({</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk12">searchTerm</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk12">onSearchInput</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk12">onSearchSubmit</span><span class="mtk1">,</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}) </span><span class="mtk4">=&gt;</span><span class="mtk1"> (</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk17">&lt;</span><span class="mtk4">form</span><span class="mtk1"> </span><span class="mtk12">onSubmit</span><span class="mtk1">=</span><span class="mtk4">{</span><span class="mtk12">onSearchSubmit</span><span class="mtk4">}</span><span class="mtk17">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk17">&lt;</span><span class="mtk10">InputWithLabel</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk12">id</span><span class="mtk1">=</span><span class="mtk8">&quot;search&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk12">value</span><span class="mtk1">=</span><span class="mtk4">{</span><span class="mtk12">searchTerm</span><span class="mtk4">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk12">isFocused</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk12">onInputChange</span><span class="mtk1">=</span><span class="mtk4">{</span><span class="mtk12">onSearchInput</span><span class="mtk4">}</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk17">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1"># start-insert</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      Search:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1"># end-insert</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk17">&lt;/</span><span class="mtk10">InputWithLabel</span><span class="mtk17">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk17">&lt;</span><span class="mtk4">button</span><span class="mtk1"> </span><span class="mtk12">type</span><span class="mtk1">=</span><span class="mtk8">&quot;submit&quot;</span><span class="mtk1"> </span><span class="mtk12">disabled</span><span class="mtk1">=</span><span class="mtk4">{</span><span class="mtk1">!</span><span class="mtk12">searchTerm</span><span class="mtk4">}</span><span class="mtk17">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      Submit</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk17">&lt;/</span><span class="mtk4">button</span><span class="mtk17">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk17">&lt;/</span><span class="mtk4">form</span><span class="mtk17">&gt;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">);</span></span></span></code></pre>
<p>Nachdem du den Tests erneut aufgerufen hast, siehst du in der Befehlszeile unter anderem Folgendes:</p>
<p>{title="Command Line",lang="text"}</p>
<pre class="grvsc-container default-dark" data-language="" data-index="38"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source">- Snapshot</span></span>
<span class="grvsc-line"><span class="grvsc-source">+ Received</span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source">    &lt;label</span></span>
<span class="grvsc-line"><span class="grvsc-source">      for=&quot;search&quot;</span></span>
<span class="grvsc-line"><span class="grvsc-source">    &gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">-     &lt;strong&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">-       Search:</span></span>
<span class="grvsc-line"><span class="grvsc-source">-     &lt;/strong&gt;</span></span>
<span class="grvsc-line"><span class="grvsc-source">+     Search:</span></span>
<span class="grvsc-line"><span class="grvsc-source">    &lt;/label&gt;</span></span></code></pre>
<p>Dies ist der typische Fall für einen Schnappschuss-Test. Wann immer sich die HTML-Struktur einer Komponente ändert, wirst du in darüber informiert. Entweder du akzeptierst den Hinweis: Korrigiere in diesem Fall die Datei <em>src/App.js</em>. Wenn du den Korrekturhinweis nicht annimmst, drücke "u" eine neue korrigierter Momentaufnahme wird erstellt. Probiere es selbst aus und sieh, wie die Datei im Ordner <em>src/<strong>snapshots</strong></em> die Änderungen anwendet.</p>
<p>Jest speichert Momentaufnahmen in einem Ordner, damit der Unterschied zu zukünftigen Tests überprüft wird. Benutzer geben diese für die Versionskontrolle (z. B. Git) teamübergreifend frei. Wenn du zum ersten Mal einen Schnappschuss-Test aufrufst, wird die Datei mit der Momentaufnahme im Ordner deines Projekts erstellt. Wenn der Test erneut aufgerufen wird, wird erwartet, dass die Momentaufnahme mit der aus dem letzten Testlauf übereinstimmt. So stellen wir sicher, dass das DOM gleich bleibt --- beziehungsweise unerwartete Änderungen überprüft werden.</p>
<p>Schnappschuss-Tests eignen sich, um Tests in React schnell zum Laufen zu bringen. Erstelle aber nicht für jede Komponente Momentaufnahmen. Allgemein wird empfohlen, Schnappschuss-Tests für Elemente zu verwenden, die nicht häufig aktualisiert werden und nicht zu komplex sind.</p>
<h4 id="übungen-4" style="position:relative;"><a href="#%C3%BCbungen-4" aria-label="übungen 4 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Übungen:</h4>
<ul>
<li>Begutachte den <a href="https://codesandbox.io/s/github/the-road-to-learn-react/hacker-stories/tree/hs/react-snapshot">Quellcode dieses Abschnitts</a>.
<ul>
<li>Reflektiere die <a href="https://github.com/the-road-to-learn-react/hacker-stories/compare/hs/react-testing-integration...hs/react-snapshot?expand=1">Änderungen gegenüber dem Stand der Anwendung am Ende des vorherigen Kapitels</a>.</li>
</ul>
</li>
<li>Ergänze für jede Komponente einen Snapshot-Test und überprüfe den Inhalt des Ordners <em><strong>snapshots</strong></em>.</li>
</ul>
<img src="https://vg07.met.vgwort.de/na/f4321aa66ddb4aae841a6c8c9e26a072" width="1" height="1" alt="">
<style class="grvsc-styles">
  .grvsc-container {
    overflow: auto;
    position: relative;
    -webkit-overflow-scrolling: touch;
    padding-top: 1rem;
    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));
    padding-bottom: 1rem;
    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));
    border-radius: 8px;
    border-radius: var(--grvsc-border-radius, 8px);
    font-feature-settings: normal;
    line-height: 1.4;
  }
  
  .grvsc-code {
    display: table;
  }
  
  .grvsc-line {
    display: table-row;
    box-sizing: border-box;
    width: 100%;
    position: relative;
  }
  
  .grvsc-line > * {
    position: relative;
  }
  
  .grvsc-gutter-pad {
    display: table-cell;
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  .grvsc-gutter {
    display: table-cell;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter::before {
    content: attr(data-content);
  }
  
  .grvsc-source {
    display: table-cell;
    padding-left: 1.5rem;
    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));
    padding-right: 1.5rem;
    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));
  }
  
  .grvsc-source:empty::after {
    content: ' ';
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter + .grvsc-source {
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  /* Line transformer styles */
  
  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {
    content: ' ';
    position: absolute;
    width: 100%;
  }
  
  .grvsc-line-diff-add::before {
    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));
  }
  
  .grvsc-line-diff-del::before {
    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));
  }
  
  .grvsc-line-number {
    padding: 0 2px;
    text-align: right;
    opacity: 0.7;
  }
  
  .default-dark {
    background-color: #1E1E1E;
    color: #D4D4D4;
  }
  .default-dark .mtk1 { color: #D4D4D4; }
  .default-dark .mtk15 { color: #C586C0; }
  .default-dark .mtk12 { color: #9CDCFE; }
  .default-dark .mtk4 { color: #569CD6; }
  .default-dark .mtk11 { color: #DCDCAA; }
  .default-dark .mtk17 { color: #808080; }
  .default-dark .mtk10 { color: #4EC9B0; }
  .default-dark .mtk8 { color: #CE9178; }
  .default-dark .grvsc-line-highlighted::before {
    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));
    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));
  }
</style></div></article><section id="webmentions" class="comments webmentions__list container"><h3>Webmentions</h3><br/></section></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/react-lernen-react-maintenance-testen/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-87f5ae838a3e11ab908d.js"],"app":["/app-41810ff886939bb07aad.js"],"component---src-pages-404-js":["/component---src-pages-404-js-5f1261b30b7ee352090a.js"],"component---src-pages-blog-js":["/component---src-pages-blog-js-6eb3d12ab743f1423bf7.js"],"component---src-pages-books-js":["/component---src-pages-books-js-ffee86f2ac01d1e02a72.js"],"component---src-pages-index-js":["/component---src-pages-index-js-9ece8ce0ac889326e585.js"],"component---src-pages-projects-js":["/component---src-pages-projects-js-8ef4eae5ed3a363bdc9d.js"],"component---src-templates-category-js":["/component---src-templates-category-js-90e58ac4c560b9dbf839.js"],"component---src-templates-post-js":["/component---src-templates-post-js-4c17552cdba24d661280.js"],"component---src-templates-tag-js":["/component---src-templates-tag-js-81da552be0fccf239da3.js"]};/*]]>*/</script><script src="/polyfill-87f5ae838a3e11ab908d.js" nomodule=""></script><script src="/component---src-templates-post-js-4c17552cdba24d661280.js" async=""></script><script src="/b84efa9b784e27572a845759437622c93533bed1-af3eca6a1f9625807cd6.js" async=""></script><script src="/commons-dead6f2aafd4c57f7eb7.js" async=""></script><script src="/app-41810ff886939bb07aad.js" async=""></script><script src="/framework-a8bc927eb7481ca28d49.js" async=""></script><script src="/webpack-runtime-39397f3c9065deef2574.js" async=""></script></body></html>