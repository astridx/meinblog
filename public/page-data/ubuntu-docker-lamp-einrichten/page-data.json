{"componentChunkName":"component---src-templates-post-js","path":"/ubuntu-docker-lamp-einrichten/","result":{"data":{"markdownRemark":{"html":"<p>Zur Erinnerung: <em>Docker</em> erleichtert die Verwaltung von Software in Containern. <em>Docker Compose</em> ist ein Tool, welches die Arbeit mit mehreren Containern vereinfacht.</p>\n<p>Hier geht es um <em>docker-lamp</em>. Eine Software die vorgefertigte Images, Container und Skripte bietet, die dich bei der Entwicklung auf einem Webserver unterstützen. In diesem Teil richte ich die Umgebung ein.</p>\n<h2>Voraussetzungen</h2>\n<p>Neben <a href=\"/ubuntu-docker-einrichten-docker-lamp\">Docker</a> ist <a href=\"/ubuntu-docker-compose-einrichten-docker-lamp\">Docker Compose</a> notwendig. Um die Skripte automatisch auszuführen, solltest du unter Linux arbeiten. Wenn du diesem <a href=\"mein-ubuntu-rechner-mit-docker-lamp-themen/\">Set</a> bisher gefolgt bist, passt alles.</p>\n<h3>Optional: Entfernen von Docker-Images, -Containern</h3>\n<p>Bei der Arbeit mit Docker passiert es leicht, dass viele nicht verwendete Images, Container und Datenvolumen gesammelt werden, die Ausgabe verkomplizieren und unnötigen Festplattenspeicher verbrauchen.</p>\n<p>Aus diesem Grund räume ich meine bisher zu Übungszwechen erstellten Dockerelemente auf. Ich nenne das <a href=\"https://de.wikipedia.org/wiki/Tabula_rasa\">Tabula rasa</a>!</p>\n<h4>Images</h4>\n<h5>Auflisten</h5>\n<p>Ich überprüfe die Images in meinem System mit <code class=\"language-text\">docker images</code>. Durch Hinzufügen des Flag <code class=\"language-text\">-a</code> werden alle angezeigt.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">docker images -a</span></span></span></code></pre>\n<h5>Entfernen</h5>\n<p>Wenn ich sicher bin, ergänze ich das Flag <code class=\"language-text\">-q</code>, um die IDs an den Befehle Docker <code class=\"language-text\">rmi</code> zu übergeben:</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">docker rmi </span><span class=\"mtk11\">$(docker images -a -q)</span></span></span></code></pre>\n<h4>Container</h4>\n<h5>Auflisten</h5>\n<p>Ich überprüfe die Container in meinem System mit <code class=\"language-text\">docker ps</code>. Durch Hinzufügen des Flag <code class=\"language-text\">-a</code> werden alle angezeigt.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">docker ps -a</span></span></span></code></pre>\n<h5>Stoppen und Entfernen</h5>\n<p>Wenn ich sicher bin, ergänze ich das Flag <code class=\"language-text\">-q</code>, um die IDs an die Befehle <code class=\"language-text\">docker stop</code> und <code class=\"language-text\">docker rm</code> zu übergeben:</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">docker stop </span><span class=\"mtk11\">$(docker ps -a -q)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">docker rm </span><span class=\"mtk11\">$(docker ps -a -q)</span></span></span></code></pre>\n<blockquote>\n<p>digitalocean.com behandelt in einem <a href=\"https://www.digitalocean.com/community/tutorials/how-to-remove-docker-images-containers-and-volumes-de\">Artikel</a> alle gängigen Befehle, die zum Entfernen von Images, Containern und Volumen bei Docker verwendet werden.</p>\n</blockquote>\n<h2>Installieren von docker-lamp</h2>\n<h3>Eine frische Umgebung</h3>\n<p>Ich verfüge über eine frische Dockerinstallation. Auf meinem Rechner ist kein Image und somit kein Container. Die folgenden Befehle zeigen beide eine leere Tabelle:</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">docker images -a</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">docker ps -a</span></span></span></code></pre>\n<h3>docker-lamp Repository von Github klonen</h3>\n<p>Nun klone ich das <code class=\"language-text\">docker-lamp</code> Github Repository in ein Verzeichnis nach Wahl.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">git clone https://github.com/degobbis/docker-lamp.git</span></span></span></code></pre>\n<p>Als nächstes wechsele ich in den Ordner <code class=\"language-text\">docker-lamp</code>.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">cd</span><span class=\"mtk1\"> docker-lamp</span></span></span></code></pre>\n<h3>Umgebungsvariablen</h3>\n<p>In <code class=\"language-text\">docker-lamp</code> kopiere ich als erstes die versteckte Datei <code class=\"language-text\">.env-example</code> nach <code class=\"language-text\">.env</code>.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">cp .env-example .env</span></span></span></code></pre>\n<p>Dann setze in der Datei den Parameter <code class=\"language-text\">REMOTE_HOST_IP=</code> mit der IP des eigenen Rechners, zum Beispiel <code class=\"language-text\">REMOTE_HOST_IP=192.168.178.138</code>.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">nano .env</span></span></span></code></pre>\n<p>Das Ende der Datei sieht dann beispielsweise so aus, wie im folgenden Block.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"># To use PHP xDebug set your host IP here (192.168.0.100)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">#</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">REMOTE_HOST_IP=192.168.209.138</span></span></code></pre>\n<p>Ich nutze /srv/www als Stammverzeichnis für den Webserver und ändere deshalb die Variable WWW_BASEDIR wie folgt ab.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"># Set Your projekt folder for websites</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">#</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">WWW_BASEDIR=/srv/www</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span></code></pre>\n<blockquote>\n<p>Im Verzeichnis <code class=\"language-text\">docker-lamp</code> befindet sich die unsichtbare Datei <code class=\"language-text\">.env-example</code>, welche nach <code class=\"language-text\">.env</code> kopiert wird. Wofür ist die Datei <code class=\"language-text\">.env</code> wichtig? Diese beinhaltet wesentliche Einstellungen. Konfigurationsdaten müssen besonders geschützt werden, wenn sie sich in einem vom Webserver erreichbaren Verzeichnis befinden. Deshalb ist der Zugriff auf <code class=\"language-text\">.env</code> zu unterbinden und diese sind versteckt.</p>\n</blockquote>\n<h3>Die make Commandos</h3>\n<p><code class=\"language-text\">docker-lamp</code> verwendet das Hilfsprogramm <code class=\"language-text\">make</code>, welches mithilfe des nachfolgenden Befehls installiert wird.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">sudo apt install make</span></span></code></pre>\n<p>Im <code class=\"language-text\">docker-lamp</code>-Verzeichnis führe ich nach erfolgreicher Installation von <code class=\"language-text\">make</code> den Befehl <code class=\"language-text\">make</code> aus, der alle möglichen Kommandos anzeigt.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">make</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Usage:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  make </span><span class=\"mtk8\">&lt;</span><span class=\"mtk1\">target</span><span class=\"mtk8\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  server-up                    Start all docker containers, creating new certificates before.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  server-down                  Stops all docker containers and delete all volumes, saving all databases before.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  db-backup                    Saving all databases.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  update-images                Update all images from docker-compose.yml to the latest build.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  delete-obsolete-images       Delete all obsolete images.</span></span></span></code></pre>\n<p>Noch immer im <code class=\"language-text\">docker-lamp</code>-Ordner rufe ich den Befehl <code class=\"language-text\">make server-up</code> auf.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ make server-up</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">./.env included</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">2021/02/04 20:13:24 open localdomains/key.pem: file exists</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Building with native build. Learn about native build </span><span class=\"mtk8\">in</span><span class=\"mtk1\"> Compose here: https://docs.docker.com/go/compose-native-build/</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Recreating docker-lamp_bind ... </span><span class=\"mtk8\">done</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Recreating docker-lamp_mailhog ... </span><span class=\"mtk8\">done</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Recreating docker-lamp_mysql   ... </span><span class=\"mtk8\">done</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Recreating docker-lamp_php74      ... </span><span class=\"mtk8\">done</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Recreating docker-lamp_php56      ... </span><span class=\"mtk8\">done</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Recreating docker-lamp_php80      ... </span><span class=\"mtk8\">done</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Recreating docker-lamp_php73      ... </span><span class=\"mtk8\">done</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Recreating docker-lamp_phpmyadmin ... </span><span class=\"mtk8\">done</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Recreating docker-lamp_httpd      ... </span><span class=\"mtk8\">done</span></span></span></code></pre>\n<p>Der Befehl arbeitet einige Minuten. Im Anschluss werden mir eine Reihe von Images angezeigt, wenn ich <code class=\"language-text\">docker images -a</code> eingebe.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ docker images -a</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">REPOSITORY                   TAG          IMAGE ID       CREATED        SIZE</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">phpmyadmin/phpmyadmin        fpm-alpine   9e4f315e888d   2 days ago     142MB</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">degobbis/php74-fpm-alpine    latest       d026bc35510a   9 days ago     181MB</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">degobbis/php73-fpm-alpine    latest       6cc4ac518120   9 days ago     168MB</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">degobbis/php80-fpm-alpine    latest       f6fe30e9f914   9 days ago     183MB</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">degobbis/minica              latest       2fcbfc904eff   5 weeks ago    13.2MB</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">degobbis/mariadb105-alpine   latest       be1c0b068e2e   2 months ago   238MB</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">degobbis/apache24-alpine     latest       f3469ca1846a   2 months ago   58.8MB</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">degobbis/php56-fpm-alpine    latest       9609694f3fe4   2 months ago   131MB</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">mailhog/mailhog              latest       4de68494cd0d   5 months ago   392MB</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">cytopia/bind                 0.15         ff37cf218d55   2 years ago    142MB</span></span></span></code></pre>\n<p><code class=\"language-text\">docker ps -a</code> listet folgende Container auf.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ docker ps -a</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">CONTAINER ID   IMAGE                               COMMAND                  CREATED         STATUS         PORTS                                                                                                                                                                                                                                                                     NAMES</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">0228f9effde2   degobbis/apache24-alpine:latest     </span><span class=\"mtk11\">&quot;/httpd-php-entrypoi…&quot;</span><span class=\"mtk1\">   2 minutes ago   Up 2 minutes   0.0.0.0:8000-</span><span class=\"mtk8\">&gt;</span><span class=\"mtk1\">8000/tcp, 0.0.0.0:8056-</span><span class=\"mtk8\">&gt;</span><span class=\"mtk1\">8056/tcp, 0.0.0.0:8073-8074-</span><span class=\"mtk8\">&gt;</span><span class=\"mtk1\">8073-8074/tcp, 0.0.0.0:8080-</span><span class=\"mtk8\">&gt;</span><span class=\"mtk1\">8080/tcp, 0.0.0.0:8400-</span><span class=\"mtk8\">&gt;</span><span class=\"mtk1\">8400/tcp, 0.0.0.0:8456-</span><span class=\"mtk8\">&gt;</span><span class=\"mtk1\">8456/tcp, 0.0.0.0:8473-8474-</span><span class=\"mtk8\">&gt;</span><span class=\"mtk1\">8473-8474/tcp, 80/tcp, 0.0.0.0:8480-</span><span class=\"mtk8\">&gt;</span><span class=\"mtk1\">8480/tcp, 0.0.0.0:80-</span><span class=\"mtk8\">&gt;</span><span class=\"mtk1\">8074/tcp, 0.0.0.0:443-</span><span class=\"mtk8\">&gt;</span><span class=\"mtk1\">8474/tcp   docker-lamp_httpd</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">9fd0d7d257df   degobbis/php74-fpm-alpine:latest    </span><span class=\"mtk11\">&quot;/httpd-php-entrypoi…&quot;</span><span class=\"mtk1\">   2 minutes ago   Up 2 minutes   9000/tcp                                                                                                                                                                                                                                                                  docker-lamp_php74</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">b5435404bc73   phpmyadmin/phpmyadmin:fpm-alpine    </span><span class=\"mtk11\">&quot;/docker-entrypoint.…&quot;</span><span class=\"mtk1\">   2 minutes ago   Up 2 minutes   9000/tcp                                                                                                                                                                                                                                                                  docker-lamp_phpmyadmin</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">041bbf1a4ee4   degobbis/php73-fpm-alpine:latest    </span><span class=\"mtk11\">&quot;/httpd-php-entrypoi…&quot;</span><span class=\"mtk1\">   2 minutes ago   Up 2 minutes   9000/tcp                                                                                                                                                                                                                                                                  docker-lamp_php73</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">ce746bda0ffc   degobbis/php80-fpm-alpine:latest    </span><span class=\"mtk11\">&quot;/httpd-php-entrypoi…&quot;</span><span class=\"mtk1\">   2 minutes ago   Up 2 minutes   9000/tcp                                                                                                                                                                                                                                                                  docker-lamp_php80</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">226cd211294c   degobbis/php56-fpm-alpine:latest    </span><span class=\"mtk11\">&quot;/httpd-php-entrypoi…&quot;</span><span class=\"mtk1\">   2 minutes ago   Up 2 minutes   9000/tcp                                                                                                                                                                                                                                                                  docker-lamp_php56</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">c473eb668908   degobbis/mariadb105-alpine:latest   </span><span class=\"mtk11\">&quot;/docker-entrypoint …&quot;</span><span class=\"mtk1\">   2 minutes ago   Up 2 minutes   0.0.0.0:3306-</span><span class=\"mtk8\">&gt;</span><span class=\"mtk1\">3306/tcp                                                                                                                                                                                                                                                    docker-lamp_mysql</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">9beb444df753   mailhog/mailhog:latest              </span><span class=\"mtk11\">&quot;MailHog&quot;</span><span class=\"mtk1\">                3 minutes ago   Up 3 minutes   0.0.0.0:1025-</span><span class=\"mtk8\">&gt;</span><span class=\"mtk1\">1025/tcp, 0.0.0.0:8025-</span><span class=\"mtk8\">&gt;</span><span class=\"mtk1\">8025/tcp                                                                                                                                                                                                                            docker-lamp_mailhog</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">96527284e9a0   cytopia/bind:0.15                   </span><span class=\"mtk11\">&quot;/docker-entrypoint.…&quot;</span><span class=\"mtk1\">   3 minutes ago   Up 3 minutes   0.0.0.0:53-</span><span class=\"mtk8\">&gt;</span><span class=\"mtk1\">53/tcp, 0.0.0.0:53-</span><span class=\"mtk8\">&gt;</span><span class=\"mtk1\">53/udp                                                                                                                                                                                                                                    docker-lamp_bind</span></span></span></code></pre>\n<p>Wenn du nicht sofort mit dem nächsten Teil weiter machst, stoppe den Server über <code class=\"language-text\">make server-down</code>.</p>\n<h3>Eigene Projekte in den Container mappen</h3>\n<p>Um des Verzeichnis mit den eigenen Webprojekten im Container zur Verfügung zu haben, ist es erforderlich, die Datei <code class=\"language-text\">docker-compose.yml</code> zu überschreiben. Dazu erstellen wir eine Kopie unter dem Namen <code class=\"language-text\">docker-compose-override.yml</code>. Im Verzeichnis <code class=\"language-text\">docker-lamp</code> geben wir folgenden Befehl ein.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"16\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">cp docker-compose.yml docker-compose-override.yml</span></span></code></pre>\n<blockquote>\n<p>Wir nutzen die Datei <code class=\"language-text\">docker-compose-override.yml</code> und ändern nicht direkt die Datei <code class=\"language-text\">docker-compose-override.yml</code>, damit beim nächsten <code class=\"language-text\">docker-lamp</code>-Update die <code class=\"language-text\">docker-compose</code> Konfiguration nicht überschrieben wird.</p>\n</blockquote>\n<p>Nun öffnen wir die Datei <code class=\"language-text\">docker-compose-override.yml</code> zum editieren.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"17\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">nano docker-compose.yml docker-compose-override.yml</span></span></code></pre>\n<p>Angenommen Projekte im Verzeichnis <code class=\"language-text\">/home/deinBenutzer/git/joomla-development</code> sollen in jedem Containern der das Stammverzeichnis eines Webservers enthält, ebenfalls als <code class=\"language-text\">/home/deinBenutzer/git/joomla-development</code> gemappt werden.</p>\n<p>Suchen wir als erstes nach dem folgenden Eintrag:</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"18\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">      - ${WWW_BASEDIR:-./data/www}:/srv/www:rw</span></span></code></pre>\n<p>Jedesmal, wenn wir den obigen Eintrag finden, fügen wir die nachfolgende Zeile hinter diesem ein.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"19\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">      - /home/deinBenutzer/git/joomla-development:/home/deinBenutzer/git/joomla-development:rw</span></span></code></pre>\n<p>Für den httpd Container würde der Eintrag beispielsweise wie folgt aussehen.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"20\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  httpd:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    image: degobbis/apache24-alpine:latest</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    container_name: ${COMPOSE_PROJECT_NAME}_httpd</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    hostname: httpd</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    links:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - bind</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - php56</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - php73</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - php74</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - php80</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - mailhog</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    volumes:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - ./data/ca:/usr/local/apache2/ca:rw</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - ./.config/httpd/apache24/conf.d:/usr/local/apache2/conf.d:rw</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - ./.config/httpd/apache24/vhosts:/usr/local/apache2/vhosts:rw</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - ./data/apache24/my-domains.conf:/usr/local/apache2/vhosts/20-extra-domains.conf:rw</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - ./data/phpinfo:/srv/phpinfo:rw</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - ${WWW_BASEDIR:-./data/www}:/srv/www:rw</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - /home/deinBenutzer/git/joomla-development:/home/deinBenutzer/git/joomla-development:rw</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - pma:/srv/pma</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - phpsocket:/run/php</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    ports:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - &quot;80:${MAP_POT_80:-8074}&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - &quot;8000:8000&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - &quot;8056:8056&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - &quot;8073:8073&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - &quot;8074:8074&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - &quot;8080:8080&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - &quot;443:${MAP_POT_443:-8474}&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - &quot;8400:8400&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - &quot;8456:8456&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - &quot;8473:8473&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - &quot;8474:8474&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - &quot;8480:8480&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    environment:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      TZ: ${MY_TZ:-UTC}</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      LC_ALL: ${MY_LOCALES:-en_GB.UTF-8}</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      APP_USER_ID: ${APP_USER_ID:-1000}</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      APP_GROUP_ID: ${APP_GROUP_ID:-1000}</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    dns:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      - 172.16.238.100</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    networks:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      net:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        ipv4_address: 172.16.238.10</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span></code></pre>\n<p>Insgesamt wird der Eintrag 5 Mal eingefügt. Die Container\n<code class=\"language-text\">httpd</code>, <code class=\"language-text\">php56</code>, <code class=\"language-text\">phpo73</code>, <code class=\"language-text\">php74</code> und <code class=\"language-text\">php80</code> sind betroffen.</p>\n<p>Jetzt den Server neu starten, damit die Änderungen übernommen werden.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"21\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">make server-up</span></span></code></pre>\n<h3>Zertifikat</h3>\n<h4>Minica</h4>\n<p>Wir benötigen ein selbsterstelltes Zertifikat auf unserem lokalen Webserver, um verschlüsselte Websites zu verwenden. <code class=\"language-text\">docker-lamp</code> nutzt für diesen Zweck <a href=\"https://github.com/jsha/minica\">Minica</a>. Dieses Tool erstellt beim ersten Aufruf ein Root-Zertifikat, auf welchem alle daraufhin erzeugten Zertfikate basieren.</p>\n<h5>Angabe im <code class=\"language-text\">Makefile</code></h5>\n<p>Standardmäßig werden die im Makefile in der Variablen <code class=\"language-text\">MINICA_DEFAULT_DOMAINS</code> festgelegten Domains zertifiziert.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"22\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">MINICA_DEFAULT_DOMAINS:=localdomains,localhost,joomla.local,joomla.test,*.joomla.local,*.joomla.test,wp.local,wp.test,*.wp.local,*.wp.test,wpms.local,wpms.test,*.wpms.local,*.wpms.test</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span></code></pre>\n<h5>Angaben in der Datei <code class=\"language-text\">.env</code></h5>\n<p>Um zusätzliche Domains zu zertifizieren, git es die Variablen <code class=\"language-text\">.env</code> und <code class=\"language-text\">SSL_LOCALDOMAINS</code> in der <code class=\"language-text\">.env</code>.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"23\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">SSL_DOMAINS=</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">SSL_LOCALDOMAINS=</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span></code></pre>\n<h5>Zusätzliche Domain hinzufügen</h5>\n<p>todo\nEine eigene Domains fügt man im <code class=\"language-text\">docker-lamp</code> verzeichnis mittels nachfolgender Befehle hinzu.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"24\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">docker-compose down</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">nano .env</span></span></code></pre>\n<p>Hier dann folgende Einträge erweitert:</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"25\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">TLD_SUFFIX=local=127.0.0.1,test=127.0.0.1,xxx.local=127.0.0.1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">SSL_LOCALDOMAINS=xxx.local,*.xxx.local</span></span></code></pre>\n<p>Dann den Ordner <code class=\"language-text\">/data/ca/localdomains</code> löschen.\nEinen entsprechenden Ordner in <code class=\"language-text\">/data/www/xxx</code> erstellen.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"26\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">make server-up</span></span></code></pre>\n<h4>Ansicht im Browser vor dem Importieren des Zertifikates</h4>\n<p>Öffne als nächstes einen Webbrowser und öffne die URL <code class=\"language-text\">https://joomla.test/</code> oder <code class=\"language-text\">https://joomla.local/</code>. Du siehst einen Zertifikatsfehler. Den Fehler beheben wir als nächstes.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dbb854adabaabf882770158c7017795f/37523/dockerlamp_zert.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.78481012658227%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACS0lEQVQ4y31SSW7bQBDUX/KA5Dm+2JYTwEjyHiPOyUBO+YizGYEDaLH2WNRGiatIaiGHkirVQ8oQBSEECj3T06yuXkqjsYfxxMNw5BIO4gS4u/uKs7My3l59xFX5QwHl8ntcnF9rlC/z88U1zmkvL96htI7+wLV+wHcesAx+I3Du4cx+wp5+wyZ+QrquF6DWNczdB8Z8xyJ4hGXew2KsZf3iuYKSCr8gDW+ggk8ZQsEtfbcH90PwLcre05fzZ2yiG2ztVyjFKXSZx1gnp/3/e9vab0jIQ5JESFUMpdY54vye2f15jzSlTdaI4xWSeEnEhE/C1yglClhEc7iuB9+fYz4P4Lk+bNuB5/lwHFdD3uTuErOZhShaUIgiaUJ1GxJG2DokVCzZ92wYxgCmOWVzbf2zkOwJJZlgf5dkYRjlhHGRUBQuF0Ee7OmMux37sd1pe4y9X2yabtgCReIjhR4V9vsGhsMR+lRqFGDwrY/n5762A/okVuxwNKYI7i4nqwmlh2oDWLMJKpUq2q02arU6qlVBTZOMmGQwGMIgBgeQZOOxqXsZJ+lByVQ49x1MJqbujTTcnM60lbLkkxJxonyBYonFoeQKm80Wer2/6LQ7aFJpt9vTAxBiKctismwgNn32y3BWq9XpHrY7XR20WCwRBiECQlZIrxMHJkOTu+9zdbhW8i6+5fKYkApty9QKW1QnfazXn/S90Wiiw0Rt+kWxqG/Q38njRISsmFJbDuaIMPu5g1YrCxaiFn+WvRQ18uN+ufWCU7koTpLiYv8D0VFJp4202GMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Zertifikatsfehler\"\n        title=\"Zertifikatsfehler\"\n        src=\"/static/dbb854adabaabf882770158c7017795f/f058b/dockerlamp_zert.png\"\n        srcset=\"/static/dbb854adabaabf882770158c7017795f/c26ae/dockerlamp_zert.png 158w,\n/static/dbb854adabaabf882770158c7017795f/6bdcf/dockerlamp_zert.png 315w,\n/static/dbb854adabaabf882770158c7017795f/f058b/dockerlamp_zert.png 630w,\n/static/dbb854adabaabf882770158c7017795f/37523/dockerlamp_zert.png 720w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<blockquote>\n<p>Hinter <code class=\"language-text\">https://joomla.test/</code> oder <code class=\"language-text\">https://joomla.local/</code> befindet sich das gleiche Ziel. Warum wurden zwei Domains zur Verfügung gestellt? Ganz einfach. So kannst du Debuggen und gleichzeitg Browsen.</p>\n</blockquote>\n<h4>Zertifikat importieren</h4>\n<p>In Mozilla Firefox importierst du das Zertifikat wie folgt. Öffne die\nEinstellungen (Preferences). Klicke dann in der linken Seiteleiste auf Datenschutz &#x26; Sicherheit (Privacy and Security). Im rechten Bereich findest du nun weiter unten den Abschnitt Sicherheit (Security). Klicke hier auf die Schaltfläche Zertifikate anzeigen (View Certificates). Im Tabulator Zertifizierungsstellen (Authorities) importierst du die Datei <code class=\"language-text\">/docker-lamp/data/ca/minica-root-ca-key.pem</code>. Achte darauf, dass du <code class=\"language-text\">Webseite vertrauen</code> aktivierst.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/987f74f8a47eafb26365df4d757135af/9040f/dockerlamp_zertbrowser.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACEElEQVQoz22SS28SURTH+Wbu/QouTAyoCW3pPJknNVZooQs3JuqirVHCK9Jv0IULU1+ASxdtLIXOMDADyEyLaev8PXcIDdVmcnLP3Mfv/u//nJgkydB0HbphIJ1WaTSRMTNQNR2iKEEQRPC8ALZPltPRnCjKEB8rSMsKDNqv60YULI9xPA8tocFYNpES2WERHMcjl9tAqVRC8V0RxVIF29u72NnZRaVWRflNEbUHL/HqxetIDAPNI8bfVZG+Y0C7b0JQBHCrHBKJhwQr4/LyCr4fwA/OMB5P4E8CTK8u4B+6GG010dz/AkUnMfoCUOIUaDJJVmeyM5m16Hn1+h4GAw+npzacXh89CsuyYdsOPHeMYT/A18/foKjqTYVmhhKT+aAjtZIimIRkMolqrUaqxjhuH+PkpINuuxONLIIgQEhfq/U98v0GcNFQQRCwQtB4PIEyPdnzPLSPfsKyLfTPR+j1HdiWhel0ivBPiGazCUW5BTivFKuoqmpRVevv93B+8RuDH104zz/Ce9vC+LCH0eQXAvI1DEM0GrcA5wkDsuqyWFpaRqVcpaedkV8e3EYHzocjDLsuhmSDS9563hAHB5/+BzJFGvXcDMhhlarM+s2kXmStk83msBZ/CuPeE2w8yqOQLSC/VcDmZh7r68+u7boGyrIcNSuDLi6wf4UuYxdKtM6TciWlQpVnc3Mh/zb2X3aNL0917NxeAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Zertifikat importieren\"\n        title=\"Zertifikat importieren\"\n        src=\"/static/987f74f8a47eafb26365df4d757135af/f058b/dockerlamp_zertbrowser.png\"\n        srcset=\"/static/987f74f8a47eafb26365df4d757135af/c26ae/dockerlamp_zertbrowser.png 158w,\n/static/987f74f8a47eafb26365df4d757135af/6bdcf/dockerlamp_zertbrowser.png 315w,\n/static/987f74f8a47eafb26365df4d757135af/f058b/dockerlamp_zertbrowser.png 630w,\n/static/987f74f8a47eafb26365df4d757135af/40601/dockerlamp_zertbrowser.png 945w,\n/static/987f74f8a47eafb26365df4d757135af/78612/dockerlamp_zertbrowser.png 1260w,\n/static/987f74f8a47eafb26365df4d757135af/9040f/dockerlamp_zertbrowser.png 1613w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<blockquote>\n<p>Das Zertifikat ist für die <code class=\"language-text\">https://joomla.test/</code> oder <code class=\"language-text\">https://joomla.local/</code> erstellt. Unter <code class=\"language-text\">https://joomla.test/</code> oder <code class=\"language-text\">https://joomla.local/</code> gibt es weiterhin den Fehler.</p>\n</blockquote>\n<h2>Mögliche Fehler</h2>\n<p>Je nach Konfiguration kommt es unter Ubuntu 20.04 beim Aufruf von <code class=\"language-text\">make server-up</code> zu einem Fehler</p>\n<h3>permission denied (but minica-root-ca.pem exists)</h3>\n<p>Falls die Ausgabe von <code class=\"language-text\">make server-up</code> mit dem nachfolgenden Text startet, stimmen Berechtigungen nicht.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"27\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">./.env included</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">2021/02/04 19:57:06 open minica-root-ca-key.pem: permission denied (but minica-root-ca.pem exists)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">...</span></span></span></code></pre>\n<h4>Abhilfe schafft schafft die folgende Vorgehensweise</h4>\n<p>Als erstes ins Unterverzeichnis data wechseln.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"28\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">/docker-lamp$ </span><span class=\"mtk7\">cd</span><span class=\"mtk1\"> data</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">/docker-lamp/data$</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">...</span></span></span></code></pre>\n<p>In diesem Verzeichnis alle Rechte prüfen. Alle Inhalte sollten dem aktuellen Benutzer und dessen Gruppe gehören</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"29\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">/docker-lamp/data$ ll</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">insgesamt 28</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">drwxrwxr-x 7 deinBenutzer deinBenutzer 4096 Feb  4 17:33 ./</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">drwxrwxr-x 5 deinBenutzer deinBenutzer 4096 Feb  4 20:41 ../</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">drwxrwxr-x 2 deinBenutzer deinBenutzer 4096 Feb  4 17:33 apache24/</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">drwxr-xr-x 3 root   root   4096 Feb  4 17:33 ca/</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">-rw-rw-r-- 1 deinBenutzer deinBenutzer    0 Feb  4 17:16 .gitkeep</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">drwxrwxr-x 2 deinBenutzer deinBenutzer 4096 Feb  4 17:16 initDB/</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">drwxrwxr-x 2 deinBenutzer deinBenutzer 4096 Feb  4 17:16 phpinfo/</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">drwxrwxr-x 5 deinBenutzer deinBenutzer 4096 Feb  4 17:16 www/</span></span></span></code></pre>\n<p>Mit dem folgenden Befehl alle Inhalte dem aktuellen Benutzer, in dem Falle beide Mal deinBenutzer, zuweisen.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"30\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">sudo chown -R deinBenutzer:deinBenutzer </span><span class=\"mtk7\">.</span></span></span></code></pre>\n<p>Am Ende wieder zurück in das <code class=\"language-text\">docker-lamp</code>-Verzeichnis wechseln und den Befehl <code class=\"language-text\">make server-up</code> wiederholen.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"31\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">/docker-lamp/data$ </span><span class=\"mtk7\">cd</span><span class=\"mtk1\"> ..</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">/docker-lamp$ make server-up</span></span></span></code></pre>\n<h3>ERROR: for docker-lamp_bind Cannot start service bind</h3>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"32\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Creating docker-lamp_bind ... error</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">ERROR: </span><span class=\"mtk8\">for</span><span class=\"mtk1\"> </span><span class=\"mtk7\">docker-lamp_bind  Cannot start service bind: driver failed programming external connectivity on endpoint docker-lamp_bind (f4e68e24013e93124e6f55ebe821a87c5ca58cf7dca8c6388181fac9956ed26e): Error starting dockeruserland proxy: listen tcp4 0.0.0.0:53: bind: address already</span><span class=\"mtk1\"> </span><span class=\"mtk8\">in</span><span class=\"mtk1\"> use</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">ERROR: </span><span class=\"mtk8\">for</span><span class=\"mtk1\"> </span><span class=\"mtk7\">bind  Cannot start service bind: driver failed programming external connectivity on endpoint docker-lamp_bind (f4e68e24013e93124e6f55ebe821a87c5ca58cf7dca8c6388181fac9956ed26e): Error starting userland proxy: listen tcp4 0.0.0.0:53: bind: address already</span><span class=\"mtk1\"> </span><span class=\"mtk8\">in</span><span class=\"mtk1\"> use</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">ERROR: Encountered errors </span><span class=\"mtk8\">while</span><span class=\"mtk1\"> bringing up the project.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">make: </span><span class=\"mtk8\">***</span><span class=\"mtk1\"> [Makefile:51: server-up] Fehler 1</span></span></span></code></pre>\n<h4>Abhilfe schafft schafft die folgende Vorgehensweise</h4>\n<ol>\n<li><code class=\"language-text\">sudo systemctl disable systemd-resolved.service</code></li>\n</ol>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"33\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sudo systemctl disable systemd-resolved.service</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Removed /etc/systemd/system/dbus-org.freedesktop.resolve1.service.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Removed /etc/systemd/system/multi-user.target.wants/systemd-resolved.service.</span></span></span></code></pre>\n<ol start=\"2\">\n<li><code class=\"language-text\">sudo systemctl stop systemd-resolved.service</code></li>\n</ol>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"34\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sudo systemctl stop systemd-resolved.service</span></span></span></code></pre>\n<blockquote>\n<p>Was ist der Unterschied zwischen <code class=\"language-text\">systemctl stop</code> und <code class=\"language-text\">systemctl disable</code> beziehungsweise <code class=\"language-text\">systemctl start</code> und <code class=\"language-text\">systemctl enable</code>? <code class=\"language-text\">systemctl start</code> und <code class=\"language-text\">systemctl enable</code> machen verschiedene Dinge. Mit <code class=\"language-text\">enable</code> wird der angegebene Dienst an relevanten Stellen eingehängt, sodass er beim Booten automatisch gestartet wird. <code class=\"language-text\">start</code> startet das Gerät sofort. Deaktivieren und Stoppen sind das Gegenteil davon. <a href=\"http://manpages.ubuntu.com/manpages/hirsute/en/man1/systemctl.1.html\">Manpage</a></p>\n</blockquote>\n<ol start=\"3\">\n<li><code class=\"language-text\">sudo rm /etc/resolv.conf</code></li>\n</ol>\n<p>Warum ist die Datei zu löschen?</p>\n<p>Die Datei <code class=\"language-text\">/etc/resolv.conf</code> ist ein Symlink.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"35\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ ll /etc/</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">insgesamt 1128</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">lrwxrwxrwx   1 root root      39 Feb  4 00:00 resolv.conf -</span><span class=\"mtk8\">&gt;</span><span class=\"mtk1\"> ../run/systemd/resolve/stub-resolv.conf</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">...</span></span></span></code></pre>\n<p>Sie hat folgenden Inhalt:</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"bash\" data-index=\"36\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ cat /etc/resolv.conf</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">nameserver 127.0.0.53</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">options edns0</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">search localdomain</span></span></span></code></pre>\n<p>Mit dem Löschen der Datei wird gleichzeitig der Symlink gelöscht. Würden wir die Datei nicht löschen, würde der Inhalt bei jedem Neustart wiederhergestellt. Der Eintrag <code class=\"language-text\">nameserver 127.0.0.53</code> ist aber die Ursache für den Fehler, den wir lösen möchten.</p>\n<ol start=\"4\">\n<li><code class=\"language-text\">sudo nano /etc/resolv.conf</code></li>\n</ol>\n<p>Als letztes erstellen wir die Datei mit <code class=\"language-text\">sudo nano /etc/resolv.conf</code> neu. Und tragen zwei passende nameserver ein, wobei <code class=\"language-text\">nameserver 192.168.178.2</code> ein Beispiel für die Konfiguration einer Fritzbox ist, und an die eigenen Gegebenbheiten anzupassen ist.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"37\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">nameserver 127.0.0.1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">nameserver 192.168.178.2</span></span></code></pre>\n<p>Es ist wichtig, dass der Eintrag <code class=\"language-text\">nameserver 127.0.0.1</code> an erster Stelle steht. Nach einem Neustart wird der <code class=\"language-text\">docker</code>-Container verwendet. Wenn der nicht verfügbar ist, wird auf <code class=\"language-text\">nameserver 192.168.178.2</code> verwiesen. So ist sichergestellt, dass eine Internetverbindung auch bei gestopptem Container verfügbar ist.</p>\n<ol start=\"5\">\n<li><code class=\"language-text\">dns=default</code> im NetworkManager</li>\n</ol>\n<p>Als letztes bitte den NetworkManager auf <code class=\"language-text\">dns=default</code> einstellen.</p>\n<p>Dazu wird erst der Dienst gestoppt</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"38\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">sudo systemctl stop NetworkManager.service</span></span></code></pre>\n<p>Danach die Datei zum editieren öffnen.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"39\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">sudo gedit /etc/NetworkManager/NetworkManager.conf</span></span></code></pre>\n<p>Im Bereich <code class=\"language-text\">[main]</code> die Zeile <code class=\"language-text\">dns=default</code> einfügen.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"40\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">[main]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">dns=default</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">plugins=ifupdown,keyfile</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">[ifupdown]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">managed=false</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">[device]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">wifi.scan-rand-mac-address=no</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">``</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Am Ende den Dienst wieder starten.</span></span></code></pre>\n<p>sudo systemctl start NetworkManager.service</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"41\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">Voila! Das war es.</span></span></code></pre>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .solarized-light { background-color: #FDF6E3; }\n  .solarized-light .mtk1 { color: #657B83; }\n  .solarized-light .mtk11 { color: #2AA198; }\n  .solarized-light .mtk7 { color: #268BD2; }\n  .solarized-light .mtk8 { color: #859900; }\n  .solarized-light .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(0, 0, 0, 0.05));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(0, 0, 0, 0.2));\n  }\n</style>","fileAbsolutePath":"/home/astrid/git/websites/meinblog/content/posts/ubuntu_docker-lamp/5ubuntu-docker-lamp-einrichten.md","excerpt":"Zur Erinnerung: Docker erleichtert die Verwaltung von Software in Containern. Docker Compose ist ein Tool, welches die Arbeit mit mehreren…","fields":{"slug":"/ubuntu-docker-lamp-einrichten/"},"frontmatter":{"title":"docker-lamp einrichten","date":"06.02.2021","tags":["Linux","Ubuntu","docker-lamp","Joomla"],"thumbnail":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAESUlEQVQ4y11Uf0xbZRQtzAlD9gMoBcQsizFGE51mcYapEzYH9gfFMN2UqFvEBcVodFMTN4KZRraJm25G/hia6JYly5ZpomHBSDTKYuYwM5K5IX19bV87SoG2MIr8aPu+473fey9BX3Lzvj7uPdx77jmfzf94iY2fv2vzbXReYjMfOldRdFJcppiiSFEM+Z32btVT4Rr9uM3Ic5bmWhjWmw7FFPZc8+Naij7NZcdEvR0RegecRoTpPE7fRmpXgHIGCdzNNWpDOdflmJ0VLAbbSSFiHjsX6FSQUd1lut/lEDKcdt1fV5wJPbc2O+IqRpSCvh3k2nDLaqNDa0wGY6CAs4TB0gQk/FtWCt9DuUKpzhdKzTLhq7KJyXNdAoBInjmWUWoKssknyjj/iOzUbIzB7uPOTLCs6irFMAEFn75LxL94D9N9pzHz63mMfvAC/hnoAwPOXb0EZfNyOcV4fSnXNdkWLaDPHDNNCZRYKGKHWjD6/g78/4l//i4mv+5CeNcGoWy6BX5XaZa5pdoIRaHcpuYqYS501VMufI8sFWOfvCGLp3q+xMhbXkTbtuP6bhcSJw4gMxFFevw6kmc/BQESr7K7tNnlSwzYOeGlH3VFGd/DS4S2c53QF+bARDGQUrsK0aNvQm24DcPrbdCaH0R2Zkr+w5G3G4TyaL5QXY6MOWEv6ch+OVy7EsHtd+pa83oR62yVydyBrzofY7/0IDnwE5hXKoDC3468JnNmLv0A38abhd/t0DVjbM1GMpgKuMswe3VAbi9x6iMsRPyIvrMVwd0eTCfiiF84j3BrDQJP3o5o935ordWY/vEsaNMEUgxjoRJwlgCLUkEaJz0WkYAkC8wN/0GAjVB3rEPi2p+YvPI7koMXET3RCb+nHIGta4jPgxg/toe5l4Cq8Z630ZaGtC3LEXmlRo91vCisceLH26E4HQgffh1q070I7W9GpKtd8hht2yZzZv/6jSlgDvWQMXKUl9I97nVAeWxFZvgBm4i8ulkmZ5JjiOyph1LHvC2Df9vd8LnKoXrKMK9ekTmxjmawKlS3IztqLKWfAV0jbrvUk1pfIXwb88gFR2XBjd6TCD17D7RdVQg+dYfc+nzwmrGQi72kjGLBi6Kx0xOGbPbZhjbkMeigBCXVU5LkhLmMffgy9PlZCaCnF+R78txnSHzVgdDz95MdC7gRPWg4jG+jSsspbrPlrLwAiGD2MMso1f+tHJGWhsTJQ7jx/SlpvdSF76SjSNgLCa/sbq8FZt00B5LGHzIEmKXLgXkl59wk3cC/WfgExGpA6udvdHLKQrKhjCfrWexjFrd1PswWMr2ZlhSQaJkCGXVFeqBxTTba/kw61LgaCXeRBCOalpr1ORZQTtxbYZ2b2OgMzHbSzAuWdRYit0SdRRjblAd/7aoU8bd3UWO5/7m2zU6t8QspWtibbCd2AIuWYpRy+tX6W/ep3srKRWA5Fsa/Hbd2M3SRdLYAAAAASUVORK5CYII=","width":80,"height":80,"src":"/static/90020e3cb43b0bdf6641a85cf3dd7fea/829e2/ubuntu.png","srcSet":"/static/90020e3cb43b0bdf6641a85cf3dd7fea/829e2/ubuntu.png 1x,\n/static/90020e3cb43b0bdf6641a85cf3dd7fea/e94d6/ubuntu.png 1.5x"}}}}}},"pageContext":{"slug":"/ubuntu-docker-lamp-einrichten/","previous":{"id":"5d764eaf-29e0-5856-a714-32beca02898d","frontmatter":{"title":"Docker Compose unter Ubuntu 20.04 einrichten","tags":["Linux","Ubuntu","Docker","Docker Compose"],"template":"post"},"fields":{"slug":"/ubuntu-docker-compose-einrichten-docker-lamp/"}},"next":{"id":"3e7961b9-ddcc-5e79-92ac-37c2ef3997eb","frontmatter":{"title":"docker-lamp einrichten","tags":["Linux","Ubuntu","docker-lamp","Joomla"],"template":"post"},"fields":{"slug":"/ubuntu-docker-lamp-verwenden/"}}}},"staticQueryHashes":[]}