{"componentChunkName":"component---src-templates-post-js","path":"/leaflet-control-plugin-first-steps/","result":{"data":{"markdownRemark":{"html":"<p>Erstellen Sie Ihr erstes Leaflet-Control-Plugin - Ein Tutorial für Anfänger.</p>\n<p>In diesem Beitrag erkläre ich, wie Sie ein Plugin für LeafletJs erstellen. Ich zeige Ihnen, wie Sie ein Control-Plugin, somit ein Steuerelement für Ihre <a href=\"http://leafletjs.com/\">Leaflet</a> Karte programmieren.</p>\n<p>In diesem Text konzentriere ich mich darauf, die Struktur und den Lebenszyklus von Leaflet-Plugins zu erklären. Meine Codebeispiel habe ich auf <a href=\"https://github.com/astridx/leafletjs-plugin-boilerplate\">Github</a> veröffentlicht.</p>\n<h2>Leaflet Control-Plugins</h2>\n<p>Während <a href=\"/leaflet-layer-plugin-first-steps\">Layer-Plugins</a> die Karte mit Inhalten erweitern, fügen Control-Plugins Steuerelemente hinzu. Mithilfe dieser Elemente interagieren Sie mit der Karte. Beispiele für Steuerelemente sind die</p>\n<ul>\n<li>Zoomsteuerung und die</li>\n<li>Ebenensteuerung,</li>\n</ul>\n<p>die links oben und rechts oben in der folgenden Abbildung angezeigt werden.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d73e1491325bcdd43c72e213126333a5/0a47e/leafletcontrollsundlayer.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.25766871165644%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAAB/klEQVQ4y1VTu47UQBDc//8GREZGQIoECYLgAoSA414r78O7tsfjedq7nIiKrrbHHEFr3DPTVV3lno21FsMwoG1bXbvO4Hg8Yrvdoq5r9H2PEAJijPrN+8y997rnnNOc9TzbGGMEpNMNJ4DODQpMUK4pJS0sRYXcLESsfXp6wul00nzTNI0m+90O1W6PVi6wqAQ7iDFgEPZOyAlGMgKRjCBFpQLOMgbkMODTbY3XH34i+16AvBZQmrEOp6ZDJ2AEslKTU1g7L6sCkm0n3VHqubP48bhHb7qF1eF5inh3U+Ht5zv8uY5IOSMK0ZsvFeqWwEK6gCkgPTyfzwrgRV5OZIszq4T3DrcPW3z/dY8g3Rbf3t/c43huMQpBAWPNpuhX6bLaxTtK9QvAmBOmcVyl0dffU1ZvvQ//3d20iy9lZccE1I6Xi87/66AEVYQXUlfJlEsPD4cD+MdXQInoLL4+1nj18Q5jdOodzzifUe2YZ7GQr2NDUEaZs/kw6o86NQbfHvaIYd5LKa/DzOAksI6WqYcEpNQS5RUwEl+HdDymOA+4nDFnzQwQlljG56WHbFuZ5XD2cEB1rFFVO/Ry1stcdi7AyCgZHX4HGxKs7POFGc2lQzJn+fXX63WNy2VCni7Y2zi/DumojRMOYULjs3TJiRCA6Rl9yGjFrsYlNOmKv3DwyoDxfgtCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"leafletcontrollsundlayer\"\n        title=\"leafletcontrollsundlayer\"\n        src=\"/static/d73e1491325bcdd43c72e213126333a5/0a47e/leafletcontrollsundlayer.png\"\n        srcset=\"/static/d73e1491325bcdd43c72e213126333a5/222b7/leafletcontrollsundlayer.png 163w,\n/static/d73e1491325bcdd43c72e213126333a5/ff46a/leafletcontrollsundlayer.png 325w,\n/static/d73e1491325bcdd43c72e213126333a5/0a47e/leafletcontrollsundlayer.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>So erstellen Sie ein Leaflet Control-Plugin</h2>\n<p>Bevor ich mit Ihnen praktisch ein Control erstelle, hier die recht langweilig klingende Definition: Control-Plugins sind JavaScript-Klassen, die die Leaflet <a href=\"https://leafletjs.com/reference-1.6.0.html#class\">Klasse</a> <a href=\"https://leafletjs.com/reference-1.3.4.html#control\"><code class=\"language-text\">L.Control</code></a> erweitern. Üblicherweise wird der Name des Plugins zum Namensraum von Leaflet, zu <code class=\"language-text\">L</code>, hinzugefügt.</p>\n<p>Im nächsten Beispiel zeige ich Ihnen, wie Sie ein Control-Plugin mit dem Namen <code class=\"language-text\">L.LeafletControlExample</code> erstellen. Hier zunächst der JavaScript Code.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token constant\">L</span><span class=\"token punctuation\">.</span>LeafletControlExample <span class=\"token operator\">=</span> <span class=\"token constant\">L</span><span class=\"token punctuation\">.</span>Control<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    position<span class=\"token operator\">:</span> ‚topright‘\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Die Erweiterungsmethode <code class=\"language-text\">extend</code> der Klasse <code class=\"language-text\">L.Control</code> verwendet einen einzigen Parameter, der alle Eigenschaften und Methoden enthält, die das Plugin der <code class=\"language-text\">L.Control</code>-Unterklasse hinzufügt. Viele Control-Plugins verfügen über eine Reihe von Standardeinstellungen. Im obigen Code-Schnipsel enthält das Objekt <code class=\"language-text\">options</code> eine Standardeinstellung für die Position <code class=\"language-text\">position</code> des Steuerelements auf der Karte.</p>\n<p>Das Standardmuster für die Erstellung eines Leaflet-Plugins, implementiert eine <a href=\"https://de.wikipedia.org/wiki/Fabrikmethode\">Factory-Methode</a>, mit der die Erstellung des Plugins mit anderen Methoden-Aufrufen verkettet wird. Das ist praktisch. Deshalb enthält jedes Plugin diese Factory-Methode. Schreiben Sie dazu ans Ende der Datei den folgenden Text.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token constant\">L</span><span class=\"token punctuation\">.</span><span class=\"token function-variable function\">leafletControlExample</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">options</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">L<span class=\"token punctuation\">.</span>LeafletControlExample</span><span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Erstellen Sie Ihr Plugin in einer Zeile und fügen es zur Karte hinzu. Im Beispiel würde das wie folgt aussehen:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token constant\">L</span><span class=\"token punctuation\">.</span><span class=\"token function\">leafletControlExample</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> position<span class=\"token operator\">:</span> ‚bottomright‘ <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addTo</span><span class=\"token punctuation\">(</span>map<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Üblicherweise wird die Factory-Methode nach der Klasse des Steuerelement-Plugins benannt. Nur der erste Buchstabe wird - anstelle eines große - mit einem kleinen geschrieben.</p>\n<h3>Der Lebenszyklus des Leaflet Controll-Plugins</h3>\n<p>Leaflet ruft die folgenden Methoden eines Steuerelement-Plugins auf, wenn das Element zu einer Karte hinzugefügt wird.</p>\n<ul>\n<li>initialize()</li>\n<li>onAdd ()</li>\n</ul>\n<p>Leaflet ruft die initialize-Methode auf, wenn eine neue Instanz eines Controll-Plugins erstellt wird, indem entweder new direkt aufgerufen wird oder wenn die Factory-Methode verwendet wird:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token constant\">L</span><span class=\"token punctuation\">.</span><span class=\"token function\">leafletControlExample</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">new</span> <span class=\"token class-name\">L<span class=\"token punctuation\">.</span>LeafletControlExample</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>In der folgenden <code class=\"language-text\">initialize</code>-Methode wird <code class=\"language-text\">L.Util.setOptions</code> aufgerufen, um die Werte der Standardeinstellungen zu setzten.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">...</span>\n<span class=\"token function-variable function\">initialize</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">options</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token constant\">L</span><span class=\"token punctuation\">.</span>Util<span class=\"token punctuation\">.</span><span class=\"token function\">setOptions</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// Initialisierung des Control-Plugins.</span>\n <span class=\"token punctuation\">}</span>\n<span class=\"token operator\">...</span></code></pre></div>\n<p>Nach dem Aufruf von setOptions fügen wir der <code class=\"language-text\">initialize</code>-Methode weiteren Code zur Initialisierung des Steuerelements hinzu.</p>\n<p>Leaflet ruft die <code class=\"language-text\">onAdd</code>-Methode auf, wenn das Steuerelement mit einem der folgenden Methodenaufrufe zur Karte hinzugefügt wird:</p>\n<ul>\n<li>control.addTo(Karte);</li>\n<li>map.addControl(Steuerelement);</li>\n</ul>\n<p>Ein Leaflet-Control-Plugins ist ein DOM-Element Element - in der Regel ein HTML-Element -, das auf der Karte angezeigt wird. Genauer ausgedrückt: Das Element wird auf einer Schicht oberhalb der eigentlichen Kartenschicht angezeigt.</p>\n<p><strong>Wichtig:</strong> Die onAdd-Methode muss das DOM-Element zurückgeben.</p>\n<p>In der folgenden <code class=\"language-text\">onAdd</code>-Methode erstellen wir ein div-Element. Diesem <code class=\"language-text\">div</code>-Element fügen wir danach die Klasse <code class=\"language-text\">leaflet-control-example</code> hinzu. So formatieren wir das Steuerelement später mit CSS problemlos.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">...</span>\n<span class=\"token function-variable function\">onAdd</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">map</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> controlElementTag <span class=\"token operator\">=</span> ‚div‘<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> controlElementClass <span class=\"token operator\">=</span> ‚leaflet<span class=\"token operator\">-</span>control<span class=\"token operator\">-</span>example‘<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> controlElement <span class=\"token operator\">=</span> <span class=\"token constant\">L</span><span class=\"token punctuation\">.</span>DomUtil<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>controlElementTag<span class=\"token punctuation\">,</span> controlElementClass<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Hier können noch weitere Elemente hinzugefügt werden.</span>\n  <span class=\"token comment\">// Außerdem können Sie hier einem Element Events hinzufügen.</span>\n\n  <span class=\"token keyword\">return</span> controlElement<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token operator\">...</span></code></pre></div>\n<p>Wenn alles fertig ist, geben Sie das DOM-Element mit return controlElement zurück.</p>\n<p>Leaflet erwartet eine weitere Methode. Diese heißt <code class=\"language-text\">onRemove</code>. <code class=\"language-text\">onRemove</code> wird - wie der Name schon sagt - aufgerufen, wenn das Steuerelement von der Karte entfernt wird.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">control<span class=\"token punctuation\">.</span><span class=\"token function\">removeFrom</span><span class=\"token punctuation\">(</span>Karte<span class=\"token punctuation\">)</span>\nmap<span class=\"token punctuation\">.</span><span class=\"token function\">removeControl</span><span class=\"token punctuation\">(</span>Steuerelement<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Die onRemove-Methode ist der Ort, an dem aufgeräumt wird. Entfernen Sie hier die DOM-Elemente und Ereignis-Listener.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">...</span>\n<span class=\"token function-variable function\">onRemove</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">map</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Tear down the control.</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">...</span></code></pre></div>\n<h3>Styling</h3>\n<p>Gestalten Sie Leaflet Steuerelemente wie jedes andere DOM-Element mit CSS. Hier füge ich der CSS-Klasse leaflet-control-example Stilregeln hinzu. Naja, bisher stehen hier drei Punkte. Sie haben sicher etwas mehr Fantasie. Zur Erinnerung: Das div-Element mit der Klasse leaflet-control-example haben wir in der onAdd-Methode hinzugefügt.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">...</span>\n<span class=\"token punctuation\">.</span>leaflet<span class=\"token operator\">-</span>control<span class=\"token operator\">-</span>example <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">...</span></code></pre></div>\n<h3>Lesen Sie weiter</h3>\n<p>Die Leaflet-Dokumentation enthält einen <a href=\"https://leafletjs.com/2013/06/28/leaflet-plugin-authoring-guide.html\">Plugin-Authoring-Leitfaden</a>, in dem bewährte Vorgehensweisen zum</p>\n<ul>\n<li>Organisieren,</li>\n<li>Präsentieren und</li>\n<li>Demonstrieren</li>\n</ul>\n<p>von Leaflet-Plugin-Code erläutert werden.</p>\n<p>Auf der <a href=\"https://leafletjs.com/plugins.html\">Leaflet Website</a> werden verschiedene Plugins aufgelistet, die von der Leaflet-Community erstellt wurden. Die meisten Plugins sind <a href=\"https://de.wikipedia.org/wiki/Open_Source\">Open Source</a> und sind auf <a href=\"https://github.com/\">GitHub</a> verfügbar. Wer gerne mit Beispielen lernt, findet hier eine Fülle von Möglichkeiten, um das Erstellen eigenes Plugins zu lernen.</p>","excerpt":"Erstellen Sie Ihr erstes Leaflet-Control-Plugin - Ein Tutorial für Anfänger. In diesem Beitrag erkläre ich, wie Sie ein Plugin für LeafletJs…","fields":{"slug":"/leaflet-control-plugin-first-steps/"},"frontmatter":{"title":"Erstellen Sie Ihr erstes Leaflet-Control-Plugin - Ein Tutorial für Anfänger","date":"10.12.2018","tags":["geografische Daten","Leaflet"],"thumbnail":null}}},"pageContext":{"slug":"/leaflet-control-plugin-first-steps/","previous":{"id":"58da73b6-3ef0-5940-86a9-269dfc44b65c","frontmatter":{"title":"Leaflet","tags":["geografische Daten","Leaflet"],"template":"post"},"fields":{"slug":"/leaflet-tutorials/"}},"next":{"id":"9553a817-841f-5db4-ab3a-f4dd1cf852f2","frontmatter":{"title":"Erstellen Sie Ihr erstes Leaflet-Layer-Plugin - Ein Tutorial für Anfänger","tags":["geografische Daten","Leaflet"],"template":"post"},"fields":{"slug":"/leaflet-layer-plugin-first-steps/"}}}}}