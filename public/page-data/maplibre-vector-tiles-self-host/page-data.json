{
    "componentChunkName": "component---src-templates-post-js",
    "path": "/maplibre-vector-tiles-self-host/",
    "result": {"data":{"markdownRemark":{"html":"<h2 id=\"selbst-gehosteten-karten-und-vector-tiles-mit-tilemaker-erstellen-und-nutzen\" style=\"position:relative;\"><a href=\"#selbst-gehosteten-karten-und-vector-tiles-mit-tilemaker-erstellen-und-nutzen\" aria-label=\"selbst gehosteten karten und vector tiles mit tilemaker erstellen und nutzen permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Selbst gehosteten Karten und Vector-Tiles mit Tilemaker erstellen und nutzen</h2>\n<p>Wenn eine digitale Karte in einer Webanwendung angezeigt wird, verwenden Webentwickler in der Regel Online-Dienste. Für viele Anwendungen ist dies jedoch nicht erforderlich. Es ist gar nicht so kompliziert, selbst Karten zu erstellen und sie auf dem eigenen Webspace zu hosten. Frei verfügbare Daten von OpenStreetmap und Open-Source-Tools unterstützen beim Erstellen von individuellen Vektorgrafik-Karten für eine Website/Webanwendung. Problematisch ist in meinen Augen lediglich die Datenmenge. Aber meist ist es nicht erforderlich die ganze Welt in der Karte aufzunehmen.</p>\n<blockquote>\n<p>Das Hosting des gesamten Planeten erfordert erhebliche Mengen an Speicherplatz. Im April 2022 liegt die Dateigröße bei 63 GB[^wiki.openstreetmap.org/wiki/DE:Planet.osm].</p>\n</blockquote>\n<p>In diesem Beitrag zeige, wie ich eine Karten mit Daten von OpenStreetmap und <em>Tilemaker</em> für das deutsche Bundesland Rheinland-Pfalz auf meinem lokalen Rechner erstellt habe. Ich arbeite zur Zeit unter Ubuntu 20.04.</p>\n<h3 id=\"erstellen-eines-regionalen-openstreetmap-daten-exports\" style=\"position:relative;\"><a href=\"#erstellen-eines-regionalen-openstreetmap-daten-exports\" aria-label=\"erstellen eines regionalen openstreetmap daten exports permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Erstellen eines regionalen Openstreetmap-Daten-Exports</h3>\n<blockquote>\n<p>Die Bounding Box[^wiki.openstreetmap.org/wiki/DE:Bounding_Box] von Rheinland-Pfalz ist <code class=\"language-text\">bbox=6.1173598760,48.9662745077,8.5084754437,50.9404435711</code>. Ein praktisches Werkzeug zum bestimmen der Bounding-Box-Koordinaten ist boundingbox[^boundingbox.klokantech.com] oder calc[^tools.geofabrik.de/calc/].</p>\n</blockquote>\n<p>Als erstes müssen wir einen Export der Region erstellen, die wir hosten möchten. Es ist möglich, vorgefertigte Exporte von hier zu erhalten: GeoFabrik[download.geofabrik.de]. Beachte dabei jedoch, dass wir, wenn wir eine Region exportieren möchten, eigentlich einen rechteckigen Export wünschen. Wir möchten also auch einige Teile rund um die Grenze mit einbeziehen. Die Exporte von Geofabrik werden um die Grenzen der Region herum extrahiert und die angrenzenden Bereiche erscheinen als graue Flächen, wenn wir die Karte auf einen rechteckigen Bereich anzeigen.</p>\n<p>Wir wollen also ein Land exportieren, zum Beispiel Rheinland-Pfalz. Wir können einen rechteckigen Ausschnitt aus einer größeren Region generieren, beispielsweise Deutschland. Den Ausschnitt erstelle ich mit dem Werkzeug Osmium. Wir laden also zunächst das Gebiet Deutschland aus der GeoFabrik herunter. Der nächste Schritt besteht darin, den Begrenzungsrahmen der Region zu bestimmen, die wir extrahieren möchten.</p>\n<blockquote>\n<p>Weil Rheinland-Pfalz am Rand von Deutschland liegt, hätte ich Europa als größere Datenquelle wählen müssen, damit es tatsächlich rechteckig ist.</p>\n</blockquote>\n<p>Die von mir gewählte Begrenzung ist: <code class=\"language-text\">6.1173598760 48.9662745077 8.5084754437 50.940443571</code>[^tools.geofabrik.de/calc/#type=geofabrik_standard&#x26;bbox=6.1173598760,48.9662745077,8.5084754437,50.9404435711&#x26;tab=1&#x26;proj=EPSG:4326&#x26;places=2]</p>\n<p>Unter Ubuntu installiere ich das Tool <em>Osmium</em> via:</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">$ sudo apt-get install osmium-tool</span></span></code></pre>\n<p>Dann erstelle ich den regionalen Export für das deutschge Bundesland Rheinland-Pfalz:</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">$ osmium extract --bbox=6.1173598760,48.9662745077,8.5084754437,50.9404435711 --set-bounds --strategy=smart germany-latest.osm.pbf  --output rlp.osm.pbf</span></span></code></pre>\n<p>Am Ende verfüge ich über einen rechteckigen Ausschnitt der Region zum selbst hosten in der Datei <code class=\"language-text\">rlp.osm.pbf</code>.</p>\n<h3 id=\"erzeugen-von-vector-tiles\" style=\"position:relative;\"><a href=\"#erzeugen-von-vector-tiles\" aria-label=\"erzeugen von vector tiles permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Erzeugen von Vector-Tiles</h3>\n<p>Der nächste Schritt ist die Erstellung von Vektorkacheln aus dem regionalen Export. Hierfür verwende ich Tilemaker[^github.com/systemed/tilemaker].</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">git clone https://github.com/systemed/tilemaker.git</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">cd tilemaker</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span></code></pre>\n<p>Danach kompiliere und installiere ich Tilemaker via <code class=\"language-text\">make</code> und <code class=\"language-text\">sudo make install</code>.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">$ make</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">$ sudo make install</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Using Lua 5.1 (include path is -I/usr/include/lua5.1, library path is -llua5.1)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">install -m 0755 -d /usr/local/bin/</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">install -m 0755 tilemaker /usr/local/bin/</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">install -d /usr/share/man/man1/</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">install docs/man/tilemaker.1 /usr/share/man/man1/</span></span></code></pre>\n<p>Für Rheinland-Pfalz ist es nicht relevant, aber manchmal benötigt man Daten aus internationalen Gewässern und Küstengebieten. Openstreetmap stellt diese auf der Website <code class=\"language-text\">osmdata.openstreetmap.de</code> zur Verfügung.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">wget https://osmdata.openstreetmap.de/download/water-polygons-split-4326.zip</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">unzip water-polygons-split-4326.zip</span></span></code></pre>\n<p>Jetzt habe ich alles notwendige und erstelle die Karte mithilfe von Tilemaker. Als erstes verschaffe ich mir einen Überblick über die Optionen:</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">$ ./tilemaker --help</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">tilemaker v2.2.0</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Convert OpenStreetMap .pbf files into vector tiles</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Available options:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  --help                       show help message</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  --input arg                  source .osm.pbf file</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  --output arg                 target directory or .mbtiles/.sqlite file</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  --bbox arg                   bounding box to use if input file does not have </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">                               a bbox header set, example: </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">                               minlon,minlat,maxlon,maxlat</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  --merge                      merge with existing .mbtiles (overwrites </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">                               otherwise)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  --config arg (=config.json)  config JSON file</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  --process arg (=process.lua) tag-processing Lua file</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  --store arg                  temporary storage for node/ways/relations data</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  --compact                    Reduce overall memory usage (compact mode).</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">                               NOTE: This requires the input to be renumbered </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">                               (osmium renumber)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  --verbose                    verbose error output</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  --skip-integrity             don&#39;t enforce way/node integrity</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  --threads arg (=0)           number of threads (automatically detected if 0)</span></span></code></pre>\n<h4 id=\"ausgabeoptionen\" style=\"position:relative;\"><a href=\"#ausgabeoptionen\" aria-label=\"ausgabeoptionen permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ausgabeoptionen</h4>\n<p>Wenn du deine Karten mit Tilemaker generierst, gibt es zwei Ausgabeoptionen: <em>directory</em> und <em>mbtiles</em>.</p>\n<h5 id=\"directory\" style=\"position:relative;\"><a href=\"#directory\" aria-label=\"directory permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Directory</h5>\n<p>Mit <em>Tilemaker</em> ist es möglich, die Kacheldateien als einzelne Dateien in ein Verzeichnis zu generieren. Diese Möglichkeit werde ich zunächst nicht verwenden. Ich verwende <em>mbtiles</em> und werde die mbtiles-Datei später auf einem anderen Server zum Veröffentlichen entpacken. Beim Stylen auf meinem Entwicklungsserver ist eine einzige Datei besser handhabbar.</p>\n<blockquote>\n<p>Achte darauf, in der Konfigurations-Datei <code class=\"language-text\">\"compress\":</code> mit <code class=\"language-text\">\"none\"</code> zu belegen. In diesem Beispiel ist dies die Datei <code class=\"language-text\">config-openmaptiles.json</code>!</p>\n</blockquote>\n<p>Möchtest du alle <code class=\"language-text\">pbf</code>-Dateien einzeln in ein Verzeichnis erstellen? Dann reicht es aus, im Parameter <code class=\"language-text\">Output</code> keine Endung zu verwenden. <code class=\"language-text\">--output rlp.mbtiles</code> packt beispielsweise alle <code class=\"language-text\">pbf</code>-Dateien in die Datei <code class=\"language-text\">rlp.mbtiles</code>. <code class=\"language-text\">--output rlp</code> legt alle pbf-Dateien einzeln im Verzeichnis <code class=\"language-text\">rlp</code> an.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">$ ./tilemaker --input ./rlp.osm.pbf --output rlp --process ./resources/process-openmaptiles.lua --config ./resources/config-openmaptiles.json</span></span></code></pre>\n<p>In diesem Beispiel werden die Dateien im Verzeichnis <code class=\"language-text\">rlp</code> erzeugt. In diesem Verzeichnis gibt es eine Reihe von Verzeichnissen und eine Datei namens <code class=\"language-text\">metadata.json</code>.</p>\n<h5 id=\"mbtiles\" style=\"position:relative;\"><a href=\"#mbtiles\" aria-label=\"mbtiles permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>mbtiles</h5>\n<p>Die <code class=\"language-text\">mbtiles</code>-Datei ist eine <code class=\"language-text\">sqlite3</code>-Datenbank, die von serverseitigen Skriptsprachen wie PHP LUA oder NodeJs gelesen werden kann. Tileserver wie tileserver-php öffnen diese Datei und lesen die Kacheldaten aus, sobald der Client sie anfordert. Diese Umgebung wähle ich für meinen Arbeitsumgebung.</p>\n<p>Ich rufe den nachfolgenden Befehl auf, wobei ich der Einfachheit halber die mitgelieferten Beispielkonfigurationen von openmaptiles.org verwende.</p>\n<blockquote>\n<p>Falls du so wie ich vor hast, die Vector Tiles später nicht als eine Datei anzubieten, sondern in ein Verzeichnis entpacken möchtest, ist es wichtig in der Datei <code class=\"language-text\">config-openmaptiles.json</code> die Eigenschaft <code class=\"language-text\">\"compress\":</code> mit <code class=\"language-text\">\"none\"</code> zu belegen!</p>\n</blockquote>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">$ ./tilemaker --input ./rlp.osm.pbf --output rlp.mbtiles --process ./resources/process-openmaptiles.lua --config ./resources/config-openmaptiles.json</span></span></code></pre>\n<p>Wenn die Konvertierung abgeschlossen ist und alles fehlerfrei verlief steht am Ende</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">Filled the tileset with good things at rlp.mbtiles</span></span></code></pre>\n<p>Voila! Die Kachel sind nun für den Webserver fertig vorbereitet!</p>\n<h3 id=\"hosting-der-vector-tiles\" style=\"position:relative;\"><a href=\"#hosting-der-vector-tiles\" aria-label=\"hosting der vector tiles permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hosting der Vector-Tiles</h3>\n<p>Für das Hosting der Vector-Tiles benötigen wir einen Webserver mit aktiviertem PHP. Außerdem sollte der PHP-Server sqlite-fähig sein, da die mbtiles-Dateien im Grunde genommen eine sqlite-Datenbankdatei sind, die von unserem Tileserver geöffnet wird. Um die Karte zu hosten, werden wir Tileserver-php[^github.com/maptiler/tileserver-php] verwenden. Klone dieses Repository mit git auf deinen Webserver:</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">/srv/www$ git clone  https://github.com/maptiler/tileserver-php</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Klone nach &#39;tileserver-php&#39; …</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">remote: Enumerating objects: 574, done.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">remote: Counting objects: 100% (7/7), done.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">remote: Compressing objects: 100% (7/7), done.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">remote: Total 574 (delta 2), reused 0 (delta 0), pack-reused 567</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Empfange Objekte: 100% (574/574), 1.47 MiB | 739.00 KiB/s, fertig.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Löse Unterschiede auf: 100% (290/290), fertig.</span></span></code></pre>\n<p>Kopiere die eben erstellte mbtiles-Datei in das Verzeichnis tileserver-php. In unserem Beispiel ist das konkret die Datei <code class=\"language-text\">rlp.mbtiles</code> und diese soll sich am Ende im Verzeichnis <code class=\"language-text\">/srv/www/tileserver-php</code> befinden.</p>\n<p>Wenn du den Apache-Webserver verwendest, ist jetzt alles eingestellt. Öffne die Url zur <code class=\"language-text\">tileserver.php</code> und schau dir deine Karte an. In meinem Fall ist dies konkret die URL <code class=\"language-text\">https://localhost/tileserver-php/tileserver.php</code>. Du siehst die rohe Version der Linien und Punkte.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f64b7aec6f4fede70df7b94a4160a082/28e7f/maplibrevector1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaklEQVQoz4WRUU/UQBSF90/7BIYiiQ/+Bx8kAhuNrz4CCSzwKrBF6IobWkPK0nY7M52Z0k4/04auIIg3ObnJzck3594ZvP18yLsvR7wZjlgbjrrube6xurXfydsa4X06whsedHNvc5/XH3d59f4rKxt7LK/vdFr6sM3S+g4D/lsOVALOPJr+jC6hsigxR85T7rTElZpB7RwL1Q7XQCEEcXRDGFyRnI+ZHWxTTCctGucc1pZcnAdIpUhySSYU2liMLRk0TcNDtVVrSTadkE4C4lOf5PQbZXy9SFeVd4Q/plRVRS4kuSwoq7oL9WjlHlhZjQi+k/lnSP+YeOyj8mLhaW1VXeNcjVIFaZaR5RJj7TPApulWS8OQuX+Cnt2SRDGqUK3j3vPHb4xBa911+xywTyluZ8yiX+RRSDoeMxeChpq/T9RCehljn/5yD2yPXxQaexUgLy/QunzyaA9s0/0z4cO+mN8/8BKwT/kbMuapK58rhZkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Ansicht der Linestrings und Points auf dem Tileserver PHP\"\n        title=\"Ansicht der Linestrings und Points auf dem Tileserver PHP\"\n        src=\"/static/f64b7aec6f4fede70df7b94a4160a082/5a190/maplibrevector1.png\"\n        srcset=\"/static/f64b7aec6f4fede70df7b94a4160a082/772e8/maplibrevector1.png 200w,\n/static/f64b7aec6f4fede70df7b94a4160a082/e17e5/maplibrevector1.png 400w,\n/static/f64b7aec6f4fede70df7b94a4160a082/5a190/maplibrevector1.png 800w,\n/static/f64b7aec6f4fede70df7b94a4160a082/c1b63/maplibrevector1.png 1200w,\n/static/f64b7aec6f4fede70df7b94a4160a082/29007/maplibrevector1.png 1600w,\n/static/f64b7aec6f4fede70df7b94a4160a082/28e7f/maplibrevector1.png 1848w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"vector-tiles-auf-deiner-website\" style=\"position:relative;\"><a href=\"#vector-tiles-auf-deiner-website\" aria-label=\"vector tiles auf deiner website permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Vector Tiles auf deiner Website</h3>\n<p>Nun sind wir bereit, die generierten Kacheln auf unserer eigenen Website zu verwenden. Hierfür verwenden wir die Bibliothek <em>MapLibre GL JS</em>[^maplibre.org/] zusammen mit einem Stil von OpenMapTiles[^<a href=\"https://openmaptiles.org/styles/%5D\">https://openmaptiles.org/styles/]</a>. Erstelle ein kleines HTML-Dokument, welches die Karte anzeigt:</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"html\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk17\">&lt;!</span><span class=\"mtk4\">DOCTYPE</span><span class=\"mtk1\"> </span><span class=\"mtk12\">html</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk17\">&lt;</span><span class=\"mtk4\">html</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk17\">&lt;</span><span class=\"mtk4\">head</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;</span><span class=\"mtk4\">meta</span><span class=\"mtk1\"> </span><span class=\"mtk12\">charset</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;utf-8&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk17\">/&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;</span><span class=\"mtk4\">title</span><span class=\"mtk17\">&gt;</span><span class=\"mtk1\">Display a map on a webpage</span><span class=\"mtk17\">&lt;/</span><span class=\"mtk4\">title</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;</span><span class=\"mtk4\">meta</span><span class=\"mtk1\"> </span><span class=\"mtk12\">name</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;viewport&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">content</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&quot;initial-scale=1,maximum-scale=1,user-scalable=no&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk17\">/&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;</span><span class=\"mtk4\">script</span><span class=\"mtk1\"> </span><span class=\"mtk12\">src</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;https://unpkg.com/maplibre-gl@2.1.9/dist/maplibre-gl.js&#39;</span><span class=\"mtk17\">&gt;&lt;/</span><span class=\"mtk4\">script</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;</span><span class=\"mtk4\">link</span><span class=\"mtk1\"> </span><span class=\"mtk12\">href</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;https://unpkg.com/maplibre-gl@2.1.9/dist/maplibre-gl.css&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">rel</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;stylesheet&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk17\">/&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk17\">&lt;/</span><span class=\"mtk4\">head</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk17\">&lt;</span><span class=\"mtk4\">body</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;</span><span class=\"mtk4\">div</span><span class=\"mtk1\"> </span><span class=\"mtk12\">id</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;map&#39;</span><span class=\"mtk1\"> </span><span class=\"mtk12\">style</span><span class=\"mtk1\">=</span><span class=\"mtk8\">&#39;width: 800px; height: 800px;&#39;</span><span class=\"mtk17\">&gt;&lt;/</span><span class=\"mtk4\">div</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;</span><span class=\"mtk4\">script</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">var</span><span class=\"mtk1\"> </span><span class=\"mtk12\">map</span><span class=\"mtk1\"> = </span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">maplibregl</span><span class=\"mtk1\">.</span><span class=\"mtk10\">Map</span><span class=\"mtk1\">({</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">container:</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;map&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">style:</span><span class=\"mtk1\"> </span><span class=\"mtk8\">&#39;rlp.json&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">center:</span><span class=\"mtk1\"> [</span><span class=\"mtk7\">7</span><span class=\"mtk1\">, </span><span class=\"mtk7\">50</span><span class=\"mtk1\">],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk12\">zoom:</span><span class=\"mtk1\"> </span><span class=\"mtk7\">4</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        });</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk12\">map</span><span class=\"mtk1\">.</span><span class=\"mtk11\">addControl</span><span class=\"mtk1\">(</span><span class=\"mtk4\">new</span><span class=\"mtk1\"> </span><span class=\"mtk10\">maplibregl</span><span class=\"mtk1\">.</span><span class=\"mtk10\">NavigationControl</span><span class=\"mtk1\">());</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk17\">&lt;/</span><span class=\"mtk4\">script</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk17\">&lt;/</span><span class=\"mtk4\">body</span><span class=\"mtk17\">&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk17\">&lt;/</span><span class=\"mtk4\">html</span><span class=\"mtk17\">&gt;</span></span></span></code></pre>\n<p>Weiterhin benötigst du Styles, um die rohen Linien und Punkte ansprechend zu gestalten. Fürs erste wähle eine fertige Style-Datei. Du kannst diese von der Demo zu diesem Beitrag[astridx.github.io/vectortiles/rlp.json] herunterladen oder einen anderen Stil von <a href=\"https://openmaptiles.org/styles/\">OpenMapTiles</a> verwenden. Passe zwei URLs an deine individuelle Umgebung an. Die URLs verweisen auf deinen Tileserver. Der Name <code class=\"language-text\">rlp.json</code> ist zwingend, wenn die <code class=\"language-text\">mbtiles</code>-Datei <code class=\"language-text\">rlp</code> heißt: Der Name der <code class=\"language-text\">mbtiles</code>-Datei muss mit dem Namen der <code class=\"language-text\">json</code>-Style-Datei übereinstimmen!</p>\n<p>In der Datei <code class=\"language-text\">rlp.json</code> ist wichtig, dass die URL in der Eigenschaft <code class=\"language-text\">glyphs</code> auf Schriften zeigt. Diese Schriften werden wir im nächsten Schritt besorgen. Außerdem ist die URL in der Eigenschaft <code class=\"language-text\">sources</code> eventuell in deiner Umgebung eine andere und deshalb anzupassen.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">{</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;version&quot;: 8,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;name&quot;: &quot;Basic&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;metadata&quot;: {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      &quot;mapbox:autocomposite&quot;: false,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      &quot;mapbox:type&quot;: &quot;template&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      &quot;maputnik:renderer&quot;: &quot;mbgljs&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      &quot;openmaptiles:version&quot;: &quot;3.x&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      &quot;openmaptiles:mapbox:owner&quot;: &quot;openmaptiles&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      &quot;openmaptiles:mapbox:source:url&quot;: &quot;mapbox://openmaptiles.4qljc88t&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    },</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;sources&quot;: {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      &quot;openmaptiles&quot;: {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        &quot;type&quot;: &quot;vector&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">          &quot;url&quot;: &quot;metadata.json&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      }</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    },</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;glyphs&quot;: &quot;fonts/{fontstack}/{range}.pbf&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;layers&quot;: [</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...      </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span></code></pre>\n<p>Die Daten zur Eigenschaft <code class=\"language-text\">sources</code> lagere ich in die Datei <code class=\"language-text\">metadata.json</code> aus, welche ich im gleichen Verzeichnis wie die <code class=\"language-text\">rlp.json</code> abspeichere. Passe in dieser Datei die URL in der Eigenschaft <code class=\"language-text\">tiles</code> an.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">{</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;tilejson&quot;: &quot;2.0.0&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;scheme&quot;: &quot;xyz&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;type&quot;: &quot;baselayer&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;format&quot;: &quot;pbf&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;tiles&quot;: [</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        &quot;https://localhost/tileserver-php/tileserver.php?/index.json?/rlp/{z}/{x}/{y}.pbf&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    ],</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span></code></pre>\n<p>Beim Anpassen der Eigenschaft <code class=\"language-text\">glyphs</code> hast du schon gesehen, dass Schriftarten auf deinem Server notwendig sind. Auch hier kannst du fürs Erste auf Fertiges zurückgreifen. klokantech[^github.com/klokantech/klokantech-gl-fonts] bietet auf Github ein Paket mit Fonts. Klone es in dein Webserver-Verzeichnis und setze Symlinks.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">git clone https://github.com/klokantech/klokantech-gl-fonts fonts</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">ln -sf &#39;KlokanTech Noto Sans Bold&#39; fonts/Bold</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">ln -sf &#39;KlokanTech Noto Sans Regular&#39; fonts/Regular</span></span></code></pre>\n<p>In meinem Webserverzeichnis verfüge ich nun über folgende Dateien:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 717px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3ec26f93a114fedaf50a45158e544aca/0ad97/maplibrevector3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 17%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAkElEQVQI12WNSw/CIBCE+9v17D9Tj7YXIqFcwEcor9JSGLMkJo1+l53dmex04s5xOhzxfj1BmCkgxNS0tRacc3xhjMF737RzDsaYprdtg50CSqno4hxxvl6wLCtKKZBSQmndgg+tcet75JxRa4UQAiGE5imlMI6y3en5MAyIcUaHHWTuoeaU0p/3m6Odimh+AFlC5xs6b+zZAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Webserver Verzeichnis zum Veröffentlichen einer mbtiles Datei\"\n        title=\"Webserver Verzeichnis zum Veröffentlichen einer mbtiles Datei\"\n        src=\"/static/3ec26f93a114fedaf50a45158e544aca/0ad97/maplibrevector3.png\"\n        srcset=\"/static/3ec26f93a114fedaf50a45158e544aca/772e8/maplibrevector3.png 200w,\n/static/3ec26f93a114fedaf50a45158e544aca/e17e5/maplibrevector3.png 400w,\n/static/3ec26f93a114fedaf50a45158e544aca/0ad97/maplibrevector3.png 717w\"\n        sizes=\"(max-width: 717px) 100vw, 717px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Sieh dir jetzt deine eigene gehostete Karte an. Ich habe die Karte unter der Adresse <code class=\"language-text\">https://localhost/tileserver-php/</code> abgelegt:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0cc5fb8db7e868d7659b39e217c42cb7/ffe34/maplibrevector4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADCElEQVQ4y3WU23LiRhRF/f8fkqfkaZIHJ8PYCLCNDOYihFpS33QBbMwggYCZsiteKWkSV1I4XXXeulfts88+fVHtdxTFhl31TFUVbLcbymLLer3m6WnB5uuaovjK6VRxOh04Hg8cT3sOx4Jv30+8vr7y8vLyXhePS0Ggv+DLK0bCQZkH8szHJh42nSDtgLnqYdIBvuwSqB6BvcZkY47Hivq8vb2918XTMkSbAV7YZRJ1ifU9aeoRmjaB6hDGwwY0lpeEto1QN0T6BptOORyKd+A/5+JxEfKYh0jbI1AOOnUxWR9hHEbyV+a6RaT7eNENcXLHTF4h1QilBxTl87nCBrgI0IlLqDvESQ+Z3OKrawLdJkocpBmxXESI0GMSfmYS/85cdtnvi/8AG4XrZYxNBwTaIbY9In2HUiN0ekeezciSGakV2GSCH98wFbUVt8yiDkX5eA58WkZoO2wUmvQBoTvMVRtl70mSKcaMGsAkauHFVwjTQ1kXX35hu1ucA+uW66Fk2ZQkG+PrFhP1G4HpNo/nus1UtRD1gEwXP+7ixdcMo1/Y7JK/gX/+W2GIMkNCdUtk7klSH5X28XWbuekwCq8RymkUaztofB3LP5jEX9iW648VJskMY0foZIy1fqOm9jO2oyZ3kemimtYdJvISWd9VAfvd9iOgYJnX0AnS3GPTEb5yCOtsqhahcZpM1t4GxiEyd8R6SmJ9DtX2Y4WPeUADzgSxGiBkH2EdhLnGU5cEqk1kboi1i4gHyMRFGZdjVXwMXOUBq0VAmsyI9ZDQdgnMFbO49WM7pPtjKKqPUpNmmyLd4XQo/0fhImCRBSTWIzBtZuozc+k0LdZ5rIchTV0uxo6JVL9ZgqrafABchk27q1yQZR6RcgllH2mGjZ81yNgheR400ZqJLjPRYxx/YrMz57FZ5XOWmd/UKptjtYeI3UaFtWPC2MUL6k+jT5I88CA+4c5/5nb+E09bfQ6s9huq3fN7leWacremLJ/YljmbImFT5GyLnKJc8VxqVlvBYuNz+HY+lL8ACAjWvPIGjgoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Webserver view to of the mbtiles file\"\n        title=\"Webserver view to of the mbtiles file\"\n        src=\"/static/0cc5fb8db7e868d7659b39e217c42cb7/5a190/maplibrevector4.png\"\n        srcset=\"/static/0cc5fb8db7e868d7659b39e217c42cb7/772e8/maplibrevector4.png 200w,\n/static/0cc5fb8db7e868d7659b39e217c42cb7/e17e5/maplibrevector4.png 400w,\n/static/0cc5fb8db7e868d7659b39e217c42cb7/5a190/maplibrevector4.png 800w,\n/static/0cc5fb8db7e868d7659b39e217c42cb7/ffe34/maplibrevector4.png 1055w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"mbtiles-entpacken\" style=\"position:relative;\"><a href=\"#mbtiles-entpacken\" aria-label=\"mbtiles entpacken permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MBTiles entpacken</h3>\n<p>Du hast gesehen: Es ist möglich die von Tilemaker generierte <code class=\"language-text\">mbtile</code>-Datei zu hosten, nämlich via  Tileserver wie <em>tileserver-php</em>. Dies ist für eine Entwicklungsumgebung praktisch. Performanter ist es allerdings, die Vector-Tiles direkt von einem statischen Webserver zu laden. Nebenbei ist die Handhabung von großen Dateien in bestimmten Umgebungen problematisch. Beispielsweise sind besondere Schritte notwendig, um eine Demo[astridx.github.io/vectortiles/index.html] auf <em>github.io</em> zu veröffentlichen, wenn sich eine Datei mit mehr als 100 MB im Paket befindet.</p>\n<p>Wie schon erwähnt, kannst du mit <em>Tilemaker</em> einzelne <code class=\"language-text\">pbf</code>-Dateien in einem Verzeichnis anlegen. In meinem Workaround bevorzuge ich es, mit <code class=\"language-text\">mbtiles</code>-Dateien zu arbeiten und die zum Veröffentlichen vorgesehene Datei am Ende zu entpacken. Hierfür gibt es das Werkzeug <em>mbutil</em>.</p>\n<p>Installiere <em>mbutil</em> und <em>Python</em> und verschaffe dir einen Überblick über die Optionen von <em>mbutil</em>.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">git clone https://github.com/mapbox/mbutil.git</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">sudo apt-get install python3 </span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">cd mbutil/</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">./mbutil/mb-util -h</span></span></code></pre>\n<p>Die Datei <code class=\"language-text\">rlp.mbtiles</code> entpacke ich via</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">./mbutil/mb-util rlp.mbtiles rlpdir --image_format=pbf </span></span></code></pre>\n<blockquote>\n<p>Zur Erinnerung: Zum statischen hosten dürfen die Tiles nicht komprimiert sein! Beim Erstellen muss <code class=\"language-text\">\"compress\": \"none\"</code> in der Konfiguration von Tilemaker aktiviert gewesen sein.</p>\n</blockquote>\n<p>In meinem Webserver-Verzeichnis verfüge ich nun über folgende Dateien:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 657px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d3446c741064914fb7be19c75ac70424/a1253/maplibrevector2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAArklEQVQY022PSwvCMBCE+/8v4kkFDx7as39Bit69lZ4CKdoHmNZKIJs0GWlqfBQHEvbbzA7ZyDmH/XaH8+kIL+fwkArGDAgqigJKKV9X/IJ4scStLj1rInDOMeaMisYrThIc0tQ3iBSuZQ0h2mlAa2RZhraduGkarNYblFXlWUqJPM+htfkEWmthh+EVQBBCoO/7NzPG0HV3/BMReW/YKApfnbZ1P+Y5h973mb89AafcM39BkNpOAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Webserver Verzeichnis zum Veröffentlichen von statischen Vector Tiles\"\n        title=\"Webserver Verzeichnis zum Veröffentlichen von statischen Vector Tiles\"\n        src=\"/static/d3446c741064914fb7be19c75ac70424/a1253/maplibrevector2.png\"\n        srcset=\"/static/d3446c741064914fb7be19c75ac70424/772e8/maplibrevector2.png 200w,\n/static/d3446c741064914fb7be19c75ac70424/e17e5/maplibrevector2.png 400w,\n/static/d3446c741064914fb7be19c75ac70424/a1253/maplibrevector2.png 657w\"\n        sizes=\"(max-width: 657px) 100vw, 657px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Die Datei <code class=\"language-text\">tileserver.php</code> benötige ich nicht mehr. Anstelle der Datei <code class=\"language-text\">rlp.mptiles</code> ist das Verzeichnis <code class=\"language-text\">rlp</code> getreten. Anpassen muss ich die URL zu den <code class=\"language-text\">tiles</code> in der Datei <code class=\"language-text\">metadata.json</code>. Diese lautet nun <code class=\"language-text\">\"https://localhost/tileserver-php/rlp/{z}/{x}/{y}.pbf\"</code> anstelle von <code class=\"language-text\">\"https://localhost/tileserver-php/tileserver.php?/index.json?/rlp/{z}/{x}/{y}.pbf\"</code>.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"\" data-index=\"16\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">{</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;tilejson&quot;: &quot;2.0.0&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;scheme&quot;: &quot;xyz&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;type&quot;: &quot;baselayer&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;format&quot;: &quot;pbf&quot;,</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    &quot;tiles&quot;: [</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">        &quot;https://localhost/tileserver-php/rlp/{z}/{x}/{y}.pbf&quot;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    ],</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span></code></pre>\n<p>Das Ergebnis kannst du dir in der <a href=\"https://astridx.github.io/vectortiles/index.html\">Demo</a>[^astridx.github.io/vectortiles/index.html] ansehen.</p>\n<h3 id=\"links\" style=\"position:relative;\"><a href=\"#links\" aria-label=\"links permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Links</h3>\n<ul>\n<li>Generating self-hosted maps using tilemaker[^blog.kleunen.nl/blog/tilemaker-generate-map]</li>\n<li>VectorTiles mithilfe von Tilemaker erstellen und nutzen[^youtube.com/watch?v=8J0J41YsAbc]</li>\n<li>Tipps zur Performance[^blog.kleunen.nl/blog/improving-tilemaker-hosting-speed]</li>\n<li>Planet[^wiki.openstreetmap.org/wiki/Planet.osm]</li>\n<li>GeoFabrik[^download.geofabrik.de]</li>\n<li>OSMData[^osmdata.openstreetmap.de/download/water-polygons-split-4326.zip]</li>\n<li>GeoFabrik Calc[^tools.geofabrik.de/calc]</li>\n<li>Osmium-tool[^github.com/osmcode/osmium-tool]</li>\n<li>OSMConvert[^wiki.openstreetmap.org/wiki/Osmconvert]</li>\n<li>Tilemaker[^github.com/systemed/tilemaker]</li>\n<li>Tileserver-php[^github.com/maptiler/tileserver-php]</li>\n<li>MapLibre[^maplibre.org]</li>\n<li>Klokantech GL fonts[^github.com/klokantech/klokantech-gl-fonts]</li>\n<li>OpenMapTiles styles[^openmaptiles.org/styles]</li>\n</ul>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .default-dark .mtk17 { color: #808080; }\n  .default-dark .mtk4 { color: #569CD6; }\n  .default-dark .mtk1 { color: #D4D4D4; }\n  .default-dark .mtk12 { color: #9CDCFE; }\n  .default-dark .mtk8 { color: #CE9178; }\n  .default-dark .mtk10 { color: #4EC9B0; }\n  .default-dark .mtk7 { color: #B5CEA8; }\n  .default-dark .mtk11 { color: #DCDCAA; }\n  .default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","excerpt":"Selbst gehosteten Karten und Vector-Tiles mit Tilemaker erstellen und nutzen Wenn eine digitale Karte in einer Webanwendung angezeigt wird…","fields":{"slug":"/maplibre-vector-tiles-self-host/"},"frontmatter":{"title":"Selbst gehosteten Karten und VectorTiles mit Tilemaker erstellen","date":"2022-06-05","tags":["geografische Daten","Tilemaker","Openstreetmap"],"syndication":null,"description":"desc","thumbnail":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAAsTAAALEwEAmpwYAAADKUlEQVQ4y3VUy0sqURj3z2ihC9853ktQrSJ6QJtWQSjNqM0EdRF6SUW0aFERrryX66LSgqiscRxnNNIszB5OqRWZSyGiGrBVBdEbzZzLOCbT4x7O4vCd8/t+v/PxfT8B875yuRzDMA/PaQ913m2N1PX61AipRsg6k6/bGvFQ5w/P6eIzbgn4SH+UbuhfFWmdIq1ToceVBnYr9DgXaehf9cdoPr4AfsvlzI6ESOsUgy41QioMLhmEccwyCFMY2KAYdIm0TrMj8VYEc4fxheOS5iUAJgCEkEJYVc96p/10jLwZI2867adVPetSCAMQAoCJkual8YXjPH+e2R+lRRpUBbN3MgirH9i0Bp/nDxg79WqnXucPmL/B5/qBTRmEATChggmhBvVFWf2Cp5dMQ/+qGGQTl7a6VbB7jLye22eGFi9r+kI1faGhxcu5fWaMvFbB7tJWN4AQYhBr6F99eskIvNSZUIOqETalDMKqTcGpnVfrxkuF0S9uQcUtaIXRb914mdp5rTYFZRCmggk1wpJ7qHNBlzXCB9f2hWzhrCVwr4JZIXkthCVwbwtna/tCfHCXNSKoM/lkOpyTpNDjZe3LlsDDzF5Oaz6SQpgUwrTmo5m9nCXwUNa+rNDj3NdkOrzO5BOokQIDRyIBncapk9kYM7GZHnSkBh2pic30bIwxTp1IQGdRTmmrW40Qn8FynavS6P+z9minstO7b9O7b3Yq+3vtsdLol+tcn8F82e/kaOPwrj2cndzOTG5nbOFs4/CuBER5VXiXXSxYMSUAE1IQbRrdt4WztnC2aXRfCqLAR85CwTzU+Sew0uBWtrrlOmfTSKxpJCrXOZX54CewlzrjNUk+t9LAtoGHuoifXG/FU1vxVPzk2kNdAAjB4QGY1yQMw/iitDDfnirYLdfj5R3eu6fMSoQedyTGHYmVCH33lCnv8Mr1bGlUMCHSoH6uPT8MRl68GiFC8cskfXuYvDpMXiXp21D8krsCkC+DwR9JCeQCYOJnG1n+y1vcP9pIACYk0JeR/GAGsYIZCDWoFHIpDLjCgEshl1CDFswg+p0ZfGNDpncb6v2vDf0DP3S/D7fd8goAAAAASUVORK5CYII=","width":150,"height":150,"src":"/static/7c1705d3acc30aff7fec6028c9c6c6b0/92ab1/maplibre.png","srcSet":"/static/7c1705d3acc30aff7fec6028c9c6c6b0/92ab1/maplibre.png 1x"}}}}}},"pageContext":{"slug":"/maplibre-vector-tiles-self-host/","previous":{"id":"67d0d99b-e4e3-5f94-aff2-e46e9e9d16d8","frontmatter":{"title":"A first Joomla Child-Template","tags":["Template","Joomla","Cassiopeia"],"categories":["Cassiopeia"],"template":"post"},"fields":{"slug":"/en/cassiopeia-mein-erstes-child-template/"}},"next":{"id":"b4c8e106-328c-52bf-93a1-4b0863ec817f","frontmatter":{"title":"Create self-hosted maps and vector tiles with Tilemaker","tags":["geografische Daten","Tilemaker","Openstreetmap"],"categories":["MapLibre"],"template":"post"},"fields":{"slug":"/en/maplibre-vector-tiles-self-host/"}}}},
    "staticQueryHashes": ["352937542"]}