{"componentChunkName":"component---src-templates-post-js","path":"/en/joomla-erweiterung-mit-dpdocker/","result":{"data":{"markdownRemark":{"html":"<p>As a reminder, <a href=\"/ubuntu-dpdocker/\"><em>Docker</em></a> makes it easier to manage software in containers. <a href=\"/ubuntu-docker-compose-einrichten\"><em>Docker Compose</em></a> is a tool that simplifies working with multiple containers. <a href=\"/ubuntu-dpdocker\"><em>DPDocker</em></a> contains pre-built images, containers and scripts to help you develop with and for Joomla.</p>\n<p>DPDocker offers the task <code class=\"language-text\">build</code>, with which Joomla extensions are optimally integrated. For this, it is necessary to follow rules. For a new extension, I would observe these. Rebuilding my already finished extensions would be costly. In this chapter, I merge an extension created with <a href=\"https://packagist.org/packages/astridx/jorobo\">jorobo</a> with DPDocker. This way I can continue to use my scripts for mapping, building, zipping and testing.</p>\n<h2>Requirements</h2>\n<p>Besides <a href=\"/ubuntu-docker-setup\">Docker</a> and <a href=\"/ubuntu-docker-compose-setup\">Docker Compose</a>, <a href=\"https://github.com/Digital-Peak/DPDocker.git\">DPDocker</a> is necessary. If you have followed this <a href=\"my-ubuntu-computer-themes/\">set</a> so far, everything fits.</p>\n<h2>Installing Composer and PHP</h2>\n<p>Composer is required to download <a href=\"https://packagist.org/packages/astridx/jorobo\">jorobo</a> with the package manager.</p>\n<h3>Installing dependencies</h3>\n<p>First, we update the package manager cache and install the required dependencies, including <code class=\"language-text\">php-cli</code>:</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">sudo apt update</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">sudo apt install php-cli unzip</span></span></code></pre>\n<h3>Downloading and installing Composer</h3>\n<p>We fetch the <a href=\"https://getcomposer.org/installer\">Composer installer</a> with <code class=\"language-text\">curl</code>:</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">cd ~</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">curl -sS https://getcomposer.org/installer -o composer-setup.php</span></span></code></pre>\n<p>Now we check that the downloaded installer matches the SHA-384 hash. Using <code class=\"language-text\">curl</code> we retrieve the latest signature and store it in a shell variable:</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">HASH=`curl -sS https://composer.github.io/installer.sig`</span></span></code></pre>\n<p>The following PHP code checks the installation script and outputs <code class=\"language-text\">Installer verified</code> if everything is correct.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">php -r „if (hash_file(‚SHA384‘, ‚composer-setup.php‘) === ‚$HASH‘) { echo ‚Installer verified‘; } else { echo ‚Installer corrupt‘; unlink(‚composer-setup.php‘); } echo PHP_EOL;“</span></span></code></pre>\n<p>The next step is to install Composer globally (downloaded under <code class=\"language-text\">/usr/local/bin</code>) via:</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">sudo php composer-setup.php --install-dir=/usr/local/bin --filename=composer</span></span></code></pre>\n<p>I am testing the installation with:</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">composer</span></span></code></pre>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">Output   ______</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  / ____/___  ____ ___  ____  ____  ________  _____</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"> / /   / __ \\/ __ `__ \\/ __ \\/ __ \\/ ___/ _ \\/ ___/</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">/ /___/ /_/ / / / / / / /_/ / /_/ (__  )  __/ /</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">\\____/\\____/_/ /_/ /_/ .___/\\____/____/\\___/_/</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">                    /_/</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Composer version 1.10.5 2020-04-10 11:44:22</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Usage:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  command [options] [arguments]</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Options:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  -h, --help                     Display this help message</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  -q, --quiet                    Do not output any message</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  -V, --version                  Display this application version</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      --ansi                     Force ANSI output</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      --no-ansi                  Disable ANSI output</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  -n, --no-interaction           Do not ask any interactive question</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      --profile                  Display timing and memory usage information</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      --no-plugins               Whether to disable plugins.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  -d, --working-dir=WORKING-DIR  If specified, use the given directory as working directory.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">      --no-cache                 Prevent use of the cache</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  -v|vv|vvv, --verbose           Increase the verbosity of messages: 1 for normal output, 2 for more verbose output and 3 for debug</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span></code></pre>\n<p>This ensures that Composer is successfully installed and available system-wide.</p>\n<h3>Installing PHP under Ubuntu 20.04 including necessary extensions</h3>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">sudo apt update</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">sudo apt install php php-cli php-fpm php-json php-pdo php-mysql php-zip php-gd  php-mbstring php-curl php-xml php-pear php-bcmath</span></span></code></pre>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">php -- version</span></span></code></pre>\n<h2>Clone a Joomla extension created with Jorobo.</h2>\n<blockquote>\n<p>Do you want to create an extension yourself? Here you can find an introduction: <a href=\"https://astridx.github.io/9997_jorobo/presentation/index.html#/\">Jrobo Workshop</a>.</p>\n</blockquote>\n<p>Next, I clone one of my repositories that contains a Joomla extension. I make sure that the repo is stored in a directory <strong>next to</strong> DPDocker. This is important because DPDocker looks for extensions here!</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">git clone  https://github.com/astridx/boilerplate.git</span></span></code></pre>\n<blockquote>\n<p>Alternatively, you can use the Joomla sample extension <a href=\"https://github.com/joomla-extensions/weblinks\">Weblinks</a>, which also uses Jorobo.</p>\n</blockquote>\n<p>Then I switch to the folder <code class=\"language-text\">boilerplate</code> and execute the command that downloads all the necessary dependencies.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">cd boilerplate</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">composer install</span></span></code></pre>\n<p>Now all dependencies are present in the <code class=\"language-text\">vendor</code> directory.</p>\n<h2>Create Joomla extension</h2>\n<p>I use <code class=\"language-text\">vendor/bin/robo build</code>. In the result I see the subdirectory <code class=\"language-text\">dist</code> where the packed installation file is located.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">vendor/bin/robo build</span></span></code></pre>\n<p>The command <code class=\"language-text\">vendor/bin/robo list</code> shows me all possible commands.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">vendor/bin/robo list</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">...</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">Available commands:</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  build     Build the joomla extension package</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  bump      Bump Version placeholder __DEPLOY_VERSION__ in this project. (Set the version up in the jorobo.ini)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  generate  Generate an extension skeleton - not implemented yet</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  headers   Update copyright headers for this project. (Set the text up in the jorobo.ini)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  help      Displays help for a command</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  list      Lists commands</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  map       Map into Joomla installation.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">  umap      Unmap from Joomla installation.</span></span></code></pre>\n<blockquote>\n<p>The commands are briefly explained in the <a href=\"https://astridx.github.io/9997_jorobo/presentation/index.html#/\">presentation</a>.</p>\n</blockquote>\n<p>With <code class=\"language-text\">vendor/bin/robo map \\path-to-your-joomla</code> symlinks to the Joomla installation <code class=\"language-text\">path-to-your-joomla</code> are set. This is handy. This way you can edit the files in your development directory and test the result directly in Joomla.</p>\n<p>It is not possible to symlink into a container straight away, so <code class=\"language-text\">vendor/bin/robo map</code> cannot be used easily. DPDocker offers an ideal environment with the <a href=\"https://github.com/Digital-Peak/DPDocker/tree/master/webserver#webserver-task\"><code class=\"language-text\">webserver</code> function</a>.</p>\n<h2>Using the Joomla extension with the DPDocker webserver</h2>\n<p>Now I change back one directory - to the directory where <code class=\"language-text\">boilerplate</code> and <code class=\"language-text\">DPDocker</code> are stored side by side. Here I call <a href=\"https://github.com/Digital-Peak/DPDocker/tree/master/webserver#execute\">./DPDocker/webserer/run.sh mysql rebuild</a>:</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">./DPDocker/webserer/run.sh</span></span></code></pre>\n<p>My computer works for a few minutes. In that time, it creates all the necessary Docker containers.</p>\n<blockquote>\n<p>If you want to test a special database version, this is possible with <a href=\"https://github.com/Digital-Peak/DPDocker/tree/master/webserver#execute\">optional parameters</a>.</p>\n</blockquote>\n<p>When everything is created, I reach a <a href=\"https://github.com/Digital-Peak/DPDocker/blob/main/webserver/scripts/index.php\">page</a> via [http://localhost] in the browser, which lists all available Joomla installations.</p>\n<h2>Possible error messages</h2>\n<h3>Help with the message: <code class=\"language-text\">Docker Error bind: address already in use</code></h3>\n<p>It may help to remove all containers so that they are rebuilt the next time I run <code class=\"language-text\">./DPDocker/webserer/run.sh</code>.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">docker rm $(docker ps -a - q)</span></span></code></pre>\n<p>If the problem persists, I check all services that use the port.</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">sudo lsof -i -P -n | grep &lt;port number&gt;</span></span></code></pre>\n<p>Depending on which service I identify as the culprit, I stop it via</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"16\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">sudo service SERVICE stop</span></span></code></pre>\n<p>If I do not succeed in identifying the blocking service, I remove it via <code class=\"language-text\">kill</code>. Under Ubuntu 20.04, I use</p>\n<pre class=\"grvsc-container solarized-light\" data-language=\"\" data-index=\"17\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">sudo kill &lt;process id&gt;</span></span></code></pre>\n<blockquote>\n<p>I can find the number of the process in the output of <code class=\"language-text\">sudo lsof -i -P -n | grep &lt;port number&gt;</code>.</p>\n</blockquote>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .solarized-light { background-color: #FDF6E3; }\n  .solarized-light .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(0, 0, 0, 0.05));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(0, 0, 0, 0.2));\n  }\n</style>","fileAbsolutePath":"/home/astrid/git/websites/meinblog/content/posts/ubuntu_dpdocker/6ubuntu-joomla-erweiterung-mit-dpdocker.en.md","excerpt":"As a reminder, Docker makes it easier to manage software in containers. Docker Compose is a tool that simplifies working with multiple…","fields":{"slug":"/en/joomla-erweiterung-mit-dpdocker/"},"frontmatter":{"title":"A custom third party Joomla extension with DPDocker","date":"07.08.2020","tags":["Linux","Ubuntu","DPDocker","Joomla"],"thumbnail":{"childImageSharp":{"fixed":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACtElEQVQ4y42UT2gTQRTGs9mFgn9AEG3RNLOZ2aTRtqhUqMSY2UQUBPGieKgiggf/3KpUELyJoHiy4NGbB+mlWBS8aEjTdtNqMdIWi/bQkoqI1dikhILS9ZvNbrNNU5uBLy9sZn753rz31uOpsahftSLTwh7qa5ZDndxzfMaU+NBvr24Urd9E1DNFT93LgVYvgNZCjWL9MK29Q6F+0k22b2mMj/95yIcXL9ogSahu6GrKLa3baLO/wEL7EvGP5viJadPE4btut3VBXcCtAM5q4TYOYJIP5XtxMMeNYr8LKpdjYWMo0nQDc4yFYvGs+Y4PLpzGoQboCzQB7RT78AeKnilU3NSQ5Eo5x7SWGByO8vSvS7YbGbABaBHqsKGy5ZASVaKEeGjAJULcwHlGgxwOBbDLOpwpOene10dL4l4vWM8nzf8XJ9QZV4RD3GEkMWEaPLVwvkYbnYVKq8VCerehJDQADUGDtlKUBIbpXt+y1nowG3vzbVEfK03zkUIS6aVtjYjUEb+fmrc64LEAnguq1ESchK6gID2IQt0A3sGk5LXWA0/Qg3O6sfQMwOs4eAu6KQRYD+I16Cq+n3RcJqA8dHldxdE2TKWHkPJwLPXjTB1TQRQbqjOiCqf3rIKgWCwY3mFXOYGijDlVRmw42j+lRF98UuBYjr6cUaKvLHkdhw70MPQXeuTqw3n0Ibfbxqrmkadvrf0M/bpu5kP71WpoG7QM5712ynMAxt3ASN8Hee21qJUJEx+MkGpo0LpTovYB+BlAHSkbTh/iLmVnCHbtIZWB8JHKqDF/tVPiB/CrhnvFHUbj2ZUpAK2iRZ6/VxyIc74MVNe+EGg1VKXN2NwfaGpicPiAp39GxHOkL2323qwF9dbac+z1bI29pCyfuglUzHnjbqm96wZcrYh2KY9bZmlDU/8A59xT/ual1uoAAAAASUVORK5CYII=","width":80,"height":80,"src":"/static/85b1f306e08dd767f16b4e40ab643cdb/829e2/dp_logo.png","srcSet":"/static/85b1f306e08dd767f16b4e40ab643cdb/829e2/dp_logo.png 1x,\n/static/85b1f306e08dd767f16b4e40ab643cdb/e94d6/dp_logo.png 1.5x,\n/static/85b1f306e08dd767f16b4e40ab643cdb/af1a8/dp_logo.png 2x"}}}}}},"pageContext":{"slug":"/en/joomla-erweiterung-mit-dpdocker/","previous":{"id":"adee6d5b-4cc2-5723-9b65-ee3f78b9af82","frontmatter":{"title":"Eine eigene Joomla-Erweiterung mit DPDocker","tags":["Linux","Ubuntu","DPDocker","Joomla"],"template":"post"},"fields":{"slug":"/joomla-erweiterung-mit-dpdocker/"}},"next":{"id":"5740837a-6c38-55b2-ac29-0bd818f9b0b1","frontmatter":{"title":"Ubuntu 20.02, Docker, DPDocker und Joomla  Vorwort","tags":["Linux","Ubuntu"],"template":"post"},"fields":{"slug":"/ubuntu-vscode/"}}}},"staticQueryHashes":[]}